var Na=Object.defineProperty;var Oa=(r,t,e)=>t in r?Na(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var me=(r,t,e)=>(Oa(r,typeof t!="symbol"?t+"":t,e),e);import{$ as Ma,a0 as Lt,a1 as Fa,_ as An,C as Gr,a as Bn,a2 as Uo,W as eo,J as no,p as ro,m as Cr,f as za,c as os,r as Xt}from"./base.esm-47809bc2.js";import{B as so,c as qa}from"./modal.esm-dc74f401.js";import{g as is,i as ai,h as rn}from"./vendor-e80652ae.js";import{H as ci,c as Bs,a as Yr,t as fi,b as Ka,w as ui,u as Pt,r as li,d as tn,e as Da,f as Ha,g as $a,h as ja,B as Po}from"./bn-7ed28666.js";import{E as di}from"./index-d9da954e.js";import{_ as hi}from"./defineProperty-0f7e3690.js";import{c as Wa}from"./_commonjs-dynamic-modules-302442b1.js";function Va(r){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),e=0;e<t.length;e++)t[e]=255;for(var n=0;n<r.length;n++){var s=r.charAt(n),o=s.charCodeAt(0);if(t[o]!==255)throw new TypeError(s+" is ambiguous");t[o]=n}var i=r.length,f=r.charAt(0),u=Math.log(i)/Math.log(256),g=Math.log(256)/Math.log(i);function y(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(b.length===0)return"";for(var A=0,m=0,w=0,T=b.length;w!==T&&b[w]===0;)w++,A++;for(var F=(T-w)*g+1>>>0,R=new Uint8Array(F);w!==T;){for(var H=b[w],et=0,j=F-1;(H!==0||et<m)&&j!==-1;j--,et++)H+=256*R[j]>>>0,R[j]=H%i>>>0,H=H/i>>>0;if(H!==0)throw new Error("Non-zero carry");m=et,w++}for(var G=F-m;G!==F&&R[G]===0;)G++;for(var it=f.repeat(A);G<F;++G)it+=r.charAt(R[G]);return it}function v(b){if(typeof b!="string")throw new TypeError("Expected String");if(b.length===0)return new Uint8Array;for(var A=0,m=0,w=0;b[A]===f;)m++,A++;for(var T=(b.length-A)*u+1>>>0,F=new Uint8Array(T);b[A];){var R=t[b.charCodeAt(A)];if(R===255)return;for(var H=0,et=T-1;(R!==0||H<w)&&et!==-1;et--,H++)R+=i*F[et]>>>0,F[et]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");w=H,A++}for(var j=T-w;j!==T&&F[j]===0;)j++;for(var G=new Uint8Array(m+(T-j)),it=m;j!==T;)G[it++]=F[j++];return G}function S(b){var A=v(b);if(A)return A;throw new Error("Non-base"+i+" character")}return{encode:y,decodeUnsafe:v,decode:S}}var Ga=Va;const Ya=Ga,Za="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";var Ja=Ya(Za);const en=is(Ja);function Xa(r,t,e,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(t,e,n);const s=BigInt(32),o=BigInt(4294967295),i=Number(e>>s&o),f=Number(e&o),u=n?4:0,g=n?0:4;r.setUint32(t+u,i,n),r.setUint32(t+g,f,n)}function Qa(r,t,e){return r&t^~r&e}function tc(r,t,e){return r&t^r&e^t&e}class gi extends ci{constructor(t,e,n,s){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Bs(this.buffer)}update(t){Yr(this);const{view:e,buffer:n,blockLen:s}=this;t=fi(t);const o=t.length;for(let i=0;i<o;){const f=Math.min(s-this.pos,o-i);if(f===s){const u=Bs(t);for(;s<=o-i;i+=s)this.process(u,i);continue}n.set(t.subarray(i,i+f),this.pos),this.pos+=f,i+=f,this.pos===s&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Yr(this),Ka(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:s,isLE:o}=this;let{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(n,0),i=0);for(let v=i;v<s;v++)e[v]=0;Xa(n,s-8,BigInt(this.length*8),o),this.process(n,0);const f=Bs(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const g=u/4,y=this.get();if(g>y.length)throw new Error("_sha2: outputLen bigger than state");for(let v=0;v<g;v++)f.setUint32(4*v,y[v],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:s,finished:o,destroyed:i,pos:f}=this;return t.length=s,t.pos=f,t.finished=o,t.destroyed=i,s%e&&t.buffer.set(n),t}}const[ec,nc]=(()=>Pt.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))))(),mn=new Uint32Array(80),xn=new Uint32Array(80);class rc extends gi{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:n,Bl:s,Ch:o,Cl:i,Dh:f,Dl:u,Eh:g,El:y,Fh:v,Fl:S,Gh:b,Gl:A,Hh:m,Hl:w}=this;return[t,e,n,s,o,i,f,u,g,y,v,S,b,A,m,w]}set(t,e,n,s,o,i,f,u,g,y,v,S,b,A,m,w){this.Ah=t|0,this.Al=e|0,this.Bh=n|0,this.Bl=s|0,this.Ch=o|0,this.Cl=i|0,this.Dh=f|0,this.Dl=u|0,this.Eh=g|0,this.El=y|0,this.Fh=v|0,this.Fl=S|0,this.Gh=b|0,this.Gl=A|0,this.Hh=m|0,this.Hl=w|0}process(t,e){for(let R=0;R<16;R++,e+=4)mn[R]=t.getUint32(e),xn[R]=t.getUint32(e+=4);for(let R=16;R<80;R++){const H=mn[R-15]|0,et=xn[R-15]|0,j=Pt.rotrSH(H,et,1)^Pt.rotrSH(H,et,8)^Pt.shrSH(H,et,7),G=Pt.rotrSL(H,et,1)^Pt.rotrSL(H,et,8)^Pt.shrSL(H,et,7),it=mn[R-2]|0,ut=xn[R-2]|0,Zt=Pt.rotrSH(it,ut,19)^Pt.rotrBH(it,ut,61)^Pt.shrSH(it,ut,6),zt=Pt.rotrSL(it,ut,19)^Pt.rotrBL(it,ut,61)^Pt.shrSL(it,ut,6),Ot=Pt.add4L(G,zt,xn[R-7],xn[R-16]),oe=Pt.add4H(Ot,j,Zt,mn[R-7],mn[R-16]);mn[R]=oe|0,xn[R]=Ot|0}let{Ah:n,Al:s,Bh:o,Bl:i,Ch:f,Cl:u,Dh:g,Dl:y,Eh:v,El:S,Fh:b,Fl:A,Gh:m,Gl:w,Hh:T,Hl:F}=this;for(let R=0;R<80;R++){const H=Pt.rotrSH(v,S,14)^Pt.rotrSH(v,S,18)^Pt.rotrBH(v,S,41),et=Pt.rotrSL(v,S,14)^Pt.rotrSL(v,S,18)^Pt.rotrBL(v,S,41),j=v&b^~v&m,G=S&A^~S&w,it=Pt.add5L(F,et,G,nc[R],xn[R]),ut=Pt.add5H(it,T,H,j,ec[R],mn[R]),Zt=it|0,zt=Pt.rotrSH(n,s,28)^Pt.rotrBH(n,s,34)^Pt.rotrBH(n,s,39),Ot=Pt.rotrSL(n,s,28)^Pt.rotrBL(n,s,34)^Pt.rotrBL(n,s,39),oe=n&o^n&f^o&f,Y=s&i^s&u^i&u;T=m|0,F=w|0,m=b|0,w=A|0,b=v|0,A=S|0,{h:v,l:S}=Pt.add(g|0,y|0,ut|0,Zt|0),g=f|0,y=u|0,f=o|0,u=i|0,o=n|0,i=s|0;const st=Pt.add3L(Zt,Ot,Y);n=Pt.add3H(st,ut,zt,oe),s=st|0}({h:n,l:s}=Pt.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:o,l:i}=Pt.add(this.Bh|0,this.Bl|0,o|0,i|0),{h:f,l:u}=Pt.add(this.Ch|0,this.Cl|0,f|0,u|0),{h:g,l:y}=Pt.add(this.Dh|0,this.Dl|0,g|0,y|0),{h:v,l:S}=Pt.add(this.Eh|0,this.El|0,v|0,S|0),{h:b,l:A}=Pt.add(this.Fh|0,this.Fl|0,b|0,A|0),{h:m,l:w}=Pt.add(this.Gh|0,this.Gl|0,m|0,w|0),{h:T,l:F}=Pt.add(this.Hh|0,this.Hl|0,T|0,F|0),this.set(n,s,o,i,f,u,g,y,v,S,b,A,m,w,T,F)}roundClean(){mn.fill(0),xn.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const sc=ui(()=>new rc);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const as=BigInt(0),cs=BigInt(1),oc=BigInt(2);function qn(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Lr(r){if(!qn(r))throw new Error("Uint8Array expected")}function yn(r,t){if(typeof t!="boolean")throw new Error(r+" boolean expected, got "+t)}const ic=Array.from({length:256},(r,t)=>t.toString(16).padStart(2,"0"));function Kn(r){Lr(r);let t="";for(let e=0;e<r.length;e++)t+=ic[r[e]];return t}function tr(r){const t=r.toString(16);return t.length&1?"0"+t:t}function oo(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?as:BigInt("0x"+r)}const ln={_0:48,_9:57,A:65,F:70,a:97,f:102};function No(r){if(r>=ln._0&&r<=ln._9)return r-ln._0;if(r>=ln.A&&r<=ln.F)return r-(ln.A-10);if(r>=ln.a&&r<=ln.f)return r-(ln.a-10)}function or(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const t=r.length,e=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(e);for(let s=0,o=0;s<e;s++,o+=2){const i=No(r.charCodeAt(o)),f=No(r.charCodeAt(o+1));if(i===void 0||f===void 0){const u=r[o]+r[o+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+o)}n[s]=i*16+f}return n}function Fn(r){return oo(Kn(r))}function nr(r){return Lr(r),oo(Kn(Uint8Array.from(r).reverse()))}function ir(r,t){return or(r.toString(16).padStart(t*2,"0"))}function Br(r,t){return ir(r,t).reverse()}function ac(r){return or(tr(r))}function we(r,t,e){let n;if(typeof t=="string")try{n=or(t)}catch(o){throw new Error(r+" must be hex string or Uint8Array, cause: "+o)}else if(qn(t))n=Uint8Array.from(t);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof e=="number"&&s!==e)throw new Error(r+" of length "+e+" expected, got "+s);return n}function Dn(...r){let t=0;for(let n=0;n<r.length;n++){const s=r[n];Lr(s),t+=s.length}const e=new Uint8Array(t);for(let n=0,s=0;n<r.length;n++){const o=r[n];e.set(o,s),s+=o.length}return e}function cc(r,t){if(r.length!==t.length)return!1;let e=0;for(let n=0;n<r.length;n++)e|=r[n]^t[n];return e===0}function fc(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}const ks=r=>typeof r=="bigint"&&as<=r;function fs(r,t,e){return ks(r)&&ks(t)&&ks(e)&&t<=r&&r<e}function Ve(r,t,e,n){if(!fs(t,e,n))throw new Error("expected valid "+r+": "+e+" <= n < "+n+", got "+t)}function pi(r){let t;for(t=0;r>as;r>>=cs,t+=1);return t}function uc(r,t){return r>>BigInt(t)&cs}function lc(r,t,e){return r|(e?cs:as)<<BigInt(t)}const io=r=>(oc<<BigInt(r-1))-cs,Is=r=>new Uint8Array(r),Oo=r=>Uint8Array.from(r);function yi(r,t,e){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");let n=Is(r),s=Is(r),o=0;const i=()=>{n.fill(1),s.fill(0),o=0},f=(...v)=>e(s,n,...v),u=(v=Is())=>{s=f(Oo([0]),v),n=f(),v.length!==0&&(s=f(Oo([1]),v),n=f())},g=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let v=0;const S=[];for(;v<t;){n=f();const b=n.slice();S.push(b),v+=n.length}return Dn(...S)};return(v,S)=>{i(),u(v);let b;for(;!(b=S(g()));)u();return i(),b}}const dc={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||qn(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,t)=>t.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function ur(r,t,e={}){const n=(s,o,i)=>{const f=dc[o];if(typeof f!="function")throw new Error("invalid validator function");const u=r[s];if(!(i&&u===void 0)&&!f(u,r))throw new Error("param "+String(s)+" is invalid. Expected "+o+", got "+u)};for(const[s,o]of Object.entries(t))n(s,o,!1);for(const[s,o]of Object.entries(e))n(s,o,!0);return r}const hc=()=>{throw new Error("not implemented")};function kr(r){const t=new WeakMap;return(e,...n)=>{const s=t.get(e);if(s!==void 0)return s;const o=r(e,...n);return t.set(e,o),o}}const gc=Object.freeze(Object.defineProperty({__proto__:null,aInRange:Ve,abool:yn,abytes:Lr,bitGet:uc,bitLen:pi,bitMask:io,bitSet:lc,bytesToHex:Kn,bytesToNumberBE:Fn,bytesToNumberLE:nr,concatBytes:Dn,createHmacDrbg:yi,ensureBytes:we,equalBytes:cc,hexToBytes:or,hexToNumber:oo,inRange:fs,isBytes:qn,memoized:kr,notImplemented:hc,numberToBytesBE:ir,numberToBytesLE:Br,numberToHexUnpadded:tr,numberToVarBytesBE:ac,utf8ToBytes:fc,validateObject:ur},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ve=BigInt(0),re=BigInt(1),Nn=BigInt(2),pc=BigInt(3),js=BigInt(4),Mo=BigInt(5),Fo=BigInt(8);function ee(r,t){const e=r%t;return e>=ve?e:t+e}function yc(r,t,e){if(t<ve)throw new Error("invalid exponent, negatives unsupported");if(e<=ve)throw new Error("invalid modulus");if(e===re)return ve;let n=re;for(;t>ve;)t&re&&(n=n*r%e),r=r*r%e,t>>=re;return n}function ue(r,t,e){let n=r;for(;t-- >ve;)n*=n,n%=e;return n}function Ws(r,t){if(r===ve)throw new Error("invert: expected non-zero number");if(t<=ve)throw new Error("invert: expected positive modulus, got "+t);let e=ee(r,t),n=t,s=ve,o=re;for(;e!==ve;){const f=n/e,u=n%e,g=s-o*f;n=e,e=u,s=o,o=g}if(n!==re)throw new Error("invert: does not exist");return ee(s,t)}function wc(r){const t=(r-re)/Nn;let e,n,s;for(e=r-re,n=0;e%Nn===ve;e/=Nn,n++);for(s=Nn;s<r&&yc(s,t,r)!==r-re;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const i=(r+re)/js;return function(u,g){const y=u.pow(g,i);if(!u.eql(u.sqr(y),g))throw new Error("Cannot find square root");return y}}const o=(e+re)/Nn;return function(f,u){if(f.pow(u,t)===f.neg(f.ONE))throw new Error("Cannot find square root");let g=n,y=f.pow(f.mul(f.ONE,s),e),v=f.pow(u,o),S=f.pow(u,e);for(;!f.eql(S,f.ONE);){if(f.eql(S,f.ZERO))return f.ZERO;let b=1;for(let m=f.sqr(S);b<g&&!f.eql(m,f.ONE);b++)m=f.sqr(m);const A=f.pow(y,re<<BigInt(g-b-1));y=f.sqr(A),v=f.mul(v,A),S=f.mul(S,y),g=b}return v}}function bc(r){if(r%js===pc){const t=(r+re)/js;return function(n,s){const o=n.pow(s,t);if(!n.eql(n.sqr(o),s))throw new Error("Cannot find square root");return o}}if(r%Fo===Mo){const t=(r-Mo)/Fo;return function(n,s){const o=n.mul(s,Nn),i=n.pow(o,t),f=n.mul(s,i),u=n.mul(n.mul(f,Nn),i),g=n.mul(f,n.sub(u,n.ONE));if(!n.eql(n.sqr(g),s))throw new Error("Cannot find square root");return g}}return wc(r)}const mc=(r,t)=>(ee(r,t)&re)===re,xc=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function vc(r){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},e=xc.reduce((n,s)=>(n[s]="function",n),t);return ur(r,e)}function Sc(r,t,e){if(e<ve)throw new Error("invalid exponent, negatives unsupported");if(e===ve)return r.ONE;if(e===re)return t;let n=r.ONE,s=t;for(;e>ve;)e&re&&(n=r.mul(n,s)),s=r.sqr(s),e>>=re;return n}function Ec(r,t){const e=new Array(t.length),n=t.reduce((o,i,f)=>r.is0(i)?o:(e[f]=o,r.mul(o,i)),r.ONE),s=r.inv(n);return t.reduceRight((o,i,f)=>r.is0(i)?o:(e[f]=r.mul(o,e[f]),r.mul(o,i)),s),e}function wi(r,t){const e=t!==void 0?t:r.toString(2).length,n=Math.ceil(e/8);return{nBitLength:e,nByteLength:n}}function us(r,t,e=!1,n={}){if(r<=ve)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:o}=wi(r,t);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let i;const f=Object.freeze({ORDER:r,isLE:e,BITS:s,BYTES:o,MASK:io(s),ZERO:ve,ONE:re,create:u=>ee(u,r),isValid:u=>{if(typeof u!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof u);return ve<=u&&u<r},is0:u=>u===ve,isOdd:u=>(u&re)===re,neg:u=>ee(-u,r),eql:(u,g)=>u===g,sqr:u=>ee(u*u,r),add:(u,g)=>ee(u+g,r),sub:(u,g)=>ee(u-g,r),mul:(u,g)=>ee(u*g,r),pow:(u,g)=>Sc(f,u,g),div:(u,g)=>ee(u*Ws(g,r),r),sqrN:u=>u*u,addN:(u,g)=>u+g,subN:(u,g)=>u-g,mulN:(u,g)=>u*g,inv:u=>Ws(u,r),sqrt:n.sqrt||(u=>(i||(i=bc(r)),i(f,u))),invertBatch:u=>Ec(f,u),cmov:(u,g,y)=>y?g:u,toBytes:u=>e?Br(u,o):ir(u,o),fromBytes:u=>{if(u.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+u.length);return e?nr(u):Fn(u)}});return Object.freeze(f)}function bi(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const t=r.toString(2).length;return Math.ceil(t/8)}function mi(r){const t=bi(r);return t+Math.ceil(t/2)}function _c(r,t,e=!1){const n=r.length,s=bi(t),o=mi(t);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);const i=e?nr(r):Fn(r),f=ee(i,t-re)+re;return e?Br(f,s):ir(f,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zo=BigInt(0),Dr=BigInt(1);function Rs(r,t){const e=t.negate();return r?e:t}function xi(r,t){if(!Number.isSafeInteger(r)||r<=0||r>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+r)}function Ts(r,t){xi(r,t);const e=Math.ceil(t/r)+1,n=2**(r-1);return{windows:e,windowSize:n}}function Ac(r,t){if(!Array.isArray(r))throw new Error("array expected");r.forEach((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)})}function Bc(r,t){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}const Cs=new WeakMap,vi=new WeakMap;function Ls(r){return vi.get(r)||1}function Si(r,t){return{constTimeNegate:Rs,hasPrecomputes(e){return Ls(e)!==1},unsafeLadder(e,n,s=r.ZERO){let o=e;for(;n>zo;)n&Dr&&(s=s.add(o)),o=o.double(),n>>=Dr;return s},precomputeWindow(e,n){const{windows:s,windowSize:o}=Ts(n,t),i=[];let f=e,u=f;for(let g=0;g<s;g++){u=f,i.push(u);for(let y=1;y<o;y++)u=u.add(f),i.push(u);f=u.double()}return i},wNAF(e,n,s){const{windows:o,windowSize:i}=Ts(e,t);let f=r.ZERO,u=r.BASE;const g=BigInt(2**e-1),y=2**e,v=BigInt(e);for(let S=0;S<o;S++){const b=S*i;let A=Number(s&g);s>>=v,A>i&&(A-=y,s+=Dr);const m=b,w=b+Math.abs(A)-1,T=S%2!==0,F=A<0;A===0?u=u.add(Rs(T,n[m])):f=f.add(Rs(F,n[w]))}return{p:f,f:u}},wNAFUnsafe(e,n,s,o=r.ZERO){const{windows:i,windowSize:f}=Ts(e,t),u=BigInt(2**e-1),g=2**e,y=BigInt(e);for(let v=0;v<i;v++){const S=v*f;if(s===zo)break;let b=Number(s&u);if(s>>=y,b>f&&(b-=g,s+=Dr),b===0)continue;let A=n[S+Math.abs(b)-1];b<0&&(A=A.negate()),o=o.add(A)}return o},getPrecomputes(e,n,s){let o=Cs.get(n);return o||(o=this.precomputeWindow(n,e),e!==1&&Cs.set(n,s(o))),o},wNAFCached(e,n,s){const o=Ls(e);return this.wNAF(o,this.getPrecomputes(o,e,s),n)},wNAFCachedUnsafe(e,n,s,o){const i=Ls(e);return i===1?this.unsafeLadder(e,n,o):this.wNAFUnsafe(i,this.getPrecomputes(i,e,s),n,o)},setWindowSize(e,n){xi(n,t),vi.set(e,n),Cs.delete(e)}}}function Ei(r,t,e,n){if(Ac(e,r),Bc(n,t),e.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=r.ZERO,o=pi(BigInt(e.length)),i=o>12?o-3:o>4?o-2:o?2:1,f=(1<<i)-1,u=new Array(f+1).fill(s),g=Math.floor((t.BITS-1)/i)*i;let y=s;for(let v=g;v>=0;v-=i){u.fill(s);for(let b=0;b<n.length;b++){const A=n[b],m=Number(A>>BigInt(v)&BigInt(f));u[m]=u[m].add(e[b])}let S=s;for(let b=u.length-1,A=s;b>0;b--)A=A.add(u[b]),S=S.add(A);if(y=y.add(S),v!==0)for(let b=0;b<i;b++)y=y.double()}return y}function ao(r){return vc(r.Fp),ur(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...wi(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ze=BigInt(0),Me=BigInt(1),Hr=BigInt(2),kc=BigInt(8),Ic={zip215:!0};function Rc(r){const t=ao(r);return ur(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Tc(r){const t=Rc(r),{Fp:e,n,prehash:s,hash:o,randomBytes:i,nByteLength:f,h:u}=t,g=Hr<<BigInt(f*8)-Me,y=e.create,v=us(t.n,t.nBitLength),S=t.uvRatio||((N,C)=>{try{return{isValid:!0,value:e.sqrt(N*e.inv(C))}}catch{return{isValid:!1,value:Ze}}}),b=t.adjustScalarBytes||(N=>N),A=t.domain||((N,C,K)=>{if(yn("phflag",K),C.length||K)throw new Error("Contexts/pre-hash are not supported");return N});function m(N,C){Ve("coordinate "+N,C,Ze,g)}function w(N){if(!(N instanceof R))throw new Error("ExtendedPoint expected")}const T=kr((N,C)=>{const{ex:K,ey:J,ez:bt}=N,mt=N.is0();C==null&&(C=mt?kc:e.inv(bt));const Tt=y(K*C),vt=y(J*C),ht=y(bt*C);if(mt)return{x:Ze,y:Me};if(ht!==Me)throw new Error("invZ was invalid");return{x:Tt,y:vt}}),F=kr(N=>{const{a:C,d:K}=t;if(N.is0())throw new Error("bad point: ZERO");const{ex:J,ey:bt,ez:mt,et:Tt}=N,vt=y(J*J),ht=y(bt*bt),nt=y(mt*mt),Mt=y(nt*nt),le=y(vt*C),de=y(nt*y(le+ht)),ie=y(Mt+y(K*y(vt*ht)));if(de!==ie)throw new Error("bad point: equation left != right (1)");const he=y(J*bt),Se=y(mt*Tt);if(he!==Se)throw new Error("bad point: equation left != right (2)");return!0});class R{constructor(C,K,J,bt){this.ex=C,this.ey=K,this.ez=J,this.et=bt,m("x",C),m("y",K),m("z",J),m("t",bt),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(C){if(C instanceof R)throw new Error("extended point not allowed");const{x:K,y:J}=C||{};return m("x",K),m("y",J),new R(K,J,Me,y(K*J))}static normalizeZ(C){const K=e.invertBatch(C.map(J=>J.ez));return C.map((J,bt)=>J.toAffine(K[bt])).map(R.fromAffine)}static msm(C,K){return Ei(R,v,C,K)}_setWindowSize(C){j.setWindowSize(this,C)}assertValidity(){F(this)}equals(C){w(C);const{ex:K,ey:J,ez:bt}=this,{ex:mt,ey:Tt,ez:vt}=C,ht=y(K*vt),nt=y(mt*bt),Mt=y(J*vt),le=y(Tt*bt);return ht===nt&&Mt===le}is0(){return this.equals(R.ZERO)}negate(){return new R(y(-this.ex),this.ey,this.ez,y(-this.et))}double(){const{a:C}=t,{ex:K,ey:J,ez:bt}=this,mt=y(K*K),Tt=y(J*J),vt=y(Hr*y(bt*bt)),ht=y(C*mt),nt=K+J,Mt=y(y(nt*nt)-mt-Tt),le=ht+Tt,de=le-vt,ie=ht-Tt,he=y(Mt*de),Se=y(le*ie),ye=y(Mt*ie),ze=y(de*le);return new R(he,Se,ze,ye)}add(C){w(C);const{a:K,d:J}=t,{ex:bt,ey:mt,ez:Tt,et:vt}=this,{ex:ht,ey:nt,ez:Mt,et:le}=C;if(K===BigInt(-1)){const Tn=y((mt-bt)*(nt+ht)),yr=y((mt+bt)*(nt-ht)),bn=y(yr-Tn);if(bn===Ze)return this.double();const Vn=y(Tt*Hr*le),Cn=y(vt*Hr*Mt),Gn=Cn+Vn,Ln=yr+Tn,Yn=Cn-Vn,wr=y(Gn*bn),zr=y(Ln*Yn),vs=y(Gn*Yn),br=y(bn*Ln);return new R(wr,zr,br,vs)}const de=y(bt*ht),ie=y(mt*nt),he=y(vt*J*le),Se=y(Tt*Mt),ye=y((bt+mt)*(ht+nt)-de-ie),ze=Se-he,Qe=Se+he,Ye=y(ie-K*de),xs=y(ye*ze),Mr=y(Qe*Ye),Fr=y(ye*Ye),fn=y(ze*Qe);return new R(xs,Mr,fn,Fr)}subtract(C){return this.add(C.negate())}wNAF(C){return j.wNAFCached(this,C,R.normalizeZ)}multiply(C){const K=C;Ve("scalar",K,Me,n);const{p:J,f:bt}=this.wNAF(K);return R.normalizeZ([J,bt])[0]}multiplyUnsafe(C,K=R.ZERO){const J=C;return Ve("scalar",J,Ze,n),J===Ze?et:this.is0()||J===Me?this:j.wNAFCachedUnsafe(this,J,R.normalizeZ,K)}isSmallOrder(){return this.multiplyUnsafe(u).is0()}isTorsionFree(){return j.unsafeLadder(this,n).is0()}toAffine(C){return T(this,C)}clearCofactor(){const{h:C}=t;return C===Me?this:this.multiplyUnsafe(C)}static fromHex(C,K=!1){const{d:J,a:bt}=t,mt=e.BYTES;C=we("pointHex",C,mt),yn("zip215",K);const Tt=C.slice(),vt=C[mt-1];Tt[mt-1]=vt&-129;const ht=nr(Tt),nt=K?g:e.ORDER;Ve("pointHex.y",ht,Ze,nt);const Mt=y(ht*ht),le=y(Mt-Me),de=y(J*Mt-bt);let{isValid:ie,value:he}=S(le,de);if(!ie)throw new Error("Point.fromHex: invalid y coordinate");const Se=(he&Me)===Me,ye=(vt&128)!==0;if(!K&&he===Ze&&ye)throw new Error("Point.fromHex: x=0 and x_0=1");return ye!==Se&&(he=y(-he)),R.fromAffine({x:he,y:ht})}static fromPrivateKey(C){return ut(C).point}toRawBytes(){const{x:C,y:K}=this.toAffine(),J=Br(K,e.BYTES);return J[J.length-1]|=C&Me?128:0,J}toHex(){return Kn(this.toRawBytes())}}R.BASE=new R(t.Gx,t.Gy,Me,y(t.Gx*t.Gy)),R.ZERO=new R(Ze,Me,Me,Ze);const{BASE:H,ZERO:et}=R,j=Si(R,f*8);function G(N){return ee(N,n)}function it(N){return G(nr(N))}function ut(N){const C=e.BYTES;N=we("private key",N,C);const K=we("hashed private key",o(N),2*C),J=b(K.slice(0,C)),bt=K.slice(C,2*C),mt=it(J),Tt=H.multiply(mt),vt=Tt.toRawBytes();return{head:J,prefix:bt,scalar:mt,point:Tt,pointBytes:vt}}function Zt(N){return ut(N).pointBytes}function zt(N=new Uint8Array,...C){const K=Dn(...C);return it(o(A(K,we("context",N),!!s)))}function Ot(N,C,K={}){N=we("message",N),s&&(N=s(N));const{prefix:J,scalar:bt,pointBytes:mt}=ut(C),Tt=zt(K.context,J,N),vt=H.multiply(Tt).toRawBytes(),ht=zt(K.context,vt,mt,N),nt=G(Tt+ht*bt);Ve("signature.s",nt,Ze,n);const Mt=Dn(vt,Br(nt,e.BYTES));return we("result",Mt,e.BYTES*2)}const oe=Ic;function Y(N,C,K,J=oe){const{context:bt,zip215:mt}=J,Tt=e.BYTES;N=we("signature",N,2*Tt),C=we("message",C),K=we("publicKey",K,Tt),mt!==void 0&&yn("zip215",mt),s&&(C=s(C));const vt=nr(N.slice(Tt,2*Tt));let ht,nt,Mt;try{ht=R.fromHex(K,mt),nt=R.fromHex(N.slice(0,Tt),mt),Mt=H.multiplyUnsafe(vt)}catch{return!1}if(!mt&&ht.isSmallOrder())return!1;const le=zt(bt,nt.toRawBytes(),ht.toRawBytes(),C);return nt.add(ht.multiplyUnsafe(le)).subtract(Mt).clearCofactor().equals(R.ZERO)}return H._setWindowSize(8),{CURVE:t,getPublicKey:Zt,sign:Ot,verify:Y,ExtendedPoint:R,utils:{getExtendedPublicKey:ut,randomPrivateKey:()=>i(e.BYTES),precompute(N=8,C=R.BASE){return C._setWindowSize(N),C.multiply(BigInt(3)),C}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const co=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),qo=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Cc=BigInt(1),Ko=BigInt(2);BigInt(3);const Lc=BigInt(5),Uc=BigInt(8);function Pc(r){const t=BigInt(10),e=BigInt(20),n=BigInt(40),s=BigInt(80),o=co,f=r*r%o*r%o,u=ue(f,Ko,o)*f%o,g=ue(u,Cc,o)*r%o,y=ue(g,Lc,o)*g%o,v=ue(y,t,o)*y%o,S=ue(v,e,o)*v%o,b=ue(S,n,o)*S%o,A=ue(b,s,o)*b%o,m=ue(A,s,o)*b%o,w=ue(m,t,o)*y%o;return{pow_p_5_8:ue(w,Ko,o)*r%o,b2:f}}function Nc(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function Oc(r,t){const e=co,n=ee(t*t*t,e),s=ee(n*n*t,e),o=Pc(r*s).pow_p_5_8;let i=ee(r*n*o,e);const f=ee(t*i*i,e),u=i,g=ee(i*qo,e),y=f===r,v=f===ee(-r,e),S=f===ee(-r*qo,e);return y&&(i=u),(v||S)&&(i=g),mc(i,e)&&(i=ee(-i,e)),{isValid:y||v,value:i}}const Mc=(()=>us(co,void 0,!0))(),Fc=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Mc,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Uc,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:sc,randomBytes:li,adjustScalarBytes:Nc,uvRatio:Oc}))(),lr=(()=>Tc(Fc))();var $r=Ma.Buffer;function zc(r){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),e=0;e<t.length;e++)t[e]=255;for(var n=0;n<r.length;n++){var s=r.charAt(n),o=s.charCodeAt(0);if(t[o]!==255)throw new TypeError(s+" is ambiguous");t[o]=n}var i=r.length,f=r.charAt(0),u=Math.log(i)/Math.log(256),g=Math.log(256)/Math.log(i);function y(b){if((Array.isArray(b)||b instanceof Uint8Array)&&(b=$r.from(b)),!$r.isBuffer(b))throw new TypeError("Expected Buffer");if(b.length===0)return"";for(var A=0,m=0,w=0,T=b.length;w!==T&&b[w]===0;)w++,A++;for(var F=(T-w)*g+1>>>0,R=new Uint8Array(F);w!==T;){for(var H=b[w],et=0,j=F-1;(H!==0||et<m)&&j!==-1;j--,et++)H+=256*R[j]>>>0,R[j]=H%i>>>0,H=H/i>>>0;if(H!==0)throw new Error("Non-zero carry");m=et,w++}for(var G=F-m;G!==F&&R[G]===0;)G++;for(var it=f.repeat(A);G<F;++G)it+=r.charAt(R[G]);return it}function v(b){if(typeof b!="string")throw new TypeError("Expected String");if(b.length===0)return $r.alloc(0);for(var A=0,m=0,w=0;b[A]===f;)m++,A++;for(var T=(b.length-A)*u+1>>>0,F=new Uint8Array(T);A<b.length;){var R=t[b.charCodeAt(A)];if(R===255)return;for(var H=0,et=T-1;(R!==0||H<w)&&et!==-1;et--,H++)R+=i*F[et]>>>0,F[et]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");w=H,A++}for(var j=T-w;j!==T&&F[j]===0;)j++;var G=$r.allocUnsafe(m+(T-j));G.fill(0,0,m);for(var it=m;j!==T;)G[it++]=F[j++];return G}function S(b){var A=v(b);if(A)return A;throw new Error("Non-base"+i+" character")}return{encode:y,decodeUnsafe:v,decode:S}}var qc=zc,Kc=qc,Dc="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",_i=Kc(Dc);const Be=is(_i),Hc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),vn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Sn=new Uint32Array(64);class $c extends gi{constructor(){super(64,32,8,!1),this.A=vn[0]|0,this.B=vn[1]|0,this.C=vn[2]|0,this.D=vn[3]|0,this.E=vn[4]|0,this.F=vn[5]|0,this.G=vn[6]|0,this.H=vn[7]|0}get(){const{A:t,B:e,C:n,D:s,E:o,F:i,G:f,H:u}=this;return[t,e,n,s,o,i,f,u]}set(t,e,n,s,o,i,f,u){this.A=t|0,this.B=e|0,this.C=n|0,this.D=s|0,this.E=o|0,this.F=i|0,this.G=f|0,this.H=u|0}process(t,e){for(let v=0;v<16;v++,e+=4)Sn[v]=t.getUint32(e,!1);for(let v=16;v<64;v++){const S=Sn[v-15],b=Sn[v-2],A=tn(S,7)^tn(S,18)^S>>>3,m=tn(b,17)^tn(b,19)^b>>>10;Sn[v]=m+Sn[v-7]+A+Sn[v-16]|0}let{A:n,B:s,C:o,D:i,E:f,F:u,G:g,H:y}=this;for(let v=0;v<64;v++){const S=tn(f,6)^tn(f,11)^tn(f,25),b=y+S+Qa(f,u,g)+Hc[v]+Sn[v]|0,m=(tn(n,2)^tn(n,13)^tn(n,22))+tc(n,s,o)|0;y=g,g=u,u=f,f=i+b|0,i=o,o=s,s=n,n=b+m|0}n=n+this.A|0,s=s+this.B|0,o=o+this.C|0,i=i+this.D|0,f=f+this.E|0,u=u+this.F|0,g=g+this.G|0,y=y+this.H|0,this.set(n,s,o,i,f,u,g,y)}roundClean(){Sn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Vs=ui(()=>new $c);var Ae={};function hn(r,t,e){return t<=r&&r<=e}function ls(r){if(r===void 0)return{};if(r===Object(r))return r;throw TypeError("Could not convert argument to dictionary")}function jc(r){for(var t=String(r),e=t.length,n=0,s=[];n<e;){var o=t.charCodeAt(n);if(o<55296||o>57343)s.push(o);else if(56320<=o&&o<=57343)s.push(65533);else if(55296<=o&&o<=56319)if(n===e-1)s.push(65533);else{var i=r.charCodeAt(n+1);if(56320<=i&&i<=57343){var f=o&1023,u=i&1023;s.push(65536+(f<<10)+u),n+=1}else s.push(65533)}n+=1}return s}function Wc(r){for(var t="",e=0;e<r.length;++e){var n=r[e];n<=65535?t+=String.fromCharCode(n):(n-=65536,t+=String.fromCharCode((n>>10)+55296,(n&1023)+56320))}return t}var Zr=-1;function fo(r){this.tokens=[].slice.call(r)}fo.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():Zr},prepend:function(r){if(Array.isArray(r))for(var t=r;t.length;)this.tokens.unshift(t.pop());else this.tokens.unshift(r)},push:function(r){if(Array.isArray(r))for(var t=r;t.length;)this.tokens.push(t.shift());else this.tokens.push(r)}};var ar=-1;function Us(r,t){if(r)throw TypeError("Decoder error");return t||65533}var Jr="utf-8";function Xr(r,t){if(!(this instanceof Xr))return new Xr(r,t);if(r=r!==void 0?String(r).toLowerCase():Jr,r!==Jr)throw new Error("Encoding not supported. Only utf-8 is supported");t=ls(t),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=!!t.fatal,this._ignoreBOM=!!t.ignoreBOM,Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}Xr.prototype={decode:function(t,e){var n;typeof t=="object"&&t instanceof ArrayBuffer?n=new Uint8Array(t):typeof t=="object"&&"buffer"in t&&t.buffer instanceof ArrayBuffer?n=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):n=new Uint8Array(0),e=ls(e),this._streaming||(this._decoder=new Vc({fatal:this._fatal}),this._BOMseen=!1),this._streaming=!!e.stream;for(var s=new fo(n),o=[],i;!s.endOfStream()&&(i=this._decoder.handler(s,s.read()),i!==ar);)i!==null&&(Array.isArray(i)?o.push.apply(o,i):o.push(i));if(!this._streaming){do{if(i=this._decoder.handler(s,s.read()),i===ar)break;i!==null&&(Array.isArray(i)?o.push.apply(o,i):o.push(i))}while(!s.endOfStream());this._decoder=null}return o.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(o[0]===65279?(this._BOMseen=!0,o.shift()):this._BOMseen=!0),Wc(o)}};function Qr(r,t){if(!(this instanceof Qr))return new Qr(r,t);if(r=r!==void 0?String(r).toLowerCase():Jr,r!==Jr)throw new Error("Encoding not supported. Only utf-8 is supported");t=ls(t),this._streaming=!1,this._encoder=null,this._options={fatal:!!t.fatal},Object.defineProperty(this,"encoding",{value:"utf-8"})}Qr.prototype={encode:function(t,e){t=t?String(t):"",e=ls(e),this._streaming||(this._encoder=new Gc(this._options)),this._streaming=!!e.stream;for(var n=[],s=new fo(jc(t)),o;!s.endOfStream()&&(o=this._encoder.handler(s,s.read()),o!==ar);)Array.isArray(o)?n.push.apply(n,o):n.push(o);if(!this._streaming){for(;o=this._encoder.handler(s,s.read()),o!==ar;)Array.isArray(o)?n.push.apply(n,o):n.push(o);this._encoder=null}return new Uint8Array(n)}};function Vc(r){var t=r.fatal,e=0,n=0,s=0,o=128,i=191;this.handler=function(f,u){if(u===Zr&&s!==0)return s=0,Us(t);if(u===Zr)return ar;if(s===0){if(hn(u,0,127))return u;if(hn(u,194,223))s=1,e=u-192;else if(hn(u,224,239))u===224&&(o=160),u===237&&(i=159),s=2,e=u-224;else if(hn(u,240,244))u===240&&(o=144),u===244&&(i=143),s=3,e=u-240;else return Us(t);return e=e<<6*s,null}if(!hn(u,o,i))return e=s=n=0,o=128,i=191,f.prepend(u),Us(t);if(o=128,i=191,n+=1,e+=u-128<<6*(s-n),n!==s)return null;var g=e;return e=s=n=0,g}}function Gc(r){r.fatal,this.handler=function(t,e){if(e===Zr)return ar;if(hn(e,0,127))return e;var n,s;hn(e,128,2047)?(n=1,s=192):hn(e,2048,65535)?(n=2,s=224):hn(e,65536,1114111)&&(n=3,s=240);for(var o=[(e>>6*n)+s];n>0;){var i=e>>6*(n-1);o.push(128|i&63),n-=1}return o}}const Yc=Object.freeze(Object.defineProperty({__proto__:null,TextDecoder:Xr,TextEncoder:Qr},Symbol.toStringTag,{value:"Module"})),Zc=ai(Yc);var Jc=rn&&rn.__createBinding||(Object.create?function(r,t,e,n){n===void 0&&(n=e),Object.defineProperty(r,n,{enumerable:!0,get:function(){return t[e]}})}:function(r,t,e,n){n===void 0&&(n=e),r[n]=t[e]}),Xc=rn&&rn.__setModuleDefault||(Object.create?function(r,t){Object.defineProperty(r,"default",{enumerable:!0,value:t})}:function(r,t){r.default=t}),on=rn&&rn.__decorate||function(r,t,e,n){var s=arguments.length,o=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,t,e,n);else for(var f=r.length-1;f>=0;f--)(i=r[f])&&(o=(s<3?i(o):s>3?i(t,e,o):i(t,e))||o);return s>3&&o&&Object.defineProperty(t,e,o),o},Qc=rn&&rn.__importStar||function(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var e in r)e!=="default"&&Object.hasOwnProperty.call(r,e)&&Jc(t,r,e);return Xc(t,r),t},Ai=rn&&rn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ae,"__esModule",{value:!0});var Bi=Ae.deserializeUnchecked=Li=Ae.deserialize=Ci=Ae.serialize=Ae.BinaryReader=Ae.BinaryWriter=Ae.BorshError=Ae.baseDecode=Ae.baseEncode=void 0;const kn=Ai(Da),ki=Ai(_i),tf=Qc(Zc),ef=typeof TextDecoder!="function"?tf.TextDecoder:TextDecoder,nf=new ef("utf-8",{fatal:!0});function rf(r){return typeof r=="string"&&(r=Buffer.from(r,"utf8")),ki.default.encode(Buffer.from(r))}Ae.baseEncode=rf;function sf(r){return Buffer.from(ki.default.decode(r))}Ae.baseDecode=sf;const Ps=1024;class Ne extends Error{constructor(t){super(t),this.fieldPath=[],this.originalMessage=t}addToFieldPath(t){this.fieldPath.splice(0,0,t),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}Ae.BorshError=Ne;class Ii{constructor(){this.buf=Buffer.alloc(Ps),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=Buffer.concat([this.buf,Buffer.alloc(Ps)]))}writeU8(t){this.maybeResize(),this.buf.writeUInt8(t,this.length),this.length+=1}writeU16(t){this.maybeResize(),this.buf.writeUInt16LE(t,this.length),this.length+=2}writeU32(t){this.maybeResize(),this.buf.writeUInt32LE(t,this.length),this.length+=4}writeU64(t){this.maybeResize(),this.writeBuffer(Buffer.from(new kn.default(t).toArray("le",8)))}writeU128(t){this.maybeResize(),this.writeBuffer(Buffer.from(new kn.default(t).toArray("le",16)))}writeU256(t){this.maybeResize(),this.writeBuffer(Buffer.from(new kn.default(t).toArray("le",32)))}writeU512(t){this.maybeResize(),this.writeBuffer(Buffer.from(new kn.default(t).toArray("le",64)))}writeBuffer(t){this.buf=Buffer.concat([Buffer.from(this.buf.subarray(0,this.length)),t,Buffer.alloc(Ps)]),this.length+=t.length}writeString(t){this.maybeResize();const e=Buffer.from(t,"utf8");this.writeU32(e.length),this.writeBuffer(e)}writeFixedArray(t){this.writeBuffer(Buffer.from(t))}writeArray(t,e){this.maybeResize(),this.writeU32(t.length);for(const n of t)this.maybeResize(),e(n)}toArray(){return this.buf.subarray(0,this.length)}}Ae.BinaryWriter=Ii;function an(r,t,e){const n=e.value;e.value=function(...s){try{return n.apply(this,s)}catch(o){if(o instanceof RangeError){const i=o.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(i)>=0)throw new Ne("Reached the end of buffer when deserializing")}throw o}}}class je{constructor(t){this.buf=t,this.offset=0}readU8(){const t=this.buf.readUInt8(this.offset);return this.offset+=1,t}readU16(){const t=this.buf.readUInt16LE(this.offset);return this.offset+=2,t}readU32(){const t=this.buf.readUInt32LE(this.offset);return this.offset+=4,t}readU64(){const t=this.readBuffer(8);return new kn.default(t,"le")}readU128(){const t=this.readBuffer(16);return new kn.default(t,"le")}readU256(){const t=this.readBuffer(32);return new kn.default(t,"le")}readU512(){const t=this.readBuffer(64);return new kn.default(t,"le")}readBuffer(t){if(this.offset+t>this.buf.length)throw new Ne(`Expected buffer length ${t} isn't within bounds`);const e=this.buf.slice(this.offset,this.offset+t);return this.offset+=t,e}readString(){const t=this.readU32(),e=this.readBuffer(t);try{return nf.decode(e)}catch(n){throw new Ne(`Error decoding UTF-8 string: ${n}`)}}readFixedArray(t){return new Uint8Array(this.readBuffer(t))}readArray(t){const e=this.readU32(),n=Array();for(let s=0;s<e;++s)n.push(t());return n}}on([an],je.prototype,"readU8",null);on([an],je.prototype,"readU16",null);on([an],je.prototype,"readU32",null);on([an],je.prototype,"readU64",null);on([an],je.prototype,"readU128",null);on([an],je.prototype,"readU256",null);on([an],je.prototype,"readU512",null);on([an],je.prototype,"readString",null);on([an],je.prototype,"readFixedArray",null);on([an],je.prototype,"readArray",null);Ae.BinaryReader=je;function Ri(r){return r.charAt(0).toUpperCase()+r.slice(1)}function On(r,t,e,n,s){try{if(typeof n=="string")s[`write${Ri(n)}`](e);else if(n instanceof Array)if(typeof n[0]=="number"){if(e.length!==n[0])throw new Ne(`Expecting byte array of length ${n[0]}, but got ${e.length} bytes`);s.writeFixedArray(e)}else if(n.length===2&&typeof n[1]=="number"){if(e.length!==n[1])throw new Ne(`Expecting byte array of length ${n[1]}, but got ${e.length} bytes`);for(let o=0;o<n[1];o++)On(r,null,e[o],n[0],s)}else s.writeArray(e,o=>{On(r,t,o,n[0],s)});else if(n.kind!==void 0)switch(n.kind){case"option":{e==null?s.writeU8(0):(s.writeU8(1),On(r,t,e,n.type,s));break}case"map":{s.writeU32(e.size),e.forEach((o,i)=>{On(r,t,i,n.key,s),On(r,t,o,n.value,s)});break}default:throw new Ne(`FieldType ${n} unrecognized`)}else Ti(r,e,s)}catch(o){throw o instanceof Ne&&o.addToFieldPath(t),o}}function Ti(r,t,e){if(typeof t.borshSerialize=="function"){t.borshSerialize(e);return}const n=r.get(t.constructor);if(!n)throw new Ne(`Class ${t.constructor.name} is missing in schema`);if(n.kind==="struct")n.fields.map(([s,o])=>{On(r,s,t[s],o,e)});else if(n.kind==="enum"){const s=t[n.field];for(let o=0;o<n.values.length;++o){const[i,f]=n.values[o];if(i===s){e.writeU8(o),On(r,i,t[i],f,e);break}}}else throw new Ne(`Unexpected schema kind: ${n.kind} for ${t.constructor.name}`)}function of(r,t,e=Ii){const n=new e;return Ti(r,t,n),n.toArray()}var Ci=Ae.serialize=of;function Mn(r,t,e,n){try{if(typeof e=="string")return n[`read${Ri(e)}`]();if(e instanceof Array){if(typeof e[0]=="number")return n.readFixedArray(e[0]);if(typeof e[1]=="number"){const s=[];for(let o=0;o<e[1];o++)s.push(Mn(r,null,e[0],n));return s}else return n.readArray(()=>Mn(r,t,e[0],n))}if(e.kind==="option")return n.readU8()?Mn(r,t,e.type,n):void 0;if(e.kind==="map"){let s=new Map;const o=n.readU32();for(let i=0;i<o;i++){const f=Mn(r,t,e.key,n),u=Mn(r,t,e.value,n);s.set(f,u)}return s}return uo(r,e,n)}catch(s){throw s instanceof Ne&&s.addToFieldPath(t),s}}function uo(r,t,e){if(typeof t.borshDeserialize=="function")return t.borshDeserialize(e);const n=r.get(t);if(!n)throw new Ne(`Class ${t.name} is missing in schema`);if(n.kind==="struct"){const s={};for(const[o,i]of r.get(t).fields)s[o]=Mn(r,o,i,e);return new t(s)}if(n.kind==="enum"){const s=e.readU8();if(s>=n.values.length)throw new Ne(`Enum index: ${s} is out of range`);const[o,i]=n.values[s],f=Mn(r,o,i,e);return new t({[o]:f})}throw new Ne(`Unexpected schema kind: ${n.kind} for ${t.constructor.name}`)}function af(r,t,e,n=je){const s=new n(e),o=uo(r,t,s);if(s.offset<e.length)throw new Ne(`Unexpected ${e.length-s.offset} bytes after deserialized data`);return o}var Li=Ae.deserialize=af;function cf(r,t,e,n=je){const s=new n(e);return uo(r,t,s)}Bi=Ae.deserializeUnchecked=cf;var B={};Object.defineProperty(B,"__esModule",{value:!0});B.s16=B.s8=B.nu64be=B.u48be=B.u40be=B.u32be=B.u24be=B.u16be=_e=B.nu64=B.u48=B.u40=gt=B.u32=B.u24=We=B.u16=Vt=B.u8=zn=B.offset=B.greedy=B.Constant=B.UTF8=B.CString=B.Blob=B.Boolean=B.BitField=B.BitStructure=B.VariantLayout=B.Union=B.UnionLayoutDiscriminator=B.UnionDiscriminator=B.Structure=B.Sequence=B.DoubleBE=B.Double=B.FloatBE=B.Float=B.NearInt64BE=B.NearInt64=B.NearUInt64BE=B.NearUInt64=B.IntBE=B.Int=B.UIntBE=B.UInt=B.OffsetLayout=B.GreedyCount=B.ExternalLayout=B.bindConstructorLayout=B.nameWithProperty=B.Layout=B.uint8ArrayToBuffer=B.checkUint8Array=void 0;B.constant=B.utf8=B.cstr=Qt=B.blob=B.unionLayoutDiscriminator=B.union=Pe=B.seq=B.bits=ft=B.struct=B.f64be=B.f64=B.f32be=B.f32=B.ns64be=B.s48be=B.s40be=B.s32be=B.s24be=B.s16be=Ke=B.ns64=B.s48=B.s40=B.s32=B.s24=void 0;const lo=Lt;function dr(r){if(!(r instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}B.checkUint8Array=dr;function Wt(r){return dr(r),lo.Buffer.from(r.buffer,r.byteOffset,r.length)}B.uint8ArrayToBuffer=Wt;class Yt{constructor(t,e){if(!Number.isInteger(t))throw new TypeError("span must be an integer");this.span=t,this.property=e}makeDestinationObject(){return{}}getSpan(t,e){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(t){const e=Object.create(this.constructor.prototype);return Object.assign(e,this),e.property=t,e}fromArray(t){}}B.Layout=Yt;function ho(r,t){return t.property?r+"["+t.property+"]":r}B.nameWithProperty=ho;function ff(r,t){if(typeof r!="function")throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(r,"layout_"))throw new Error("Class is already bound to a layout");if(!(t&&t instanceof Yt))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(t,"boundConstructor_"))throw new Error("layout is already bound to a constructor");r.layout_=t,t.boundConstructor_=r,t.makeDestinationObject=()=>new r,Object.defineProperty(r.prototype,"encode",{value(e,n){return t.encode(this,e,n)},writable:!0}),Object.defineProperty(r,"decode",{value(e,n){return t.decode(e,n)},writable:!0})}B.bindConstructorLayout=ff;class Fe extends Yt{isCount(){throw new Error("ExternalLayout is abstract")}}B.ExternalLayout=Fe;class Ui extends Fe{constructor(t=1,e){if(!Number.isInteger(t)||0>=t)throw new TypeError("elementSpan must be a (positive) integer");super(-1,e),this.elementSpan=t}isCount(){return!0}decode(t,e=0){dr(t);const n=t.length-e;return Math.floor(n/this.elementSpan)}encode(t,e,n){return 0}}B.GreedyCount=Ui;class go extends Fe{constructor(t,e=0,n){if(!(t instanceof Yt))throw new TypeError("layout must be a Layout");if(!Number.isInteger(e))throw new TypeError("offset must be integer or undefined");super(t.span,n||t.property),this.layout=t,this.offset=e}isCount(){return this.layout instanceof Ge||this.layout instanceof Je}decode(t,e=0){return this.layout.decode(t,e+this.offset)}encode(t,e,n=0){return this.layout.encode(t,e,n+this.offset)}}B.OffsetLayout=go;class Ge extends Yt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return Wt(t).readUIntLE(e,this.span)}encode(t,e,n=0){return Wt(e).writeUIntLE(t,n,this.span),this.span}}B.UInt=Ge;class Je extends Yt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return Wt(t).readUIntBE(e,this.span)}encode(t,e,n=0){return Wt(e).writeUIntBE(t,n,this.span),this.span}}B.UIntBE=Je;class Hn extends Yt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return Wt(t).readIntLE(e,this.span)}encode(t,e,n=0){return Wt(e).writeIntLE(t,n,this.span),this.span}}B.Int=Hn;class hr extends Yt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return Wt(t).readIntBE(e,this.span)}encode(t,e,n=0){return Wt(e).writeIntBE(t,n,this.span),this.span}}B.IntBE=hr;const Gs=Math.pow(2,32);function ds(r){const t=Math.floor(r/Gs),e=r-t*Gs;return{hi32:t,lo32:e}}function hs(r,t){return r*Gs+t}class Pi extends Yt{constructor(t){super(8,t)}decode(t,e=0){const n=Wt(t),s=n.readUInt32LE(e),o=n.readUInt32LE(e+4);return hs(o,s)}encode(t,e,n=0){const s=ds(t),o=Wt(e);return o.writeUInt32LE(s.lo32,n),o.writeUInt32LE(s.hi32,n+4),8}}B.NearUInt64=Pi;class Ni extends Yt{constructor(t){super(8,t)}decode(t,e=0){const n=Wt(t),s=n.readUInt32BE(e),o=n.readUInt32BE(e+4);return hs(s,o)}encode(t,e,n=0){const s=ds(t),o=Wt(e);return o.writeUInt32BE(s.hi32,n),o.writeUInt32BE(s.lo32,n+4),8}}B.NearUInt64BE=Ni;class Oi extends Yt{constructor(t){super(8,t)}decode(t,e=0){const n=Wt(t),s=n.readUInt32LE(e),o=n.readInt32LE(e+4);return hs(o,s)}encode(t,e,n=0){const s=ds(t),o=Wt(e);return o.writeUInt32LE(s.lo32,n),o.writeInt32LE(s.hi32,n+4),8}}B.NearInt64=Oi;class Mi extends Yt{constructor(t){super(8,t)}decode(t,e=0){const n=Wt(t),s=n.readInt32BE(e),o=n.readUInt32BE(e+4);return hs(s,o)}encode(t,e,n=0){const s=ds(t),o=Wt(e);return o.writeInt32BE(s.hi32,n),o.writeUInt32BE(s.lo32,n+4),8}}B.NearInt64BE=Mi;class Fi extends Yt{constructor(t){super(4,t)}decode(t,e=0){return Wt(t).readFloatLE(e)}encode(t,e,n=0){return Wt(e).writeFloatLE(t,n),4}}B.Float=Fi;class zi extends Yt{constructor(t){super(4,t)}decode(t,e=0){return Wt(t).readFloatBE(e)}encode(t,e,n=0){return Wt(e).writeFloatBE(t,n),4}}B.FloatBE=zi;class qi extends Yt{constructor(t){super(8,t)}decode(t,e=0){return Wt(t).readDoubleLE(e)}encode(t,e,n=0){return Wt(e).writeDoubleLE(t,n),8}}B.Double=qi;class Ki extends Yt{constructor(t){super(8,t)}decode(t,e=0){return Wt(t).readDoubleBE(e)}encode(t,e,n=0){return Wt(e).writeDoubleBE(t,n),8}}B.DoubleBE=Ki;class Di extends Yt{constructor(t,e,n){if(!(t instanceof Yt))throw new TypeError("elementLayout must be a Layout");if(!(e instanceof Fe&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let s=-1;!(e instanceof Fe)&&0<t.span&&(s=e*t.span),super(s,n),this.elementLayout=t,this.count=e}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0,s=this.count;if(s instanceof Fe&&(s=s.decode(t,e)),0<this.elementLayout.span)n=s*this.elementLayout.span;else{let o=0;for(;o<s;)n+=this.elementLayout.getSpan(t,e+n),++o}return n}decode(t,e=0){const n=[];let s=0,o=this.count;for(o instanceof Fe&&(o=o.decode(t,e));s<o;)n.push(this.elementLayout.decode(t,e)),e+=this.elementLayout.getSpan(t,e),s+=1;return n}encode(t,e,n=0){const s=this.elementLayout,o=t.reduce((i,f)=>i+s.encode(f,e,n+i),0);return this.count instanceof Fe&&this.count.encode(t.length,e,n),o}}B.Sequence=Di;class Hi extends Yt{constructor(t,e,n){if(!(Array.isArray(t)&&t.reduce((o,i)=>o&&i instanceof Yt,!0)))throw new TypeError("fields must be array of Layout instances");typeof e=="boolean"&&n===void 0&&(n=e,e=void 0);for(const o of t)if(0>o.span&&o.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let s=-1;try{s=t.reduce((o,i)=>o+i.getSpan(),0)}catch{}super(s,e),this.fields=t,this.decodePrefixes=!!n}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0;try{n=this.fields.reduce((s,o)=>{const i=o.getSpan(t,e);return e+=i,s+i},0)}catch{throw new RangeError("indeterminate span")}return n}decode(t,e=0){dr(t);const n=this.makeDestinationObject();for(const s of this.fields)if(s.property!==void 0&&(n[s.property]=s.decode(t,e)),e+=s.getSpan(t,e),this.decodePrefixes&&t.length===e)break;return n}encode(t,e,n=0){const s=n;let o=0,i=0;for(const f of this.fields){let u=f.span;if(i=0<u?u:0,f.property!==void 0){const g=t[f.property];g!==void 0&&(i=f.encode(g,e,n),0>u&&(u=f.getSpan(e,n)))}o=n,n+=u}return o+i-s}fromArray(t){const e=this.makeDestinationObject();for(const n of this.fields)n.property!==void 0&&0<t.length&&(e[n.property]=t.shift());return e}layoutFor(t){if(typeof t!="string")throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}offsetOf(t){if(typeof t!="string")throw new TypeError("property must be string");let e=0;for(const n of this.fields){if(n.property===t)return e;0>n.span?e=-1:0<=e&&(e+=n.span)}}}B.Structure=Hi;class po{constructor(t){this.property=t}decode(t,e){throw new Error("UnionDiscriminator is abstract")}encode(t,e,n){throw new Error("UnionDiscriminator is abstract")}}B.UnionDiscriminator=po;class ts extends po{constructor(t,e){if(!(t instanceof Fe&&t.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(e||t.property||"variant"),this.layout=t}decode(t,e){return this.layout.decode(t,e)}encode(t,e,n){return this.layout.encode(t,e,n)}}B.UnionLayoutDiscriminator=ts;class yo extends Yt{constructor(t,e,n){let s;if(t instanceof Ge||t instanceof Je)s=new ts(new go(t));else if(t instanceof Fe&&t.isCount())s=new ts(t);else if(t instanceof po)s=t;else throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(e===void 0&&(e=null),!(e===null||e instanceof Yt))throw new TypeError("defaultLayout must be null or a Layout");if(e!==null){if(0>e.span)throw new Error("defaultLayout must have constant span");e.property===void 0&&(e=e.replicate("content"))}let o=-1;e&&(o=e.span,0<=o&&(t instanceof Ge||t instanceof Je)&&(o+=s.layout.span)),super(o,n),this.discriminator=s,this.usesPrefixDiscriminator=t instanceof Ge||t instanceof Je,this.defaultLayout=e,this.registry={};let i=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(f){return i(f)},this.configGetSourceVariant=function(f){i=f.bind(this)}}getSpan(t,e=0){if(0<=this.span)return this.span;const n=this.getVariant(t,e);if(!n)throw new Error("unable to determine span for unrecognized variant");return n.getSpan(t,e)}defaultGetSourceVariant(t){if(Object.prototype.hasOwnProperty.call(t,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(t,this.defaultLayout.property))return;const e=this.registry[t[this.discriminator.property]];if(e&&(!e.layout||e.property&&Object.prototype.hasOwnProperty.call(t,e.property)))return e}else for(const e in this.registry){const n=this.registry[e];if(n.property&&Object.prototype.hasOwnProperty.call(t,n.property))return n}throw new Error("unable to infer src variant")}decode(t,e=0){let n;const s=this.discriminator,o=s.decode(t,e),i=this.registry[o];if(i===void 0){const f=this.defaultLayout;let u=0;this.usesPrefixDiscriminator&&(u=s.layout.span),n=this.makeDestinationObject(),n[s.property]=o,n[f.property]=f.decode(t,e+u)}else n=i.decode(t,e);return n}encode(t,e,n=0){const s=this.getSourceVariant(t);if(s===void 0){const o=this.discriminator,i=this.defaultLayout;let f=0;return this.usesPrefixDiscriminator&&(f=o.layout.span),o.encode(t[o.property],e,n),f+i.encode(t[i.property],e,n+f)}return s.encode(t,e,n)}addVariant(t,e,n){const s=new $i(this,t,e,n);return this.registry[t]=s,s}getVariant(t,e=0){let n;return t instanceof Uint8Array?n=this.discriminator.decode(t,e):n=t,this.registry[n]}}B.Union=yo;class $i extends Yt{constructor(t,e,n,s){if(!(t instanceof yo))throw new TypeError("union must be a Union");if(!Number.isInteger(e)||0>e)throw new TypeError("variant must be a (non-negative) integer");if(typeof n=="string"&&s===void 0&&(s=n,n=null),n){if(!(n instanceof Yt))throw new TypeError("layout must be a Layout");if(t.defaultLayout!==null&&0<=n.span&&n.span>t.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof s!="string")throw new TypeError("variant must have a String property")}let o=t.span;0>t.span&&(o=n?n.span:0,0<=o&&t.usesPrefixDiscriminator&&(o+=t.discriminator.layout.span)),super(o,s),this.union=t,this.variant=e,this.layout=n||null}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0;this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span);let s=0;return this.layout&&(s=this.layout.getSpan(t,e+n)),n+s}decode(t,e=0){const n=this.makeDestinationObject();if(this!==this.union.getVariant(t,e))throw new Error("variant mismatch");let s=0;return this.union.usesPrefixDiscriminator&&(s=this.union.discriminator.layout.span),this.layout?n[this.property]=this.layout.decode(t,e+s):this.property?n[this.property]=!0:this.union.usesPrefixDiscriminator&&(n[this.union.discriminator.property]=this.variant),n}encode(t,e,n=0){let s=0;if(this.union.usesPrefixDiscriminator&&(s=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(t,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,e,n);let o=s;if(this.layout&&(this.layout.encode(t[this.property],e,n+s),o+=this.layout.getSpan(e,n+s),0<=this.union.span&&o>this.union.span))throw new Error("encoded variant overruns containing union");return o}fromArray(t){if(this.layout)return this.layout.fromArray(t)}}B.VariantLayout=$i;function Xn(r){return 0>r&&(r+=4294967296),r}class wo extends Yt{constructor(t,e,n){if(!(t instanceof Ge||t instanceof Je))throw new TypeError("word must be a UInt or UIntBE layout");if(typeof e=="string"&&n===void 0&&(n=e,e=!1),4<t.span)throw new RangeError("word cannot exceed 32 bits");super(t.span,n),this.word=t,this.msb=!!e,this.fields=[];let s=0;this._packedSetValue=function(o){return s=Xn(o),this},this._packedGetValue=function(){return s}}decode(t,e=0){const n=this.makeDestinationObject(),s=this.word.decode(t,e);this._packedSetValue(s);for(const o of this.fields)o.property!==void 0&&(n[o.property]=o.decode(t));return n}encode(t,e,n=0){const s=this.word.decode(e,n);this._packedSetValue(s);for(const o of this.fields)if(o.property!==void 0){const i=t[o.property];i!==void 0&&o.encode(i)}return this.word.encode(this._packedGetValue(),e,n)}addField(t,e){const n=new bo(this,t,e);return this.fields.push(n),n}addBoolean(t){const e=new ji(this,t);return this.fields.push(e),e}fieldFor(t){if(typeof t!="string")throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}}B.BitStructure=wo;class bo{constructor(t,e,n){if(!(t instanceof wo))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(e)||0>=e)throw new TypeError("bits must be positive integer");const s=8*t.span,o=t.fields.reduce((i,f)=>i+f.bits,0);if(e+o>s)throw new Error("bits too long for span remainder ("+(s-o)+" of "+s+" remain)");this.container=t,this.bits=e,this.valueMask=(1<<e)-1,e===32&&(this.valueMask=4294967295),this.start=o,this.container.msb&&(this.start=s-o-e),this.wordMask=Xn(this.valueMask<<this.start),this.property=n}decode(t,e){const n=this.container._packedGetValue();return Xn(n&this.wordMask)>>>this.start}encode(t){if(typeof t!="number"||!Number.isInteger(t)||t!==Xn(t&this.valueMask))throw new TypeError(ho("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const e=this.container._packedGetValue(),n=Xn(t<<this.start);this.container._packedSetValue(Xn(e&~this.wordMask)|n)}}B.BitField=bo;let ji=class extends bo{constructor(t,e){super(t,1,e)}decode(t,e){return!!super.decode(t,e)}encode(t){typeof t=="boolean"&&(t=+t),super.encode(t)}};B.Boolean=ji;class Wi extends Yt{constructor(t,e){if(!(t instanceof Fe&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;t instanceof Fe||(n=t),super(n,e),this.length=t}getSpan(t,e){let n=this.span;return 0>n&&(n=this.length.decode(t,e)),n}decode(t,e=0){let n=this.span;return 0>n&&(n=this.length.decode(t,e)),Wt(t).slice(e,e+n)}encode(t,e,n){let s=this.length;if(this.length instanceof Fe&&(s=t.length),!(t instanceof Uint8Array&&s===t.length))throw new TypeError(ho("Blob.encode",this)+" requires (length "+s+") Uint8Array as src");if(n+s>e.length)throw new RangeError("encoding overruns Uint8Array");const o=Wt(t);return Wt(e).write(o.toString("hex"),n,s,"hex"),this.length instanceof Fe&&this.length.encode(s,e,n),s}}B.Blob=Wi;class Vi extends Yt{constructor(t){super(-1,t)}getSpan(t,e=0){dr(t);let n=e;for(;n<t.length&&t[n]!==0;)n+=1;return 1+n-e}decode(t,e=0){const n=this.getSpan(t,e);return Wt(t).slice(e,e+n-1).toString("utf-8")}encode(t,e,n=0){typeof t!="string"&&(t=String(t));const s=lo.Buffer.from(t,"utf8"),o=s.length;if(n+o>e.length)throw new RangeError("encoding overruns Buffer");const i=Wt(e);return s.copy(i,n),i[n+o]=0,o+1}}B.CString=Vi;class Gi extends Yt{constructor(t,e){if(typeof t=="string"&&e===void 0&&(e=t,t=void 0),t===void 0)t=-1;else if(!Number.isInteger(t))throw new TypeError("maxSpan must be an integer");super(-1,e),this.maxSpan=t}getSpan(t,e=0){return dr(t),t.length-e}decode(t,e=0){const n=this.getSpan(t,e);if(0<=this.maxSpan&&this.maxSpan<n)throw new RangeError("text length exceeds maxSpan");return Wt(t).slice(e,e+n).toString("utf-8")}encode(t,e,n=0){typeof t!="string"&&(t=String(t));const s=lo.Buffer.from(t,"utf8"),o=s.length;if(0<=this.maxSpan&&this.maxSpan<o)throw new RangeError("text length exceeds maxSpan");if(n+o>e.length)throw new RangeError("encoding overruns Buffer");return s.copy(Wt(e),n),o}}B.UTF8=Gi;class Yi extends Yt{constructor(t,e){super(0,e),this.value=t}decode(t,e){return this.value}encode(t,e,n){return 0}}B.Constant=Yi;B.greedy=(r,t)=>new Ui(r,t);var zn=B.offset=(r,t,e)=>new go(r,t,e),Vt=B.u8=r=>new Ge(1,r),We=B.u16=r=>new Ge(2,r);B.u24=r=>new Ge(3,r);var gt=B.u32=r=>new Ge(4,r);B.u40=r=>new Ge(5,r);B.u48=r=>new Ge(6,r);var _e=B.nu64=r=>new Pi(r);B.u16be=r=>new Je(2,r);B.u24be=r=>new Je(3,r);B.u32be=r=>new Je(4,r);B.u40be=r=>new Je(5,r);B.u48be=r=>new Je(6,r);B.nu64be=r=>new Ni(r);B.s8=r=>new Hn(1,r);B.s16=r=>new Hn(2,r);B.s24=r=>new Hn(3,r);B.s32=r=>new Hn(4,r);B.s40=r=>new Hn(5,r);B.s48=r=>new Hn(6,r);var Ke=B.ns64=r=>new Oi(r);B.s16be=r=>new hr(2,r);B.s24be=r=>new hr(3,r);B.s32be=r=>new hr(4,r);B.s40be=r=>new hr(5,r);B.s48be=r=>new hr(6,r);B.ns64be=r=>new Mi(r);B.f32=r=>new Fi(r);B.f32be=r=>new zi(r);B.f64=r=>new qi(r);B.f64be=r=>new Ki(r);var ft=B.struct=(r,t,e)=>new Hi(r,t,e);B.bits=(r,t,e)=>new wo(r,t,e);var Pe=B.seq=(r,t,e)=>new Di(r,t,e);B.union=(r,t,e)=>new yo(r,t,e);B.unionLayoutDiscriminator=(r,t)=>new ts(r,t);var Qt=B.blob=(r,t)=>new Wi(r,t);B.cstr=r=>new Vi(r);B.utf8=(r,t)=>new Gi(r,t);B.constant=(r,t)=>new Yi(r,t);var Ur={};Object.defineProperty(Ur,"__esModule",{value:!0});function uf(r){{const t=Buffer.from(r);t.reverse();const e=t.toString("hex");return e.length===0?BigInt(0):BigInt(`0x${e}`)}}var lf=Ur.toBigIntLE=uf;function df(r){{const t=r.toString("hex");return t.length===0?BigInt(0):BigInt(`0x${t}`)}}Ur.toBigIntBE=df;function hf(r,t){{const e=r.toString(16),n=Buffer.from(e.padStart(t*2,"0").slice(0,t*2),"hex");return n.reverse(),n}}var gf=Ur.toBufferLE=hf;function pf(r,t){{const e=r.toString(16);return Buffer.from(e.padStart(t*2,"0").slice(0,t*2),"hex")}}Ur.toBufferBE=pf;class yf extends TypeError{constructor(t,e){let n;const{message:s,explanation:o,...i}=t,{path:f}=t,u=f.length===0?s:`At path: ${f.join(".")} -- ${s}`;super(o??u),o!=null&&(this.cause=u),Object.assign(this,i),this.name=this.constructor.name,this.failures=()=>n??(n=[t,...e()])}}function wf(r){return Pr(r)&&typeof r[Symbol.iterator]=="function"}function Pr(r){return typeof r=="object"&&r!=null}function es(r){return Pr(r)&&!Array.isArray(r)}function Xe(r){return typeof r=="symbol"?r.toString():typeof r=="string"?JSON.stringify(r):`${r}`}function bf(r){const{done:t,value:e}=r.next();return t?void 0:e}function mf(r,t,e,n){if(r===!0)return;r===!1?r={}:typeof r=="string"&&(r={message:r});const{path:s,branch:o}=t,{type:i}=e,{refinement:f,message:u=`Expected a value of type \`${i}\`${f?` with refinement \`${f}\``:""}, but received: \`${Xe(n)}\``}=r;return{value:n,type:i,refinement:f,key:s[s.length-1],path:s,branch:o,...r,message:u}}function*Do(r,t,e,n){wf(r)||(r=[r]);for(const s of r){const o=mf(s,t,e,n);o&&(yield o)}}function*mo(r,t,e={}){const{path:n=[],branch:s=[r],coerce:o=!1,mask:i=!1}=e,f={path:n,branch:s,mask:i};o&&(r=t.coercer(r,f));let u="valid";for(const g of t.validator(r,f))g.explanation=e.message,u="not_valid",yield[g,void 0];for(let[g,y,v]of t.entries(r,f)){const S=mo(y,v,{path:g===void 0?n:[...n,g],branch:g===void 0?s:[...s,y],coerce:o,mask:i,message:e.message});for(const b of S)b[0]?(u=b[0].refinement!=null?"not_refined":"not_valid",yield[b[0],void 0]):o&&(y=b[1],g===void 0?r=y:r instanceof Map?r.set(g,y):r instanceof Set?r.add(y):Pr(r)&&(y!==void 0||g in r)&&(r[g]=y))}if(u!=="not_valid")for(const g of t.refiner(r,f))g.explanation=e.message,u="not_refined",yield[g,void 0];u==="valid"&&(yield[void 0,r])}let cn=class{constructor(t){const{type:e,schema:n,validator:s,refiner:o,coercer:i=u=>u,entries:f=function*(){}}=t;this.type=e,this.schema=n,this.entries=f,this.coercer=i,s?this.validator=(u,g)=>{const y=s(u,g);return Do(y,g,this,u)}:this.validator=()=>[],o?this.refiner=(u,g)=>{const y=o(u,g);return Do(y,g,this,u)}:this.refiner=()=>[]}assert(t,e){return xf(t,this,e)}create(t,e){return $(t,this,e)}is(t){return Zi(t,this)}mask(t,e){return vf(t,this,e)}validate(t,e={}){return Nr(t,this,e)}};function xf(r,t,e){const n=Nr(r,t,{message:e});if(n[0])throw n[0]}function $(r,t,e){const n=Nr(r,t,{coerce:!0,message:e});if(n[0])throw n[0];return n[1]}function vf(r,t,e){const n=Nr(r,t,{coerce:!0,mask:!0,message:e});if(n[0])throw n[0];return n[1]}function Zi(r,t){return!Nr(r,t)[0]}function Nr(r,t,e={}){const n=mo(r,t,e),s=bf(n);return s[0]?[new yf(s[0],function*(){for(const i of n)i[0]&&(yield i[0])}),void 0]:[void 0,s[1]]}function $n(r,t){return new cn({type:r,schema:null,validator:t})}function Sf(){return $n("any",()=>!0)}function W(r){return new cn({type:"array",schema:r,*entries(t){if(r&&Array.isArray(t))for(const[e,n]of t.entries())yield[e,n,r]},coercer(t){return Array.isArray(t)?t.slice():t},validator(t){return Array.isArray(t)||`Expected an array value, but received: ${Xe(t)}`}})}function sn(){return $n("boolean",r=>typeof r=="boolean")}function xo(r){return $n("instance",t=>t instanceof r||`Expected a \`${r.name}\` instance, but received: ${Xe(t)}`)}function ne(r){const t=Xe(r),e=typeof r;return new cn({type:"literal",schema:e==="string"||e==="number"||e==="boolean"?r:null,validator(n){return n===r||`Expected the literal \`${t}\`, but received: ${Xe(n)}`}})}function Ef(){return $n("never",()=>!1)}function V(r){return new cn({...r,validator:(t,e)=>t===null||r.validator(t,e),refiner:(t,e)=>t===null||r.refiner(t,e)})}function _(){return $n("number",r=>typeof r=="number"&&!isNaN(r)||`Expected a number, but received: ${Xe(r)}`)}function yt(r){return new cn({...r,validator:(t,e)=>t===void 0||r.validator(t,e),refiner:(t,e)=>t===void 0||r.refiner(t,e)})}function Ji(r,t){return new cn({type:"record",schema:null,*entries(e){if(Pr(e))for(const n in e){const s=e[n];yield[n,n,r],yield[n,s,t]}},validator(e){return es(e)||`Expected an object, but received: ${Xe(e)}`},coercer(e){return es(e)?{...e}:e}})}function D(){return $n("string",r=>typeof r=="string"||`Expected a string, but received: ${Xe(r)}`)}function vo(r){const t=Ef();return new cn({type:"tuple",schema:null,*entries(e){if(Array.isArray(e)){const n=Math.max(r.length,e.length);for(let s=0;s<n;s++)yield[s,e[s],r[s]||t]}},validator(e){return Array.isArray(e)||`Expected an array, but received: ${Xe(e)}`},coercer(e){return Array.isArray(e)?e.slice():e}})}function M(r){const t=Object.keys(r);return new cn({type:"type",schema:r,*entries(e){if(Pr(e))for(const n of t)yield[n,e[n],r[n]]},validator(e){return es(e)||`Expected an object, but received: ${Xe(e)}`},coercer(e){return es(e)?{...e}:e}})}function Oe(r){const t=r.map(e=>e.type).join(" | ");return new cn({type:"union",schema:null,coercer(e,n){for(const s of r){const[o,i]=s.validate(e,{coerce:!0,mask:n.mask});if(!o)return i}return e},validator(e,n){const s=[];for(const o of r){const[...i]=mo(e,o,n),[f]=i;if(f[0])for(const[u]of i)u&&s.push(u);else return[]}return[`Expected the value to satisfy a union of \`${t}\`, but received: ${Xe(e)}`,...s]}})}function gr(){return $n("unknown",()=>!0)}function Or(r,t,e){return new cn({...r,coercer:(n,s)=>Zi(n,t)?r.coercer(e(n,s),s):r.coercer(n,s)})}var jr,_f=new Uint8Array(16);function Xi(){if(!jr&&(jr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!jr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return jr(_f)}const Af=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function gs(r){return typeof r=="string"&&Af.test(r)}var Ee=[];for(var Ns=0;Ns<256;++Ns)Ee.push((Ns+256).toString(16).substr(1));function ps(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=(Ee[r[t+0]]+Ee[r[t+1]]+Ee[r[t+2]]+Ee[r[t+3]]+"-"+Ee[r[t+4]]+Ee[r[t+5]]+"-"+Ee[r[t+6]]+Ee[r[t+7]]+"-"+Ee[r[t+8]]+Ee[r[t+9]]+"-"+Ee[r[t+10]]+Ee[r[t+11]]+Ee[r[t+12]]+Ee[r[t+13]]+Ee[r[t+14]]+Ee[r[t+15]]).toLowerCase();if(!gs(e))throw TypeError("Stringified UUID is invalid");return e}var Ho,Os,Ms=0,Fs=0;function Bf(r,t,e){var n=t&&e||0,s=t||new Array(16);r=r||{};var o=r.node||Ho,i=r.clockseq!==void 0?r.clockseq:Os;if(o==null||i==null){var f=r.random||(r.rng||Xi)();o==null&&(o=Ho=[f[0]|1,f[1],f[2],f[3],f[4],f[5]]),i==null&&(i=Os=(f[6]<<8|f[7])&16383)}var u=r.msecs!==void 0?r.msecs:Date.now(),g=r.nsecs!==void 0?r.nsecs:Fs+1,y=u-Ms+(g-Fs)/1e4;if(y<0&&r.clockseq===void 0&&(i=i+1&16383),(y<0||u>Ms)&&r.nsecs===void 0&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ms=u,Fs=g,Os=i,u+=122192928e5;var v=((u&268435455)*1e4+g)%4294967296;s[n++]=v>>>24&255,s[n++]=v>>>16&255,s[n++]=v>>>8&255,s[n++]=v&255;var S=u/4294967296*1e4&268435455;s[n++]=S>>>8&255,s[n++]=S&255,s[n++]=S>>>24&15|16,s[n++]=S>>>16&255,s[n++]=i>>>8|128,s[n++]=i&255;for(var b=0;b<6;++b)s[n+b]=o[b];return t||ps(s)}function Qi(r){if(!gs(r))throw TypeError("Invalid UUID");var t,e=new Uint8Array(16);return e[0]=(t=parseInt(r.slice(0,8),16))>>>24,e[1]=t>>>16&255,e[2]=t>>>8&255,e[3]=t&255,e[4]=(t=parseInt(r.slice(9,13),16))>>>8,e[5]=t&255,e[6]=(t=parseInt(r.slice(14,18),16))>>>8,e[7]=t&255,e[8]=(t=parseInt(r.slice(19,23),16))>>>8,e[9]=t&255,e[10]=(t=parseInt(r.slice(24,36),16))/1099511627776&255,e[11]=t/4294967296&255,e[12]=t>>>24&255,e[13]=t>>>16&255,e[14]=t>>>8&255,e[15]=t&255,e}function kf(r){r=unescape(encodeURIComponent(r));for(var t=[],e=0;e<r.length;++e)t.push(r.charCodeAt(e));return t}var If="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Rf="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function ta(r,t,e){function n(s,o,i,f){if(typeof s=="string"&&(s=kf(s)),typeof o=="string"&&(o=Qi(o)),o.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var u=new Uint8Array(16+s.length);if(u.set(o),u.set(s,o.length),u=e(u),u[6]=u[6]&15|t,u[8]=u[8]&63|128,i){f=f||0;for(var g=0;g<16;++g)i[f+g]=u[g];return i}return ps(u)}try{n.name=r}catch{}return n.DNS=If,n.URL=Rf,n}function Tf(r){if(typeof r=="string"){var t=unescape(encodeURIComponent(r));r=new Uint8Array(t.length);for(var e=0;e<t.length;++e)r[e]=t.charCodeAt(e)}return Cf(Lf(Uf(r),r.length*8))}function Cf(r){for(var t=[],e=r.length*32,n="0123456789abcdef",s=0;s<e;s+=8){var o=r[s>>5]>>>s%32&255,i=parseInt(n.charAt(o>>>4&15)+n.charAt(o&15),16);t.push(i)}return t}function ea(r){return(r+64>>>9<<4)+14+1}function Lf(r,t){r[t>>5]|=128<<t%32,r[ea(t)-1]=t;for(var e=1732584193,n=-271733879,s=-1732584194,o=271733878,i=0;i<r.length;i+=16){var f=e,u=n,g=s,y=o;e=Te(e,n,s,o,r[i],7,-680876936),o=Te(o,e,n,s,r[i+1],12,-389564586),s=Te(s,o,e,n,r[i+2],17,606105819),n=Te(n,s,o,e,r[i+3],22,-1044525330),e=Te(e,n,s,o,r[i+4],7,-176418897),o=Te(o,e,n,s,r[i+5],12,1200080426),s=Te(s,o,e,n,r[i+6],17,-1473231341),n=Te(n,s,o,e,r[i+7],22,-45705983),e=Te(e,n,s,o,r[i+8],7,1770035416),o=Te(o,e,n,s,r[i+9],12,-1958414417),s=Te(s,o,e,n,r[i+10],17,-42063),n=Te(n,s,o,e,r[i+11],22,-1990404162),e=Te(e,n,s,o,r[i+12],7,1804603682),o=Te(o,e,n,s,r[i+13],12,-40341101),s=Te(s,o,e,n,r[i+14],17,-1502002290),n=Te(n,s,o,e,r[i+15],22,1236535329),e=Ce(e,n,s,o,r[i+1],5,-165796510),o=Ce(o,e,n,s,r[i+6],9,-1069501632),s=Ce(s,o,e,n,r[i+11],14,643717713),n=Ce(n,s,o,e,r[i],20,-373897302),e=Ce(e,n,s,o,r[i+5],5,-701558691),o=Ce(o,e,n,s,r[i+10],9,38016083),s=Ce(s,o,e,n,r[i+15],14,-660478335),n=Ce(n,s,o,e,r[i+4],20,-405537848),e=Ce(e,n,s,o,r[i+9],5,568446438),o=Ce(o,e,n,s,r[i+14],9,-1019803690),s=Ce(s,o,e,n,r[i+3],14,-187363961),n=Ce(n,s,o,e,r[i+8],20,1163531501),e=Ce(e,n,s,o,r[i+13],5,-1444681467),o=Ce(o,e,n,s,r[i+2],9,-51403784),s=Ce(s,o,e,n,r[i+7],14,1735328473),n=Ce(n,s,o,e,r[i+12],20,-1926607734),e=Le(e,n,s,o,r[i+5],4,-378558),o=Le(o,e,n,s,r[i+8],11,-2022574463),s=Le(s,o,e,n,r[i+11],16,1839030562),n=Le(n,s,o,e,r[i+14],23,-35309556),e=Le(e,n,s,o,r[i+1],4,-1530992060),o=Le(o,e,n,s,r[i+4],11,1272893353),s=Le(s,o,e,n,r[i+7],16,-155497632),n=Le(n,s,o,e,r[i+10],23,-1094730640),e=Le(e,n,s,o,r[i+13],4,681279174),o=Le(o,e,n,s,r[i],11,-358537222),s=Le(s,o,e,n,r[i+3],16,-722521979),n=Le(n,s,o,e,r[i+6],23,76029189),e=Le(e,n,s,o,r[i+9],4,-640364487),o=Le(o,e,n,s,r[i+12],11,-421815835),s=Le(s,o,e,n,r[i+15],16,530742520),n=Le(n,s,o,e,r[i+2],23,-995338651),e=Ue(e,n,s,o,r[i],6,-198630844),o=Ue(o,e,n,s,r[i+7],10,1126891415),s=Ue(s,o,e,n,r[i+14],15,-1416354905),n=Ue(n,s,o,e,r[i+5],21,-57434055),e=Ue(e,n,s,o,r[i+12],6,1700485571),o=Ue(o,e,n,s,r[i+3],10,-1894986606),s=Ue(s,o,e,n,r[i+10],15,-1051523),n=Ue(n,s,o,e,r[i+1],21,-2054922799),e=Ue(e,n,s,o,r[i+8],6,1873313359),o=Ue(o,e,n,s,r[i+15],10,-30611744),s=Ue(s,o,e,n,r[i+6],15,-1560198380),n=Ue(n,s,o,e,r[i+13],21,1309151649),e=Ue(e,n,s,o,r[i+4],6,-145523070),o=Ue(o,e,n,s,r[i+11],10,-1120210379),s=Ue(s,o,e,n,r[i+2],15,718787259),n=Ue(n,s,o,e,r[i+9],21,-343485551),e=In(e,f),n=In(n,u),s=In(s,g),o=In(o,y)}return[e,n,s,o]}function Uf(r){if(r.length===0)return[];for(var t=r.length*8,e=new Uint32Array(ea(t)),n=0;n<t;n+=8)e[n>>5]|=(r[n/8]&255)<<n%32;return e}function In(r,t){var e=(r&65535)+(t&65535),n=(r>>16)+(t>>16)+(e>>16);return n<<16|e&65535}function Pf(r,t){return r<<t|r>>>32-t}function ys(r,t,e,n,s,o){return In(Pf(In(In(t,r),In(n,o)),s),e)}function Te(r,t,e,n,s,o,i){return ys(t&e|~t&n,r,t,s,o,i)}function Ce(r,t,e,n,s,o,i){return ys(t&n|e&~n,r,t,s,o,i)}function Le(r,t,e,n,s,o,i){return ys(t^e^n,r,t,s,o,i)}function Ue(r,t,e,n,s,o,i){return ys(e^(t|~n),r,t,s,o,i)}var Nf=ta("v3",48,Tf);const Of=Nf;function Mf(r,t,e){r=r||{};var n=r.random||(r.rng||Xi)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){e=e||0;for(var s=0;s<16;++s)t[e+s]=n[s];return t}return ps(n)}function Ff(r,t,e,n){switch(r){case 0:return t&e^~t&n;case 1:return t^e^n;case 2:return t&e^t&n^e&n;case 3:return t^e^n}}function zs(r,t){return r<<t|r>>>32-t}function zf(r){var t=[1518500249,1859775393,2400959708,3395469782],e=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof r=="string"){var n=unescape(encodeURIComponent(r));r=[];for(var s=0;s<n.length;++s)r.push(n.charCodeAt(s))}else Array.isArray(r)||(r=Array.prototype.slice.call(r));r.push(128);for(var o=r.length/4+2,i=Math.ceil(o/16),f=new Array(i),u=0;u<i;++u){for(var g=new Uint32Array(16),y=0;y<16;++y)g[y]=r[u*64+y*4]<<24|r[u*64+y*4+1]<<16|r[u*64+y*4+2]<<8|r[u*64+y*4+3];f[u]=g}f[i-1][14]=(r.length-1)*8/Math.pow(2,32),f[i-1][14]=Math.floor(f[i-1][14]),f[i-1][15]=(r.length-1)*8&4294967295;for(var v=0;v<i;++v){for(var S=new Uint32Array(80),b=0;b<16;++b)S[b]=f[v][b];for(var A=16;A<80;++A)S[A]=zs(S[A-3]^S[A-8]^S[A-14]^S[A-16],1);for(var m=e[0],w=e[1],T=e[2],F=e[3],R=e[4],H=0;H<80;++H){var et=Math.floor(H/20),j=zs(m,5)+Ff(et,w,T,F)+R+t[et]+S[H]>>>0;R=F,F=T,T=zs(w,30)>>>0,w=m,m=j}e[0]=e[0]+m>>>0,e[1]=e[1]+w>>>0,e[2]=e[2]+T>>>0,e[3]=e[3]+F>>>0,e[4]=e[4]+R>>>0}return[e[0]>>24&255,e[0]>>16&255,e[0]>>8&255,e[0]&255,e[1]>>24&255,e[1]>>16&255,e[1]>>8&255,e[1]&255,e[2]>>24&255,e[2]>>16&255,e[2]>>8&255,e[2]&255,e[3]>>24&255,e[3]>>16&255,e[3]>>8&255,e[3]&255,e[4]>>24&255,e[4]>>16&255,e[4]>>8&255,e[4]&255]}var qf=ta("v5",80,zf);const Kf=qf,Df="00000000-0000-0000-0000-000000000000";function Hf(r){if(!gs(r))throw TypeError("Invalid UUID");return parseInt(r.substr(14,1),16)}const $f=Object.freeze(Object.defineProperty({__proto__:null,NIL:Df,parse:Qi,stringify:ps,v1:Bf,v3:Of,v4:Mf,v5:Kf,validate:gs,version:Hf},Symbol.toStringTag,{value:"Module"})),na=ai($f),jf=na.v4,Wf=function(r,t,e,n){if(typeof r!="string")throw new TypeError(r+" must be a string");n=n||{};const s=typeof n.version=="number"?n.version:2;if(s!==1&&s!==2)throw new TypeError(s+" must be 1 or 2");const o={method:r};if(s===2&&(o.jsonrpc="2.0"),t){if(typeof t!="object"&&!Array.isArray(t))throw new TypeError(t+" must be an object, array or omitted");o.params=t}if(typeof e>"u"){const i=typeof n.generator=="function"?n.generator:function(){return jf()};o.id=i(o,n)}else s===2&&e===null?n.notificationIdNull&&(o.id=null):o.id=e;return o};var Vf=Wf;const Gf=na.v4,Yf=Vf,Ir=function(r,t){if(!(this instanceof Ir))return new Ir(r,t);t||(t={}),this.options={reviver:typeof t.reviver<"u"?t.reviver:null,replacer:typeof t.replacer<"u"?t.replacer:null,generator:typeof t.generator<"u"?t.generator:function(){return Gf()},version:typeof t.version<"u"?t.version:2,notificationIdNull:typeof t.notificationIdNull=="boolean"?t.notificationIdNull:!1},this.callServer=r};var Zf=Ir;Ir.prototype.request=function(r,t,e,n){const s=this;let o=null;const i=Array.isArray(r)&&typeof t=="function";if(this.options.version===1&&i)throw new TypeError("JSON-RPC 1.0 does not support batching");if(i||!i&&r&&typeof r=="object"&&typeof t=="function")n=t,o=r;else{typeof e=="function"&&(n=e,e=void 0);const g=typeof n=="function";try{o=Yf(r,t,e,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(y){if(g)return n(y);throw y}if(!g)return o}let u;try{u=JSON.stringify(o,this.options.replacer)}catch(g){return n(g)}return this.callServer(u,function(g,y){s._parseResponse(g,y,n)}),o};Ir.prototype._parseResponse=function(r,t,e){if(r){e(r);return}if(!t)return e();let n;try{n=JSON.parse(t,this.options.reviver)}catch(s){return e(s)}if(e.length===3)if(Array.isArray(n)){const s=function(i){return typeof i.error<"u"},o=function(i){return!s(i)};return e(null,n.filter(s),n.filter(o))}else return e(null,n.error,n.result);e(null,n)};const Jf=is(Zf);var Xf=class extends di{constructor(t,e,n){super();me(this,"socket");this.socket=new window.WebSocket(t,n),this.socket.onopen=()=>this.emit("open"),this.socket.onmessage=s=>this.emit("message",s.data),this.socket.onerror=s=>this.emit("error",s),this.socket.onclose=s=>{this.emit("close",s.code,s.reason)}}send(t,e,n){const s=n||e;try{this.socket.send(t),s()}catch(o){s(o)}}close(t,e){this.socket.close(t,e)}addEventListener(t,e,n){this.socket.addEventListener(t,e,n)}};function Qf(r,t){return new Xf(r,t)}var tu=class{encode(r){return JSON.stringify(r)}decode(r){return JSON.parse(r)}},eu=class extends di{constructor(t,e="ws://localhost:8080",{autoconnect:n=!0,reconnect:s=!0,reconnect_interval:o=1e3,max_reconnects:i=5,...f}={},u,g){super();me(this,"address");me(this,"rpc_id");me(this,"queue");me(this,"options");me(this,"autoconnect");me(this,"ready");me(this,"reconnect");me(this,"reconnect_timer_id");me(this,"reconnect_interval");me(this,"max_reconnects");me(this,"rest_options");me(this,"current_reconnects");me(this,"generate_request_id");me(this,"socket");me(this,"webSocketFactory");me(this,"dataPack");this.webSocketFactory=t,this.queue={},this.rpc_id=0,this.address=e,this.autoconnect=n,this.ready=!1,this.reconnect=s,this.reconnect_timer_id=void 0,this.reconnect_interval=o,this.max_reconnects=i,this.rest_options=f,this.current_reconnects=0,this.generate_request_id=u||(()=>++this.rpc_id),g?this.dataPack=g:this.dataPack=new tu,this.autoconnect&&this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}connect(){this.socket||this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}call(t,e,n,s){return!s&&typeof n=="object"&&(s=n,n=null),new Promise((o,i)=>{if(!this.ready)return i(new Error("socket not ready"));const f=this.generate_request_id(t,e),u={jsonrpc:"2.0",method:t,params:e||void 0,id:f};this.socket.send(this.dataPack.encode(u),s,g=>{if(g)return i(g);this.queue[f]={promise:[o,i]},n&&(this.queue[f].timeout=setTimeout(()=>{delete this.queue[f],i(new Error("reply timeout"))},n))})})}async login(t){const e=await this.call("rpc.login",t);if(!e)throw new Error("authentication failed");return e}async listMethods(){return await this.call("__listMethods")}notify(t,e){return new Promise((n,s)=>{if(!this.ready)return s(new Error("socket not ready"));const o={jsonrpc:"2.0",method:t,params:e};this.socket.send(this.dataPack.encode(o),i=>{if(i)return s(i);n()})})}async subscribe(t){typeof t=="string"&&(t=[t]);const e=await this.call("rpc.on",t);if(typeof t=="string"&&e[t]!=="ok")throw new Error("Failed subscribing to an event '"+t+"' with: "+e[t]);return e}async unsubscribe(t){typeof t=="string"&&(t=[t]);const e=await this.call("rpc.off",t);if(typeof t=="string"&&e[t]!=="ok")throw new Error("Failed unsubscribing from an event with: "+e);return e}close(t,e){this.socket.close(t||1e3,e)}setAutoReconnect(t){this.reconnect=t}setReconnectInterval(t){this.reconnect_interval=t}setMaxReconnects(t){this.max_reconnects=t}_connect(t,e){clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(t,e),this.socket.addEventListener("open",()=>{this.ready=!0,this.emit("open"),this.current_reconnects=0}),this.socket.addEventListener("message",({data:n})=>{n instanceof ArrayBuffer&&(n=Lt.Buffer.from(n).toString());try{n=this.dataPack.decode(n)}catch{return}if(n.notification&&this.listeners(n.notification).length){if(!Object.keys(n.params).length)return this.emit(n.notification);const s=[n.notification];if(n.params.constructor===Object)s.push(n.params);else for(let o=0;o<n.params.length;o++)s.push(n.params[o]);return Promise.resolve().then(()=>{this.emit.apply(this,s)})}if(!this.queue[n.id])return n.method?Promise.resolve().then(()=>{this.emit(n.method,n==null?void 0:n.params)}):void 0;"error"in n=="result"in n&&this.queue[n.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),this.queue[n.id].timeout&&clearTimeout(this.queue[n.id].timeout),n.error?this.queue[n.id].promise[1](n.error):this.queue[n.id].promise[0](n.result),delete this.queue[n.id]}),this.socket.addEventListener("error",n=>this.emit("error",n)),this.socket.addEventListener("close",({code:n,reason:s})=>{this.ready&&setTimeout(()=>this.emit("close",n,s),0),this.ready=!1,this.socket=void 0,n!==1e3&&(this.current_reconnects++,this.reconnect&&(this.max_reconnects>this.current_reconnects||this.max_reconnects===0)&&(this.reconnect_timer_id=setTimeout(()=>this._connect(t,e),this.reconnect_interval)))})}};class ra extends ci{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,Ha(t);const n=fi(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,o=new Uint8Array(s);o.set(n.length>s?t.create().update(n).digest():n);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=t.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),o.fill(0)}update(t){return Yr(this),this.iHash.update(t),this}digestInto(t){Yr(this),$a(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:s,destroyed:o,blockLen:i,outputLen:f}=this;return t=t,t.finished=s,t.destroyed=o,t.blockLen=i,t.outputLen=f,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const sa=(r,t,e)=>new ra(r,t).update(e).digest();sa.create=(r,t)=>new ra(r,t);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function $o(r){r.lowS!==void 0&&yn("lowS",r.lowS),r.prehash!==void 0&&yn("prehash",r.prehash)}function nu(r){const t=ao(r);ur(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:e,Fp:n,a:s}=t;if(e){if(!n.eql(s,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof e!="object"||typeof e.beta!="bigint"||typeof e.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:ru,hexToBytes:su}=gc;class ou extends Error{constructor(t=""){super(t)}}const dn={Err:ou,_tlv:{encode:(r,t)=>{const{Err:e}=dn;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(t.length&1)throw new e("tlv.encode: unpadded data");const n=t.length/2,s=tr(n);if(s.length/2&128)throw new e("tlv.encode: long form length too big");const o=n>127?tr(s.length/2|128):"";return tr(r)+o+s+t},decode(r,t){const{Err:e}=dn;let n=0;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[n++]!==r)throw new e("tlv.decode: wrong tlv");const s=t[n++],o=!!(s&128);let i=0;if(!o)i=s;else{const u=s&127;if(!u)throw new e("tlv.decode(long): indefinite length not supported");if(u>4)throw new e("tlv.decode(long): byte length is too big");const g=t.subarray(n,n+u);if(g.length!==u)throw new e("tlv.decode: length bytes not complete");if(g[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(const y of g)i=i<<8|y;if(n+=u,i<128)throw new e("tlv.decode(long): not minimal encoding")}const f=t.subarray(n,n+i);if(f.length!==i)throw new e("tlv.decode: wrong value length");return{v:f,l:t.subarray(n+i)}}},_int:{encode(r){const{Err:t}=dn;if(r<gn)throw new t("integer: negative integers are not allowed");let e=tr(r);if(Number.parseInt(e[0],16)&8&&(e="00"+e),e.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return e},decode(r){const{Err:t}=dn;if(r[0]&128)throw new t("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return ru(r)}},toSig(r){const{Err:t,_int:e,_tlv:n}=dn,s=typeof r=="string"?su(r):r;Lr(s);const{v:o,l:i}=n.decode(48,s);if(i.length)throw new t("invalid signature: left bytes after parsing");const{v:f,l:u}=n.decode(2,o),{v:g,l:y}=n.decode(2,u);if(y.length)throw new t("invalid signature: left bytes after parsing");return{r:e.decode(f),s:e.decode(g)}},hexFromSig(r){const{_tlv:t,_int:e}=dn,n=t.encode(2,e.encode(r.r)),s=t.encode(2,e.encode(r.s)),o=n+s;return t.encode(48,o)}},gn=BigInt(0),xe=BigInt(1);BigInt(2);const jo=BigInt(3);BigInt(4);function iu(r){const t=nu(r),{Fp:e}=t,n=us(t.n,t.nBitLength),s=t.toBytes||((m,w,T)=>{const F=w.toAffine();return Dn(Uint8Array.from([4]),e.toBytes(F.x),e.toBytes(F.y))}),o=t.fromBytes||(m=>{const w=m.subarray(1),T=e.fromBytes(w.subarray(0,e.BYTES)),F=e.fromBytes(w.subarray(e.BYTES,2*e.BYTES));return{x:T,y:F}});function i(m){const{a:w,b:T}=t,F=e.sqr(m),R=e.mul(F,m);return e.add(e.add(R,e.mul(m,w)),T)}if(!e.eql(e.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function f(m){return fs(m,xe,t.n)}function u(m){const{allowedPrivateKeyLengths:w,nByteLength:T,wrapPrivateKey:F,n:R}=t;if(w&&typeof m!="bigint"){if(qn(m)&&(m=Kn(m)),typeof m!="string"||!w.includes(m.length))throw new Error("invalid private key");m=m.padStart(T*2,"0")}let H;try{H=typeof m=="bigint"?m:Fn(we("private key",m,T))}catch{throw new Error("invalid private key, expected hex or "+T+" bytes, got "+typeof m)}return F&&(H=ee(H,R)),Ve("private key",H,xe,R),H}function g(m){if(!(m instanceof S))throw new Error("ProjectivePoint expected")}const y=kr((m,w)=>{const{px:T,py:F,pz:R}=m;if(e.eql(R,e.ONE))return{x:T,y:F};const H=m.is0();w==null&&(w=H?e.ONE:e.inv(R));const et=e.mul(T,w),j=e.mul(F,w),G=e.mul(R,w);if(H)return{x:e.ZERO,y:e.ZERO};if(!e.eql(G,e.ONE))throw new Error("invZ was invalid");return{x:et,y:j}}),v=kr(m=>{if(m.is0()){if(t.allowInfinityPoint&&!e.is0(m.py))return;throw new Error("bad point: ZERO")}const{x:w,y:T}=m.toAffine();if(!e.isValid(w)||!e.isValid(T))throw new Error("bad point: x or y not FE");const F=e.sqr(T),R=i(w);if(!e.eql(F,R))throw new Error("bad point: equation left != right");if(!m.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class S{constructor(w,T,F){if(this.px=w,this.py=T,this.pz=F,w==null||!e.isValid(w))throw new Error("x required");if(T==null||!e.isValid(T))throw new Error("y required");if(F==null||!e.isValid(F))throw new Error("z required");Object.freeze(this)}static fromAffine(w){const{x:T,y:F}=w||{};if(!w||!e.isValid(T)||!e.isValid(F))throw new Error("invalid affine point");if(w instanceof S)throw new Error("projective point not allowed");const R=H=>e.eql(H,e.ZERO);return R(T)&&R(F)?S.ZERO:new S(T,F,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(w){const T=e.invertBatch(w.map(F=>F.pz));return w.map((F,R)=>F.toAffine(T[R])).map(S.fromAffine)}static fromHex(w){const T=S.fromAffine(o(we("pointHex",w)));return T.assertValidity(),T}static fromPrivateKey(w){return S.BASE.multiply(u(w))}static msm(w,T){return Ei(S,n,w,T)}_setWindowSize(w){A.setWindowSize(this,w)}assertValidity(){v(this)}hasEvenY(){const{y:w}=this.toAffine();if(e.isOdd)return!e.isOdd(w);throw new Error("Field doesn't support isOdd")}equals(w){g(w);const{px:T,py:F,pz:R}=this,{px:H,py:et,pz:j}=w,G=e.eql(e.mul(T,j),e.mul(H,R)),it=e.eql(e.mul(F,j),e.mul(et,R));return G&&it}negate(){return new S(this.px,e.neg(this.py),this.pz)}double(){const{a:w,b:T}=t,F=e.mul(T,jo),{px:R,py:H,pz:et}=this;let j=e.ZERO,G=e.ZERO,it=e.ZERO,ut=e.mul(R,R),Zt=e.mul(H,H),zt=e.mul(et,et),Ot=e.mul(R,H);return Ot=e.add(Ot,Ot),it=e.mul(R,et),it=e.add(it,it),j=e.mul(w,it),G=e.mul(F,zt),G=e.add(j,G),j=e.sub(Zt,G),G=e.add(Zt,G),G=e.mul(j,G),j=e.mul(Ot,j),it=e.mul(F,it),zt=e.mul(w,zt),Ot=e.sub(ut,zt),Ot=e.mul(w,Ot),Ot=e.add(Ot,it),it=e.add(ut,ut),ut=e.add(it,ut),ut=e.add(ut,zt),ut=e.mul(ut,Ot),G=e.add(G,ut),zt=e.mul(H,et),zt=e.add(zt,zt),ut=e.mul(zt,Ot),j=e.sub(j,ut),it=e.mul(zt,Zt),it=e.add(it,it),it=e.add(it,it),new S(j,G,it)}add(w){g(w);const{px:T,py:F,pz:R}=this,{px:H,py:et,pz:j}=w;let G=e.ZERO,it=e.ZERO,ut=e.ZERO;const Zt=t.a,zt=e.mul(t.b,jo);let Ot=e.mul(T,H),oe=e.mul(F,et),Y=e.mul(R,j),st=e.add(T,F),N=e.add(H,et);st=e.mul(st,N),N=e.add(Ot,oe),st=e.sub(st,N),N=e.add(T,R);let C=e.add(H,j);return N=e.mul(N,C),C=e.add(Ot,Y),N=e.sub(N,C),C=e.add(F,R),G=e.add(et,j),C=e.mul(C,G),G=e.add(oe,Y),C=e.sub(C,G),ut=e.mul(Zt,N),G=e.mul(zt,Y),ut=e.add(G,ut),G=e.sub(oe,ut),ut=e.add(oe,ut),it=e.mul(G,ut),oe=e.add(Ot,Ot),oe=e.add(oe,Ot),Y=e.mul(Zt,Y),N=e.mul(zt,N),oe=e.add(oe,Y),Y=e.sub(Ot,Y),Y=e.mul(Zt,Y),N=e.add(N,Y),Ot=e.mul(oe,N),it=e.add(it,Ot),Ot=e.mul(C,N),G=e.mul(st,G),G=e.sub(G,Ot),Ot=e.mul(st,oe),ut=e.mul(C,ut),ut=e.add(ut,Ot),new S(G,it,ut)}subtract(w){return this.add(w.negate())}is0(){return this.equals(S.ZERO)}wNAF(w){return A.wNAFCached(this,w,S.normalizeZ)}multiplyUnsafe(w){const{endo:T,n:F}=t;Ve("scalar",w,gn,F);const R=S.ZERO;if(w===gn)return R;if(this.is0()||w===xe)return this;if(!T||A.hasPrecomputes(this))return A.wNAFCachedUnsafe(this,w,S.normalizeZ);let{k1neg:H,k1:et,k2neg:j,k2:G}=T.splitScalar(w),it=R,ut=R,Zt=this;for(;et>gn||G>gn;)et&xe&&(it=it.add(Zt)),G&xe&&(ut=ut.add(Zt)),Zt=Zt.double(),et>>=xe,G>>=xe;return H&&(it=it.negate()),j&&(ut=ut.negate()),ut=new S(e.mul(ut.px,T.beta),ut.py,ut.pz),it.add(ut)}multiply(w){const{endo:T,n:F}=t;Ve("scalar",w,xe,F);let R,H;if(T){const{k1neg:et,k1:j,k2neg:G,k2:it}=T.splitScalar(w);let{p:ut,f:Zt}=this.wNAF(j),{p:zt,f:Ot}=this.wNAF(it);ut=A.constTimeNegate(et,ut),zt=A.constTimeNegate(G,zt),zt=new S(e.mul(zt.px,T.beta),zt.py,zt.pz),R=ut.add(zt),H=Zt.add(Ot)}else{const{p:et,f:j}=this.wNAF(w);R=et,H=j}return S.normalizeZ([R,H])[0]}multiplyAndAddUnsafe(w,T,F){const R=S.BASE,H=(j,G)=>G===gn||G===xe||!j.equals(R)?j.multiplyUnsafe(G):j.multiply(G),et=H(this,T).add(H(w,F));return et.is0()?void 0:et}toAffine(w){return y(this,w)}isTorsionFree(){const{h:w,isTorsionFree:T}=t;if(w===xe)return!0;if(T)return T(S,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:w,clearCofactor:T}=t;return w===xe?this:T?T(S,this):this.multiplyUnsafe(t.h)}toRawBytes(w=!0){return yn("isCompressed",w),this.assertValidity(),s(S,this,w)}toHex(w=!0){return yn("isCompressed",w),Kn(this.toRawBytes(w))}}S.BASE=new S(t.Gx,t.Gy,e.ONE),S.ZERO=new S(e.ZERO,e.ONE,e.ZERO);const b=t.nBitLength,A=Si(S,t.endo?Math.ceil(b/2):b);return{CURVE:t,ProjectivePoint:S,normPrivateKeyToScalar:u,weierstrassEquation:i,isWithinCurveOrder:f}}function au(r){const t=ao(r);return ur(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function cu(r){const t=au(r),{Fp:e,n}=t,s=e.BYTES+1,o=2*e.BYTES+1;function i(Y){return ee(Y,n)}function f(Y){return Ws(Y,n)}const{ProjectivePoint:u,normPrivateKeyToScalar:g,weierstrassEquation:y,isWithinCurveOrder:v}=iu({...t,toBytes(Y,st,N){const C=st.toAffine(),K=e.toBytes(C.x),J=Dn;return yn("isCompressed",N),N?J(Uint8Array.from([st.hasEvenY()?2:3]),K):J(Uint8Array.from([4]),K,e.toBytes(C.y))},fromBytes(Y){const st=Y.length,N=Y[0],C=Y.subarray(1);if(st===s&&(N===2||N===3)){const K=Fn(C);if(!fs(K,xe,e.ORDER))throw new Error("Point is not on curve");const J=y(K);let bt;try{bt=e.sqrt(J)}catch(vt){const ht=vt instanceof Error?": "+vt.message:"";throw new Error("Point is not on curve"+ht)}const mt=(bt&xe)===xe;return(N&1)===1!==mt&&(bt=e.neg(bt)),{x:K,y:bt}}else if(st===o&&N===4){const K=e.fromBytes(C.subarray(0,e.BYTES)),J=e.fromBytes(C.subarray(e.BYTES,2*e.BYTES));return{x:K,y:J}}else{const K=s,J=o;throw new Error("invalid Point, expected length of "+K+", or uncompressed "+J+", got "+st)}}}),S=Y=>Kn(ir(Y,t.nByteLength));function b(Y){const st=n>>xe;return Y>st}function A(Y){return b(Y)?i(-Y):Y}const m=(Y,st,N)=>Fn(Y.slice(st,N));class w{constructor(st,N,C){this.r=st,this.s=N,this.recovery=C,this.assertValidity()}static fromCompact(st){const N=t.nByteLength;return st=we("compactSignature",st,N*2),new w(m(st,0,N),m(st,N,2*N))}static fromDER(st){const{r:N,s:C}=dn.toSig(we("DER",st));return new w(N,C)}assertValidity(){Ve("r",this.r,xe,n),Ve("s",this.s,xe,n)}addRecoveryBit(st){return new w(this.r,this.s,st)}recoverPublicKey(st){const{r:N,s:C,recovery:K}=this,J=j(we("msgHash",st));if(K==null||![0,1,2,3].includes(K))throw new Error("recovery id invalid");const bt=K===2||K===3?N+t.n:N;if(bt>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");const mt=K&1?"03":"02",Tt=u.fromHex(mt+S(bt)),vt=f(bt),ht=i(-J*vt),nt=i(C*vt),Mt=u.BASE.multiplyAndAddUnsafe(Tt,ht,nt);if(!Mt)throw new Error("point at infinify");return Mt.assertValidity(),Mt}hasHighS(){return b(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,i(-this.s),this.recovery):this}toDERRawBytes(){return or(this.toDERHex())}toDERHex(){return dn.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return or(this.toCompactHex())}toCompactHex(){return S(this.r)+S(this.s)}}const T={isValidPrivateKey(Y){try{return g(Y),!0}catch{return!1}},normPrivateKeyToScalar:g,randomPrivateKey:()=>{const Y=mi(t.n);return _c(t.randomBytes(Y),t.n)},precompute(Y=8,st=u.BASE){return st._setWindowSize(Y),st.multiply(BigInt(3)),st}};function F(Y,st=!0){return u.fromPrivateKey(Y).toRawBytes(st)}function R(Y){const st=qn(Y),N=typeof Y=="string",C=(st||N)&&Y.length;return st?C===s||C===o:N?C===2*s||C===2*o:Y instanceof u}function H(Y,st,N=!0){if(R(Y))throw new Error("first arg must be private key");if(!R(st))throw new Error("second arg must be public key");return u.fromHex(st).multiply(g(Y)).toRawBytes(N)}const et=t.bits2int||function(Y){if(Y.length>8192)throw new Error("input is too large");const st=Fn(Y),N=Y.length*8-t.nBitLength;return N>0?st>>BigInt(N):st},j=t.bits2int_modN||function(Y){return i(et(Y))},G=io(t.nBitLength);function it(Y){return Ve("num < 2^"+t.nBitLength,Y,gn,G),ir(Y,t.nByteLength)}function ut(Y,st,N=Zt){if(["recovered","canonical"].some(de=>de in N))throw new Error("sign() legacy options not supported");const{hash:C,randomBytes:K}=t;let{lowS:J,prehash:bt,extraEntropy:mt}=N;J==null&&(J=!0),Y=we("msgHash",Y),$o(N),bt&&(Y=we("prehashed msgHash",C(Y)));const Tt=j(Y),vt=g(st),ht=[it(vt),it(Tt)];if(mt!=null&&mt!==!1){const de=mt===!0?K(e.BYTES):mt;ht.push(we("extraEntropy",de))}const nt=Dn(...ht),Mt=Tt;function le(de){const ie=et(de);if(!v(ie))return;const he=f(ie),Se=u.BASE.multiply(ie).toAffine(),ye=i(Se.x);if(ye===gn)return;const ze=i(he*i(Mt+ye*vt));if(ze===gn)return;let Qe=(Se.x===ye?0:2)|Number(Se.y&xe),Ye=ze;return J&&b(ze)&&(Ye=A(ze),Qe^=1),new w(ye,Ye,Qe)}return{seed:nt,k2sig:le}}const Zt={lowS:t.lowS,prehash:!1},zt={lowS:t.lowS,prehash:!1};function Ot(Y,st,N=Zt){const{seed:C,k2sig:K}=ut(Y,st,N),J=t;return yi(J.hash.outputLen,J.nByteLength,J.hmac)(C,K)}u.BASE._setWindowSize(8);function oe(Y,st,N,C=zt){var Qe;const K=Y;st=we("msgHash",st),N=we("publicKey",N);const{lowS:J,prehash:bt,format:mt}=C;if($o(C),"strict"in C)throw new Error("options.strict was renamed to lowS");if(mt!==void 0&&mt!=="compact"&&mt!=="der")throw new Error("format must be compact or der");const Tt=typeof K=="string"||qn(K),vt=!Tt&&!mt&&typeof K=="object"&&K!==null&&typeof K.r=="bigint"&&typeof K.s=="bigint";if(!Tt&&!vt)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let ht,nt;try{if(vt&&(ht=new w(K.r,K.s)),Tt){try{mt!=="compact"&&(ht=w.fromDER(K))}catch(Ye){if(!(Ye instanceof dn.Err))throw Ye}!ht&&mt!=="der"&&(ht=w.fromCompact(K))}nt=u.fromHex(N)}catch{return!1}if(!ht||J&&ht.hasHighS())return!1;bt&&(st=t.hash(st));const{r:Mt,s:le}=ht,de=j(st),ie=f(le),he=i(de*ie),Se=i(Mt*ie),ye=(Qe=u.BASE.multiplyAndAddUnsafe(nt,he,Se))==null?void 0:Qe.toAffine();return ye?i(ye.x)===Mt:!1}return{CURVE:t,getPublicKey:F,getSharedSecret:H,sign:Ot,verify:oe,ProjectivePoint:u,Signature:w,utils:T}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function fu(r){return{hash:r,hmac:(t,...e)=>sa(r,t,ja(...e)),randomBytes:li}}function uu(r,t){const e=n=>cu({...r,...fu(n)});return{...e(t),create:e}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const oa=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Wo=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),lu=BigInt(1),Ys=BigInt(2),Vo=(r,t)=>(r+t/Ys)/t;function du(r){const t=oa,e=BigInt(3),n=BigInt(6),s=BigInt(11),o=BigInt(22),i=BigInt(23),f=BigInt(44),u=BigInt(88),g=r*r*r%t,y=g*g*r%t,v=ue(y,e,t)*y%t,S=ue(v,e,t)*y%t,b=ue(S,Ys,t)*g%t,A=ue(b,s,t)*b%t,m=ue(A,o,t)*A%t,w=ue(m,f,t)*m%t,T=ue(w,u,t)*w%t,F=ue(T,f,t)*m%t,R=ue(F,e,t)*y%t,H=ue(R,i,t)*A%t,et=ue(H,n,t)*g%t,j=ue(et,Ys,t);if(!Zs.eql(Zs.sqr(j),r))throw new Error("Cannot find square root");return j}const Zs=us(oa,void 0,void 0,{sqrt:du}),hu=uu({a:BigInt(0),b:BigInt(7),Fp:Zs,n:Wo,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{const t=Wo,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-lu*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=e,i=BigInt("0x100000000000000000000000000000000"),f=Vo(o*r,t),u=Vo(-n*r,t);let g=ee(r-f*e-u*s,t),y=ee(-f*n-u*o,t);const v=g>i,S=y>i;if(v&&(g=t-g),S&&(y=t-y),g>i||y>i)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:v,k1:g,k2neg:S,k2:y}}}},Vs);BigInt(0);lr.utils.randomPrivateKey;const Go=()=>{const r=lr.utils.randomPrivateKey(),t=Js(r),e=new Uint8Array(64);return e.set(r),e.set(t,32),{publicKey:t,secretKey:e}},Js=lr.getPublicKey;function Yo(r){try{return lr.ExtendedPoint.fromHex(r),!0}catch{return!1}}const ia=(r,t)=>lr.sign(r,t.slice(0,32)),gu=lr.verify,cr=r=>Lt.Buffer.isBuffer(r)?r:r instanceof Uint8Array?Lt.Buffer.from(r.buffer,r.byteOffset,r.byteLength):Lt.Buffer.from(r);class pu{constructor(t){Object.assign(this,t)}encode(){return Lt.Buffer.from(Ci(Vr,this))}static decode(t){return Li(Vr,this,t)}static decodeUnchecked(t){return Bi(Vr,this,t)}}const Vr=new Map;var aa;const yu=32,Rn=32;function wu(r){return r._bn!==void 0}let Zo=1;class wt extends pu{constructor(t){if(super({}),this._bn=void 0,wu(t))this._bn=t._bn;else{if(typeof t=="string"){const e=Be.decode(t);if(e.length!=Rn)throw new Error("Invalid public key input");this._bn=new Po(e)}else this._bn=new Po(t);if(this._bn.byteLength()>Rn)throw new Error("Invalid public key input")}}static unique(){const t=new wt(Zo);return Zo+=1,new wt(t.toBuffer())}equals(t){return this._bn.eq(t._bn)}toBase58(){return Be.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const t=this.toBuffer();return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}toBuffer(){const t=this._bn.toArrayLike(Lt.Buffer);if(t.length===Rn)return t;const e=Lt.Buffer.alloc(32);return t.copy(e,32-t.length),e}get[Symbol.toStringTag](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(t,e,n){const s=Lt.Buffer.concat([t.toBuffer(),Lt.Buffer.from(e),n.toBuffer()]),o=Vs(s);return new wt(o)}static createProgramAddressSync(t,e){let n=Lt.Buffer.alloc(0);t.forEach(function(o){if(o.length>yu)throw new TypeError("Max seed length exceeded");n=Lt.Buffer.concat([n,cr(o)])}),n=Lt.Buffer.concat([n,e.toBuffer(),Lt.Buffer.from("ProgramDerivedAddress")]);const s=Vs(n);if(Yo(s))throw new Error("Invalid seeds, address must fall off the curve");return new wt(s)}static async createProgramAddress(t,e){return this.createProgramAddressSync(t,e)}static findProgramAddressSync(t,e){let n=255,s;for(;n!=0;){try{const o=t.concat(Lt.Buffer.from([n]));s=this.createProgramAddressSync(o,e)}catch(o){if(o instanceof TypeError)throw o;n--;continue}return[s,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(t,e){return this.findProgramAddressSync(t,e)}static isOnCurve(t){const e=new wt(t);return Yo(e.toBytes())}}aa=wt;wt.default=new aa("11111111111111111111111111111111");Vr.set(wt,{kind:"struct",fields:[["_bn","u256"]]});new wt("BPFLoader1111111111111111111111111111111111");const rr=1280-40-8,So=127,ns=64;class ca extends Error{constructor(t){super(`Signature ${t} has expired: block height exceeded.`),this.signature=void 0,this.signature=t}}Object.defineProperty(ca.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class fa extends Error{constructor(t,e){super(`Transaction was not confirmed in ${e.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${t} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=t}}Object.defineProperty(fa.prototype,"name",{value:"TransactionExpiredTimeoutError"});class _r extends Error{constructor(t){super(`Signature ${t} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=t}}Object.defineProperty(_r.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class rs{constructor(t,e){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=t,this.accountKeysFromLookups=e}keySegments(){const t=[this.staticAccountKeys];return this.accountKeysFromLookups&&(t.push(this.accountKeysFromLookups.writable),t.push(this.accountKeysFromLookups.readonly)),t}get(t){for(const e of this.keySegments()){if(t<e.length)return e[t];t-=e.length}}get length(){return this.keySegments().flat().length}compileInstructions(t){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const n=new Map;this.keySegments().flat().forEach((o,i)=>{n.set(o.toBase58(),i)});const s=o=>{const i=n.get(o.toBase58());if(i===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return i};return t.map(o=>({programIdIndex:s(o.programId),accountKeyIndexes:o.keys.map(i=>s(i.pubkey)),data:o.data}))}}const qt=(r="publicKey")=>Qt(32,r),bu=(r="signature")=>Qt(64,r),er=(r="string")=>{const t=ft([gt("length"),gt("lengthPadding"),Qt(zn(gt(),-8),"chars")],r),e=t.decode.bind(t),n=t.encode.bind(t),s=t;return s.decode=(o,i)=>e(o,i).chars.toString(),s.encode=(o,i,f)=>{const u={chars:Lt.Buffer.from(o,"utf8")};return n(u,i,f)},s.alloc=o=>gt().span+gt().span+Lt.Buffer.from(o,"utf8").length,s},mu=(r="authorized")=>ft([qt("staker"),qt("withdrawer")],r),xu=(r="lockup")=>ft([Ke("unixTimestamp"),Ke("epoch"),qt("custodian")],r),vu=(r="voteInit")=>ft([qt("nodePubkey"),qt("authorizedVoter"),qt("authorizedWithdrawer"),Vt("commission")],r),Su=(r="voteAuthorizeWithSeedArgs")=>ft([gt("voteAuthorizationType"),qt("currentAuthorityDerivedKeyOwnerPubkey"),er("currentAuthorityDerivedKeySeed"),qt("newAuthorized")],r);function De(r){let t=0,e=0;for(;;){let n=r.shift();if(t|=(n&127)<<e*7,e+=1,!(n&128))break}return t}function He(r,t){let e=t;for(;;){let n=e&127;if(e>>=7,e==0){r.push(n);break}else n|=128,r.push(n)}}function te(r,t){if(!r)throw new Error(t||"Assertion failed")}class ws{constructor(t,e){this.payer=void 0,this.keyMetaMap=void 0,this.payer=t,this.keyMetaMap=e}static compile(t,e){const n=new Map,s=i=>{const f=i.toBase58();let u=n.get(f);return u===void 0&&(u={isSigner:!1,isWritable:!1,isInvoked:!1},n.set(f,u)),u},o=s(e);o.isSigner=!0,o.isWritable=!0;for(const i of t){s(i.programId).isInvoked=!0;for(const f of i.keys){const u=s(f.pubkey);u.isSigner||(u.isSigner=f.isSigner),u.isWritable||(u.isWritable=f.isWritable)}}return new ws(e,n)}getMessageComponents(){const t=[...this.keyMetaMap.entries()];te(t.length<=256,"Max static account keys length exceeded");const e=t.filter(([,u])=>u.isSigner&&u.isWritable),n=t.filter(([,u])=>u.isSigner&&!u.isWritable),s=t.filter(([,u])=>!u.isSigner&&u.isWritable),o=t.filter(([,u])=>!u.isSigner&&!u.isWritable),i={numRequiredSignatures:e.length+n.length,numReadonlySignedAccounts:n.length,numReadonlyUnsignedAccounts:o.length};{te(e.length>0,"Expected at least one writable signer key");const[u]=e[0];te(u===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const f=[...e.map(([u])=>new wt(u)),...n.map(([u])=>new wt(u)),...s.map(([u])=>new wt(u)),...o.map(([u])=>new wt(u))];return[i,f]}extractTableLookup(t){const[e,n]=this.drainKeysFoundInLookupTable(t.state.addresses,i=>!i.isSigner&&!i.isInvoked&&i.isWritable),[s,o]=this.drainKeysFoundInLookupTable(t.state.addresses,i=>!i.isSigner&&!i.isInvoked&&!i.isWritable);if(!(e.length===0&&s.length===0))return[{accountKey:t.key,writableIndexes:e,readonlyIndexes:s},{writable:n,readonly:o}]}drainKeysFoundInLookupTable(t,e){const n=new Array,s=new Array;for(const[o,i]of this.keyMetaMap.entries())if(e(i)){const f=new wt(o),u=t.findIndex(g=>g.equals(f));u>=0&&(te(u<256,"Max lookup table index exceeded"),n.push(u),s.push(f),this.keyMetaMap.delete(o))}return[n,s]}}const ua="Reached end of buffer unexpectedly";function pn(r){if(r.length===0)throw new Error(ua);return r.shift()}function $e(r,...t){const[e]=t;if(t.length===2?e+(t[1]??0)>r.length:e>=r.length)throw new Error(ua);return r.splice(...t)}class wn{constructor(t){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=t.header,this.accountKeys=t.accountKeys.map(e=>new wt(e)),this.recentBlockhash=t.recentBlockhash,this.instructions=t.instructions,this.instructions.forEach(e=>this.indexToProgramIds.set(e.programIdIndex,this.accountKeys[e.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:Be.decode(t.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new rs(this.staticAccountKeys)}static compile(t){const e=ws.compile(t.instructions,t.payerKey),[n,s]=e.getMessageComponents(),i=new rs(s).compileInstructions(t.instructions).map(f=>({programIdIndex:f.programIdIndex,accounts:f.accountKeyIndexes,data:Be.encode(f.data)}));return new wn({header:n,accountKeys:s,recentBlockhash:t.recentBlockhash,instructions:i})}isAccountSigner(t){return t<this.header.numRequiredSignatures}isAccountWritable(t){const e=this.header.numRequiredSignatures;if(t>=this.header.numRequiredSignatures){const n=t-e,o=this.accountKeys.length-e-this.header.numReadonlyUnsignedAccounts;return n<o}else{const n=e-this.header.numReadonlySignedAccounts;return t<n}}isProgramId(t){return this.indexToProgramIds.has(t)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((t,e)=>!this.isProgramId(e))}serialize(){const t=this.accountKeys.length;let e=[];He(e,t);const n=this.instructions.map(v=>{const{accounts:S,programIdIndex:b}=v,A=Array.from(Be.decode(v.data));let m=[];He(m,S.length);let w=[];return He(w,A.length),{programIdIndex:b,keyIndicesCount:Lt.Buffer.from(m),keyIndices:S,dataLength:Lt.Buffer.from(w),data:A}});let s=[];He(s,n.length);let o=Lt.Buffer.alloc(rr);Lt.Buffer.from(s).copy(o);let i=s.length;n.forEach(v=>{const b=ft([Vt("programIdIndex"),Qt(v.keyIndicesCount.length,"keyIndicesCount"),Pe(Vt("keyIndex"),v.keyIndices.length,"keyIndices"),Qt(v.dataLength.length,"dataLength"),Pe(Vt("userdatum"),v.data.length,"data")]).encode(v,o,i);i+=b}),o=o.slice(0,i);const f=ft([Qt(1,"numRequiredSignatures"),Qt(1,"numReadonlySignedAccounts"),Qt(1,"numReadonlyUnsignedAccounts"),Qt(e.length,"keyCount"),Pe(qt("key"),t,"keys"),qt("recentBlockhash")]),u={numRequiredSignatures:Lt.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:Lt.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:Lt.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:Lt.Buffer.from(e),keys:this.accountKeys.map(v=>cr(v.toBytes())),recentBlockhash:Be.decode(this.recentBlockhash)};let g=Lt.Buffer.alloc(2048);const y=f.encode(u,g);return o.copy(g,y),g.slice(0,y+o.length)}static from(t){let e=[...t];const n=pn(e);if(n!==(n&So))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const s=pn(e),o=pn(e),i=De(e);let f=[];for(let S=0;S<i;S++){const b=$e(e,0,Rn);f.push(new wt(Lt.Buffer.from(b)))}const u=$e(e,0,Rn),g=De(e);let y=[];for(let S=0;S<g;S++){const b=pn(e),A=De(e),m=$e(e,0,A),w=De(e),T=$e(e,0,w),F=Be.encode(Lt.Buffer.from(T));y.push({programIdIndex:b,accounts:m,data:F})}const v={header:{numRequiredSignatures:n,numReadonlySignedAccounts:s,numReadonlyUnsignedAccounts:o},recentBlockhash:Be.encode(Lt.Buffer.from(u)),accountKeys:f,instructions:y};return new wn(v)}}class Rr{constructor(t){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=t.header,this.staticAccountKeys=t.staticAccountKeys,this.recentBlockhash=t.recentBlockhash,this.compiledInstructions=t.compiledInstructions,this.addressTableLookups=t.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let t=0;for(const e of this.addressTableLookups)t+=e.readonlyIndexes.length+e.writableIndexes.length;return t}getAccountKeys(t){let e;if(t&&"accountKeysFromLookups"in t&&t.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=t.accountKeysFromLookups.writable.length+t.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");e=t.accountKeysFromLookups}else if(t&&"addressLookupTableAccounts"in t&&t.addressLookupTableAccounts)e=this.resolveAddressTableLookups(t.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new rs(this.staticAccountKeys,e)}isAccountSigner(t){return t<this.header.numRequiredSignatures}isAccountWritable(t){const e=this.header.numRequiredSignatures,n=this.staticAccountKeys.length;if(t>=n){const s=t-n,o=this.addressTableLookups.reduce((i,f)=>i+f.writableIndexes.length,0);return s<o}else if(t>=this.header.numRequiredSignatures){const s=t-e,i=n-e-this.header.numReadonlyUnsignedAccounts;return s<i}else{const s=e-this.header.numReadonlySignedAccounts;return t<s}}resolveAddressTableLookups(t){const e={writable:[],readonly:[]};for(const n of this.addressTableLookups){const s=t.find(o=>o.key.equals(n.accountKey));if(!s)throw new Error(`Failed to find address lookup table account for table key ${n.accountKey.toBase58()}`);for(const o of n.writableIndexes)if(o<s.state.addresses.length)e.writable.push(s.state.addresses[o]);else throw new Error(`Failed to find address for index ${o} in address lookup table ${n.accountKey.toBase58()}`);for(const o of n.readonlyIndexes)if(o<s.state.addresses.length)e.readonly.push(s.state.addresses[o]);else throw new Error(`Failed to find address for index ${o} in address lookup table ${n.accountKey.toBase58()}`)}return e}static compile(t){const e=ws.compile(t.instructions,t.payerKey),n=new Array,s={writable:new Array,readonly:new Array},o=t.addressLookupTableAccounts||[];for(const y of o){const v=e.extractTableLookup(y);if(v!==void 0){const[S,{writable:b,readonly:A}]=v;n.push(S),s.writable.push(...b),s.readonly.push(...A)}}const[i,f]=e.getMessageComponents(),g=new rs(f,s).compileInstructions(t.instructions);return new Rr({header:i,staticAccountKeys:f,recentBlockhash:t.recentBlockhash,compiledInstructions:g,addressTableLookups:n})}serialize(){const t=Array();He(t,this.staticAccountKeys.length);const e=this.serializeInstructions(),n=Array();He(n,this.compiledInstructions.length);const s=this.serializeAddressTableLookups(),o=Array();He(o,this.addressTableLookups.length);const i=ft([Vt("prefix"),ft([Vt("numRequiredSignatures"),Vt("numReadonlySignedAccounts"),Vt("numReadonlyUnsignedAccounts")],"header"),Qt(t.length,"staticAccountKeysLength"),Pe(qt(),this.staticAccountKeys.length,"staticAccountKeys"),qt("recentBlockhash"),Qt(n.length,"instructionsLength"),Qt(e.length,"serializedInstructions"),Qt(o.length,"addressTableLookupsLength"),Qt(s.length,"serializedAddressTableLookups")]),f=new Uint8Array(rr),u=128,g=i.encode({prefix:u,header:this.header,staticAccountKeysLength:new Uint8Array(t),staticAccountKeys:this.staticAccountKeys.map(y=>y.toBytes()),recentBlockhash:Be.decode(this.recentBlockhash),instructionsLength:new Uint8Array(n),serializedInstructions:e,addressTableLookupsLength:new Uint8Array(o),serializedAddressTableLookups:s},f);return f.slice(0,g)}serializeInstructions(){let t=0;const e=new Uint8Array(rr);for(const n of this.compiledInstructions){const s=Array();He(s,n.accountKeyIndexes.length);const o=Array();He(o,n.data.length);const i=ft([Vt("programIdIndex"),Qt(s.length,"encodedAccountKeyIndexesLength"),Pe(Vt(),n.accountKeyIndexes.length,"accountKeyIndexes"),Qt(o.length,"encodedDataLength"),Qt(n.data.length,"data")]);t+=i.encode({programIdIndex:n.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(s),accountKeyIndexes:n.accountKeyIndexes,encodedDataLength:new Uint8Array(o),data:n.data},e,t)}return e.slice(0,t)}serializeAddressTableLookups(){let t=0;const e=new Uint8Array(rr);for(const n of this.addressTableLookups){const s=Array();He(s,n.writableIndexes.length);const o=Array();He(o,n.readonlyIndexes.length);const i=ft([qt("accountKey"),Qt(s.length,"encodedWritableIndexesLength"),Pe(Vt(),n.writableIndexes.length,"writableIndexes"),Qt(o.length,"encodedReadonlyIndexesLength"),Pe(Vt(),n.readonlyIndexes.length,"readonlyIndexes")]);t+=i.encode({accountKey:n.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(s),writableIndexes:n.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(o),readonlyIndexes:n.readonlyIndexes},e,t)}return e.slice(0,t)}static deserialize(t){let e=[...t];const n=pn(e),s=n&So;te(n!==s,"Expected versioned message but received legacy message");const o=s;te(o===0,`Expected versioned message with version 0 but found version ${o}`);const i={numRequiredSignatures:pn(e),numReadonlySignedAccounts:pn(e),numReadonlyUnsignedAccounts:pn(e)},f=[],u=De(e);for(let A=0;A<u;A++)f.push(new wt($e(e,0,Rn)));const g=Be.encode($e(e,0,Rn)),y=De(e),v=[];for(let A=0;A<y;A++){const m=pn(e),w=De(e),T=$e(e,0,w),F=De(e),R=new Uint8Array($e(e,0,F));v.push({programIdIndex:m,accountKeyIndexes:T,data:R})}const S=De(e),b=[];for(let A=0;A<S;A++){const m=new wt($e(e,0,Rn)),w=De(e),T=$e(e,0,w),F=De(e),R=$e(e,0,F);b.push({accountKey:m,writableIndexes:T,readonlyIndexes:R})}return new Rr({header:i,staticAccountKeys:f,recentBlockhash:g,compiledInstructions:v,addressTableLookups:b})}}const la={deserializeMessageVersion(r){const t=r[0],e=t&So;return e===t?"legacy":e},deserialize:r=>{const t=la.deserializeMessageVersion(r);if(t==="legacy")return wn.from(r);if(t===0)return Rr.deserialize(r);throw new Error(`Transaction message version ${t} deserialization is not supported`)}};let En=function(r){return r[r.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",r[r.PROCESSED=1]="PROCESSED",r[r.TIMED_OUT=2]="TIMED_OUT",r[r.NONCE_INVALID=3]="NONCE_INVALID",r}({});const Eu=Lt.Buffer.alloc(ns).fill(0);class Jo{constructor(t){this.keys=void 0,this.programId=void 0,this.data=Lt.Buffer.alloc(0),this.programId=t.programId,this.keys=t.keys,t.data&&(this.data=t.data)}toJSON(){return{keys:this.keys.map(({pubkey:t,isSigner:e,isWritable:n})=>({pubkey:t.toJSON(),isSigner:e,isWritable:n})),programId:this.programId.toJSON(),data:[...this.data]}}}class _n{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(t){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!t)if(t.feePayer&&(this.feePayer=t.feePayer),t.signatures&&(this.signatures=t.signatures),Object.prototype.hasOwnProperty.call(t,"nonceInfo")){const{minContextSlot:e,nonceInfo:n}=t;this.minNonceContextSlot=e,this.nonceInfo=n}else if(Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")){const{blockhash:e,lastValidBlockHeight:n}=t;this.recentBlockhash=e,this.lastValidBlockHeight=n}else{const{recentBlockhash:e,nonceInfo:n}=t;n&&(this.nonceInfo=n),this.recentBlockhash=e}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(t=>t.toJSON()),signers:this.signatures.map(({publicKey:t})=>t.toJSON())}}add(...t){if(t.length===0)throw new Error("No instructions");return t.forEach(e=>{"instructions"in e?this.instructions=this.instructions.concat(e.instructions):"data"in e&&"programId"in e&&"keys"in e?this.instructions.push(e):this.instructions.push(new Jo(e))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let t,e;if(this.nonceInfo?(t=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?e=[this.nonceInfo.nonceInstruction,...this.instructions]:e=this.instructions):(t=this.recentBlockhash,e=this.instructions),!t)throw new Error("Transaction recentBlockhash required");e.length<1&&console.warn("No instructions provided");let n;if(this.feePayer)n=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)n=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let m=0;m<e.length;m++)if(e[m].programId===void 0)throw new Error(`Transaction instruction index ${m} has undefined program id`);const s=[],o=[];e.forEach(m=>{m.keys.forEach(T=>{o.push({...T})});const w=m.programId.toString();s.includes(w)||s.push(w)}),s.forEach(m=>{o.push({pubkey:new wt(m),isSigner:!1,isWritable:!1})});const i=[];o.forEach(m=>{const w=m.pubkey.toString(),T=i.findIndex(F=>F.pubkey.toString()===w);T>-1?(i[T].isWritable=i[T].isWritable||m.isWritable,i[T].isSigner=i[T].isSigner||m.isSigner):i.push(m)}),i.sort(function(m,w){if(m.isSigner!==w.isSigner)return m.isSigner?-1:1;if(m.isWritable!==w.isWritable)return m.isWritable?-1:1;const T={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return m.pubkey.toBase58().localeCompare(w.pubkey.toBase58(),"en",T)});const f=i.findIndex(m=>m.pubkey.equals(n));if(f>-1){const[m]=i.splice(f,1);m.isSigner=!0,m.isWritable=!0,i.unshift(m)}else i.unshift({pubkey:n,isSigner:!0,isWritable:!0});for(const m of this.signatures){const w=i.findIndex(T=>T.pubkey.equals(m.publicKey));if(w>-1)i[w].isSigner||(i[w].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${m.publicKey.toString()}`)}let u=0,g=0,y=0;const v=[],S=[];i.forEach(({pubkey:m,isSigner:w,isWritable:T})=>{w?(v.push(m.toString()),u+=1,T||(g+=1)):(S.push(m.toString()),T||(y+=1))});const b=v.concat(S),A=e.map(m=>{const{data:w,programId:T}=m;return{programIdIndex:b.indexOf(T.toString()),accounts:m.keys.map(F=>b.indexOf(F.pubkey.toString())),data:Be.encode(w)}});return A.forEach(m=>{te(m.programIdIndex>=0),m.accounts.forEach(w=>te(w>=0))}),new wn({header:{numRequiredSignatures:u,numReadonlySignedAccounts:g,numReadonlyUnsignedAccounts:y},accountKeys:b,recentBlockhash:t,instructions:A})}_compile(){const t=this.compileMessage(),e=t.accountKeys.slice(0,t.header.numRequiredSignatures);return this.signatures.length===e.length&&this.signatures.every((s,o)=>e[o].equals(s.publicKey))||(this.signatures=e.map(n=>({signature:null,publicKey:n}))),t}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(t){return(await t.getFeeForMessage(this.compileMessage())).value}setSigners(...t){if(t.length===0)throw new Error("No signers");const e=new Set;this.signatures=t.filter(n=>{const s=n.toString();return e.has(s)?!1:(e.add(s),!0)}).map(n=>({signature:null,publicKey:n}))}sign(...t){if(t.length===0)throw new Error("No signers");const e=new Set,n=[];for(const o of t){const i=o.publicKey.toString();e.has(i)||(e.add(i),n.push(o))}this.signatures=n.map(o=>({signature:null,publicKey:o.publicKey}));const s=this._compile();this._partialSign(s,...n)}partialSign(...t){if(t.length===0)throw new Error("No signers");const e=new Set,n=[];for(const o of t){const i=o.publicKey.toString();e.has(i)||(e.add(i),n.push(o))}const s=this._compile();this._partialSign(s,...n)}_partialSign(t,...e){const n=t.serialize();e.forEach(s=>{const o=ia(n,s.secretKey);this._addSignature(s.publicKey,cr(o))})}addSignature(t,e){this._compile(),this._addSignature(t,e)}_addSignature(t,e){te(e.length===64);const n=this.signatures.findIndex(s=>t.equals(s.publicKey));if(n<0)throw new Error(`unknown signer: ${t.toString()}`);this.signatures[n].signature=Lt.Buffer.from(e)}verifySignatures(t=!0){return!this._getMessageSignednessErrors(this.serializeMessage(),t)}_getMessageSignednessErrors(t,e){const n={};for(const{signature:s,publicKey:o}of this.signatures)s===null?e&&(n.missing||(n.missing=[])).push(o):gu(s,t,o.toBytes())||(n.invalid||(n.invalid=[])).push(o);return n.invalid||n.missing?n:void 0}serialize(t){const{requireAllSignatures:e,verifySignatures:n}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},t),s=this.serializeMessage();if(n){const o=this._getMessageSignednessErrors(s,e);if(o){let i="Signature verification failed.";throw o.invalid&&(i+=`
Invalid signature for public key${o.invalid.length===1?"":"(s)"} [\`${o.invalid.map(f=>f.toBase58()).join("`, `")}\`].`),o.missing&&(i+=`
Missing signature for public key${o.missing.length===1?"":"(s)"} [\`${o.missing.map(f=>f.toBase58()).join("`, `")}\`].`),new Error(i)}}return this._serialize(s)}_serialize(t){const{signatures:e}=this,n=[];He(n,e.length);const s=n.length+e.length*64+t.length,o=Lt.Buffer.alloc(s);return te(e.length<256),Lt.Buffer.from(n).copy(o,0),e.forEach(({signature:i},f)=>{i!==null&&(te(i.length===64,"signature has invalid length"),Lt.Buffer.from(i).copy(o,n.length+f*64))}),t.copy(o,n.length+e.length*64),te(o.length<=rr,`Transaction too large: ${o.length} > ${rr}`),o}get keys(){return te(this.instructions.length===1),this.instructions[0].keys.map(t=>t.pubkey)}get programId(){return te(this.instructions.length===1),this.instructions[0].programId}get data(){return te(this.instructions.length===1),this.instructions[0].data}static from(t){let e=[...t];const n=De(e);let s=[];for(let o=0;o<n;o++){const i=$e(e,0,ns);s.push(Be.encode(Lt.Buffer.from(i)))}return _n.populate(wn.from(e),s)}static populate(t,e=[]){const n=new _n;return n.recentBlockhash=t.recentBlockhash,t.header.numRequiredSignatures>0&&(n.feePayer=t.accountKeys[0]),e.forEach((s,o)=>{const i={signature:s==Be.encode(Eu)?null:Be.decode(s),publicKey:t.accountKeys[o]};n.signatures.push(i)}),t.instructions.forEach(s=>{const o=s.accounts.map(i=>{const f=t.accountKeys[i];return{pubkey:f,isSigner:n.signatures.some(u=>u.publicKey.toString()===f.toString())||t.isAccountSigner(i),isWritable:t.isAccountWritable(i)}});n.instructions.push(new Jo({keys:o,programId:t.accountKeys[s.programIdIndex],data:Be.decode(s.data)}))}),n._message=t,n._json=n.toJSON(),n}}class sr{get version(){return this.message.version}constructor(t,e){if(this.signatures=void 0,this.message=void 0,e!==void 0)te(e.length===t.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=e;else{const n=[];for(let s=0;s<t.header.numRequiredSignatures;s++)n.push(new Uint8Array(ns));this.signatures=n}this.message=t}serialize(){const t=this.message.serialize(),e=Array();He(e,this.signatures.length);const n=ft([Qt(e.length,"encodedSignaturesLength"),Pe(bu(),this.signatures.length,"signatures"),Qt(t.length,"serializedMessage")]),s=new Uint8Array(2048),o=n.encode({encodedSignaturesLength:new Uint8Array(e),signatures:this.signatures,serializedMessage:t},s);return s.slice(0,o)}static deserialize(t){let e=[...t];const n=[],s=De(e);for(let i=0;i<s;i++)n.push(new Uint8Array($e(e,0,ns)));const o=la.deserialize(new Uint8Array(e));return new sr(o,n)}sign(t){const e=this.message.serialize(),n=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const s of t){const o=n.findIndex(i=>i.equals(s.publicKey));te(o>=0,`Cannot sign with non signer key ${s.publicKey.toBase58()}`),this.signatures[o]=ia(e,s.secretKey)}}addSignature(t,e){te(e.byteLength===64,"Signature must be 64 bytes long");const s=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(o=>o.equals(t));te(s>=0,`Can not add signature; \`${t.toBase58()}\` is not required to sign this transaction`),this.signatures[s]=e}}const _u=160,Au=64,Bu=_u/Au,ku=1e3/Bu;new wt("SysvarC1ock11111111111111111111111111111111");new wt("SysvarEpochSchedu1e111111111111111111111111");new wt("Sysvar1nstructions1111111111111111111111111");new wt("SysvarRecentB1ockHashes11111111111111111111");new wt("SysvarRent111111111111111111111111111111111");new wt("SysvarRewards111111111111111111111111111111");new wt("SysvarS1otHashes111111111111111111111111111");new wt("SysvarS1otHistory11111111111111111111111111");new wt("SysvarStakeHistory1111111111111111111111111");class Xo extends Error{constructor({action:t,signature:e,transactionMessage:n,logs:s}){const o=s?`Logs: 
${JSON.stringify(s.slice(-10),null,2)}. `:"",i="\nCatch the `SendTransactionError` and call `getLogs()` on it for full details.";let f;switch(t){case"send":f=`Transaction ${e} resulted in an error. 
${n}. `+o+i;break;case"simulate":f=`Simulation failed. 
Message: ${n}. 
`+o+i;break;default:f=`Unknown action '${(u=>u)(t)}'`}super(f),this.signature=void 0,this.transactionMessage=void 0,this.transactionLogs=void 0,this.signature=e,this.transactionMessage=n,this.transactionLogs=s||void 0}get transactionError(){return{message:this.transactionMessage,logs:Array.isArray(this.transactionLogs)?this.transactionLogs:void 0}}get logs(){const t=this.transactionLogs;if(!(t!=null&&typeof t=="object"&&"then"in t))return t}async getLogs(t){return Array.isArray(this.transactionLogs)||(this.transactionLogs=new Promise((e,n)=>{t.getTransaction(this.signature).then(s=>{if(s&&s.meta&&s.meta.logMessages){const o=s.meta.logMessages;this.transactionLogs=o,e(o)}else n(new Error("Log messages not found"))}).catch(n)})),await this.transactionLogs}}class lt extends Error{constructor({code:t,message:e,data:n},s){super(s!=null?`${s}: ${e}`:e),this.code=void 0,this.data=void 0,this.code=t,this.data=n,this.name="SolanaJSONRPCError"}}function Qn(r){return new Promise(t=>setTimeout(t,r))}const Iu=_e("lamportsPerSignature"),da=ft([gt("version"),gt("state"),qt("authorizedPubkey"),qt("nonce"),ft([Iu],"feeCalculator")]);da.span;class Eo{constructor(t){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=t.authorizedPubkey,this.nonce=t.nonce,this.feeCalculator=t.feeCalculator}static fromAccountData(t){const e=da.decode(cr(t),0);return new Eo({authorizedPubkey:new wt(e.authorizedPubkey),nonce:new wt(e.nonce).toString(),feeCalculator:e.feeCalculator})}}const Ru=r=>{const t=r.decode.bind(r),e=r.encode.bind(r);return{decode:t,encode:e}},Tu=r=>t=>{const e=Qt(r,t),{encode:n,decode:s}=Ru(e),o=e;return o.decode=(i,f)=>{const u=s(i,f);return lf(Lt.Buffer.from(u))},o.encode=(i,f,u)=>{const g=gf(i,r);return n(g,f,u)},o},fr=Tu(8);Object.freeze({Create:{index:0,layout:ft([gt("instruction"),Ke("lamports"),Ke("space"),qt("programId")])},Assign:{index:1,layout:ft([gt("instruction"),qt("programId")])},Transfer:{index:2,layout:ft([gt("instruction"),fr("lamports")])},CreateWithSeed:{index:3,layout:ft([gt("instruction"),qt("base"),er("seed"),Ke("lamports"),Ke("space"),qt("programId")])},AdvanceNonceAccount:{index:4,layout:ft([gt("instruction")])},WithdrawNonceAccount:{index:5,layout:ft([gt("instruction"),Ke("lamports")])},InitializeNonceAccount:{index:6,layout:ft([gt("instruction"),qt("authorized")])},AuthorizeNonceAccount:{index:7,layout:ft([gt("instruction"),qt("authorized")])},Allocate:{index:8,layout:ft([gt("instruction"),Ke("space")])},AllocateWithSeed:{index:9,layout:ft([gt("instruction"),qt("base"),er("seed"),Ke("space"),qt("programId")])},AssignWithSeed:{index:10,layout:ft([gt("instruction"),qt("base"),er("seed"),qt("programId")])},TransferWithSeed:{index:11,layout:ft([gt("instruction"),fr("lamports"),er("seed"),qt("programId")])},UpgradeNonceAccount:{index:12,layout:ft([gt("instruction")])}});new wt("11111111111111111111111111111111");new wt("BPFLoader2111111111111111111111111111111111");function Cu(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var qs,Qo;function Lu(){if(Qo)return qs;Qo=1;var r=Object.prototype.toString,t=Object.keys||function(n){var s=[];for(var o in n)s.push(o);return s};function e(n,s){var o,i,f,u,g,y,v;if(n===!0)return"true";if(n===!1)return"false";switch(typeof n){case"object":if(n===null)return null;if(n.toJSON&&typeof n.toJSON=="function")return e(n.toJSON(),s);if(v=r.call(n),v==="[object Array]"){for(f="[",i=n.length-1,o=0;o<i;o++)f+=e(n[o],!0)+",";return i>-1&&(f+=e(n[o],!0)),f+"]"}else if(v==="[object Object]"){for(u=t(n).sort(),i=u.length,f="",o=0;o<i;)g=u[o],y=e(n[g],!1),y!==void 0&&(f&&(f+=","),f+=JSON.stringify(g)+":"+y),o++;return"{"+f+"}"}else return JSON.stringify(n);case"function":case"undefined":return s?null:void 0;case"string":return JSON.stringify(n);default:return isFinite(n)?n:null}}return qs=function(n){var s=e(n,!1);if(s!==void 0)return""+s},qs}var Uu=Lu(),ti=Cu(Uu);const Er=32;function Ks(r){let t=0;for(;r>1;)r/=2,t++;return t}function Pu(r){return r===0?1:(r--,r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16,r|=r>>32,r+1)}class Nu{constructor(t,e,n,s,o){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=t,this.leaderScheduleSlotOffset=e,this.warmup=n,this.firstNormalEpoch=s,this.firstNormalSlot=o}getEpoch(t){return this.getEpochAndSlotIndex(t)[0]}getEpochAndSlotIndex(t){if(t<this.firstNormalSlot){const e=Ks(Pu(t+Er+1))-Ks(Er)-1,n=this.getSlotsInEpoch(e),s=t-(n-Er);return[e,s]}else{const e=t-this.firstNormalSlot,n=Math.floor(e/this.slotsPerEpoch),s=this.firstNormalEpoch+n,o=e%this.slotsPerEpoch;return[s,o]}}getFirstSlotInEpoch(t){return t<=this.firstNormalEpoch?(Math.pow(2,t)-1)*Er:(t-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(t){return this.getFirstSlotInEpoch(t)+this.getSlotsInEpoch(t)-1}getSlotsInEpoch(t){return t<this.firstNormalEpoch?Math.pow(2,t+Ks(Er)):this.slotsPerEpoch}}var Ou=globalThis.fetch;class Mu extends eu{constructor(t,e,n){const s=o=>{const i=Qf(o,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...e});return"socket"in i?this.underlyingSocket=i.socket:this.underlyingSocket=i,i};super(s,t,e,n),this.underlyingSocket=void 0}call(...t){var n;const e=(n=this.underlyingSocket)==null?void 0:n.readyState;return e===1?super.call(...t):Promise.reject(new Error("Tried to call a JSON-RPC method `"+t[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+e+")"))}notify(...t){var n;const e=(n=this.underlyingSocket)==null?void 0:n.readyState;return e===1?super.notify(...t):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+t[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+e+")"))}}function Fu(r,t){let e;try{e=r.layout.decode(t)}catch(n){throw new Error("invalid instruction; "+n)}if(e.typeIndex!==r.index)throw new Error(`invalid account data; account type mismatch ${e.typeIndex} != ${r.index}`);return e}const ei=56;class ni{constructor(t){this.key=void 0,this.state=void 0,this.key=t.key,this.state=t.state}isActive(){const t=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===t}static deserialize(t){const e=Fu(zu,t),n=t.length-ei;te(n>=0,"lookup table is invalid"),te(n%32===0,"lookup table is invalid");const s=n/32,{addresses:o}=ft([Pe(qt(),s,"addresses")]).decode(t.slice(ei));return{deactivationSlot:e.deactivationSlot,lastExtendedSlot:e.lastExtendedSlot,lastExtendedSlotStartIndex:e.lastExtendedStartIndex,authority:e.authority.length!==0?new wt(e.authority[0]):void 0,addresses:o.map(i=>new wt(i))}}}const zu={index:1,layout:ft([gt("typeIndex"),fr("deactivationSlot"),_e("lastExtendedSlot"),Vt("lastExtendedStartIndex"),Vt(),Pe(qt(),zn(Vt(),-1),"authority")])},qu=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function Ku(r){const t=r.match(qu);if(t==null)throw TypeError(`Failed to validate endpoint URL \`${r}\``);const[e,n,s,o]=t,i=r.startsWith("https:")?"wss:":"ws:",f=s==null?null:parseInt(s.slice(1),10),u=f==null?"":`:${f+1}`;return`${i}//${n}${u}${o}`}const se=Or(xo(wt),D(),r=>new wt(r)),ha=vo([D(),ne("base64")]),_o=Or(xo(Lt.Buffer),ha,r=>Lt.Buffer.from(r[0],"base64")),Du=30*1e3;function Hu(r){if(/^https?:/.test(r)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return r}function Jt(r){let t,e;if(typeof r=="string")t=r;else if(r){const{commitment:n,...s}=r;t=n,e=s}return{commitment:t,config:e}}function ri(r){return r.map(t=>"memcmp"in t?{...t,memcmp:{...t.memcmp,encoding:t.memcmp.encoding??"base58"}}:t)}function ga(r){return Oe([M({jsonrpc:ne("2.0"),id:D(),result:r}),M({jsonrpc:ne("2.0"),id:D(),error:M({code:gr(),message:D(),data:yt(Sf())})})])}const $u=ga(gr());function Nt(r){return Or(ga(r),$u,t=>"error"in t?t:{...t,result:$(t.result,r)})}function pe(r){return Nt(M({context:M({slot:_()}),value:r}))}function bs(r){return M({context:M({slot:_()}),value:r})}function Ds(r,t){return r===0?new Rr({header:t.header,staticAccountKeys:t.accountKeys.map(e=>new wt(e)),recentBlockhash:t.recentBlockhash,compiledInstructions:t.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:Be.decode(e.data)})),addressTableLookups:t.addressTableLookups}):new wn(t)}const ju=M({foundation:_(),foundationTerm:_(),initial:_(),taper:_(),terminal:_()}),Wu=Nt(W(V(M({epoch:_(),effectiveSlot:_(),amount:_(),postBalance:_(),commission:yt(V(_()))})))),Vu=W(M({slot:_(),prioritizationFee:_()})),Gu=M({total:_(),validator:_(),foundation:_(),epoch:_()}),Yu=M({epoch:_(),slotIndex:_(),slotsInEpoch:_(),absoluteSlot:_(),blockHeight:yt(_()),transactionCount:yt(_())}),Zu=M({slotsPerEpoch:_(),leaderScheduleSlotOffset:_(),warmup:sn(),firstNormalEpoch:_(),firstNormalSlot:_()}),Ju=Ji(D(),W(_())),jn=V(Oe([M({}),D()])),Xu=M({err:jn}),Qu=ne("receivedSignature"),tl=M({"solana-core":D(),"feature-set":yt(_())}),el=M({program:D(),programId:se,parsed:gr()}),nl=M({programId:se,accounts:W(se),data:D()}),si=pe(M({err:V(Oe([M({}),D()])),logs:V(W(D())),accounts:yt(V(W(V(M({executable:sn(),owner:D(),lamports:_(),data:W(D()),rentEpoch:yt(_())}))))),unitsConsumed:yt(_()),returnData:yt(V(M({programId:D(),data:vo([D(),ne("base64")])}))),innerInstructions:yt(V(W(M({index:_(),instructions:W(Oe([el,nl]))}))))})),rl=pe(M({byIdentity:Ji(D(),W(_())),range:M({firstSlot:_(),lastSlot:_()})}));function sl(r,t,e,n,s,o){const i=e||Ou;let f;o!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let u;return n&&(u=async(y,v)=>{const S=await new Promise((b,A)=>{try{n(y,v,(m,w)=>b([m,w]))}catch(m){A(m)}});return await i(...S)}),new Jf(async(y,v)=>{const S={method:"POST",body:y,agent:f,headers:Object.assign({"Content-Type":"application/json"},t||{},sd)};try{let b=5,A,m=500;for(;u?A=await u(r,S):A=await i(r,S),!(A.status!==429||s===!0||(b-=1,b===0));)console.error(`Server responded with ${A.status} ${A.statusText}.  Retrying after ${m}ms delay...`),await Qn(m),m*=2;const w=await A.text();A.ok?v(null,w):v(new Error(`${A.status} ${A.statusText}: ${w}`))}catch(b){b instanceof Error&&v(b)}},{})}function ol(r){return(t,e)=>new Promise((n,s)=>{r.request(t,e,(o,i)=>{if(o){s(o);return}n(i)})})}function il(r){return t=>new Promise((e,n)=>{t.length===0&&e([]);const s=t.map(o=>r.request(o.methodName,o.args));r.request(s,(o,i)=>{if(o){n(o);return}e(i)})})}const al=Nt(ju),cl=Nt(Gu),fl=Nt(Vu),ul=Nt(Yu),ll=Nt(Zu),dl=Nt(Ju),hl=Nt(_()),gl=pe(M({total:_(),circulating:_(),nonCirculating:_(),nonCirculatingAccounts:W(se)})),Xs=M({amount:D(),uiAmount:V(_()),decimals:_(),uiAmountString:yt(D())}),pl=pe(W(M({address:se,amount:D(),uiAmount:V(_()),decimals:_(),uiAmountString:yt(D())}))),yl=pe(W(M({pubkey:se,account:M({executable:sn(),owner:se,lamports:_(),data:_o,rentEpoch:_()})}))),Qs=M({program:D(),parsed:gr(),space:_()}),wl=pe(W(M({pubkey:se,account:M({executable:sn(),owner:se,lamports:_(),data:Qs,rentEpoch:_()})}))),bl=pe(W(M({lamports:_(),address:se}))),Tr=M({executable:sn(),owner:se,lamports:_(),data:_o,rentEpoch:_()}),ml=M({pubkey:se,account:Tr}),xl=Or(Oe([xo(Lt.Buffer),Qs]),Oe([ha,Qs]),r=>Array.isArray(r)?$(r,_o):r),to=M({executable:sn(),owner:se,lamports:_(),data:xl,rentEpoch:_()}),vl=M({pubkey:se,account:to}),Sl=M({state:Oe([ne("active"),ne("inactive"),ne("activating"),ne("deactivating")]),active:_(),inactive:_()}),El=Nt(W(M({signature:D(),slot:_(),err:jn,memo:V(D()),blockTime:yt(V(_()))}))),_l=Nt(W(M({signature:D(),slot:_(),err:jn,memo:V(D()),blockTime:yt(V(_()))}))),Al=M({subscription:_(),result:bs(Tr)}),Bl=M({pubkey:se,account:Tr}),kl=M({subscription:_(),result:bs(Bl)}),Il=M({parent:_(),slot:_(),root:_()}),Rl=M({subscription:_(),result:Il}),Tl=Oe([M({type:Oe([ne("firstShredReceived"),ne("completed"),ne("optimisticConfirmation"),ne("root")]),slot:_(),timestamp:_()}),M({type:ne("createdBank"),parent:_(),slot:_(),timestamp:_()}),M({type:ne("frozen"),slot:_(),timestamp:_(),stats:M({numTransactionEntries:_(),numSuccessfulTransactions:_(),numFailedTransactions:_(),maxTransactionsPerEntry:_()})}),M({type:ne("dead"),slot:_(),timestamp:_(),err:D()})]),Cl=M({subscription:_(),result:Tl}),Ll=M({subscription:_(),result:bs(Oe([Xu,Qu]))}),Ul=M({subscription:_(),result:_()}),Pl=M({pubkey:D(),gossip:V(D()),tpu:V(D()),rpc:V(D()),version:V(D())}),oi=M({votePubkey:D(),nodePubkey:D(),activatedStake:_(),epochVoteAccount:sn(),epochCredits:W(vo([_(),_(),_()])),commission:_(),lastVote:_(),rootSlot:V(_())}),Nl=Nt(M({current:W(oi),delinquent:W(oi)})),Ol=Oe([ne("processed"),ne("confirmed"),ne("finalized")]),Ml=M({slot:_(),confirmations:V(_()),err:jn,confirmationStatus:yt(Ol)}),Fl=pe(W(V(Ml))),zl=Nt(_()),pa=M({accountKey:se,writableIndexes:W(_()),readonlyIndexes:W(_())}),Ao=M({signatures:W(D()),message:M({accountKeys:W(D()),header:M({numRequiredSignatures:_(),numReadonlySignedAccounts:_(),numReadonlyUnsignedAccounts:_()}),instructions:W(M({accounts:W(_()),data:D(),programIdIndex:_()})),recentBlockhash:D(),addressTableLookups:yt(W(pa))})}),ya=M({pubkey:se,signer:sn(),writable:sn(),source:yt(Oe([ne("transaction"),ne("lookupTable")]))}),wa=M({accountKeys:W(ya),signatures:W(D())}),ba=M({parsed:gr(),program:D(),programId:se}),ma=M({accounts:W(se),data:D(),programId:se}),ql=Oe([ma,ba]),Kl=Oe([M({parsed:gr(),program:D(),programId:D()}),M({accounts:W(D()),data:D(),programId:D()})]),xa=Or(ql,Kl,r=>"accounts"in r?$(r,ma):$(r,ba)),va=M({signatures:W(D()),message:M({accountKeys:W(ya),instructions:W(xa),recentBlockhash:D(),addressTableLookups:yt(V(W(pa)))})}),ss=M({accountIndex:_(),mint:D(),owner:yt(D()),programId:yt(D()),uiTokenAmount:Xs}),Sa=M({writable:W(se),readonly:W(se)}),ms=M({err:jn,fee:_(),innerInstructions:yt(V(W(M({index:_(),instructions:W(M({accounts:W(_()),data:D(),programIdIndex:_()}))})))),preBalances:W(_()),postBalances:W(_()),logMessages:yt(V(W(D()))),preTokenBalances:yt(V(W(ss))),postTokenBalances:yt(V(W(ss))),loadedAddresses:yt(Sa),computeUnitsConsumed:yt(_())}),Bo=M({err:jn,fee:_(),innerInstructions:yt(V(W(M({index:_(),instructions:W(xa)})))),preBalances:W(_()),postBalances:W(_()),logMessages:yt(V(W(D()))),preTokenBalances:yt(V(W(ss))),postTokenBalances:yt(V(W(ss))),loadedAddresses:yt(Sa),computeUnitsConsumed:yt(_())}),pr=Oe([ne(0),ne("legacy")]),Wn=M({pubkey:D(),lamports:_(),postBalance:V(_()),rewardType:V(D()),commission:yt(V(_()))}),Dl=Nt(V(M({blockhash:D(),previousBlockhash:D(),parentSlot:_(),transactions:W(M({transaction:Ao,meta:V(ms),version:yt(pr)})),rewards:yt(W(Wn)),blockTime:V(_()),blockHeight:V(_())}))),Hl=Nt(V(M({blockhash:D(),previousBlockhash:D(),parentSlot:_(),rewards:yt(W(Wn)),blockTime:V(_()),blockHeight:V(_())}))),$l=Nt(V(M({blockhash:D(),previousBlockhash:D(),parentSlot:_(),transactions:W(M({transaction:wa,meta:V(ms),version:yt(pr)})),rewards:yt(W(Wn)),blockTime:V(_()),blockHeight:V(_())}))),jl=Nt(V(M({blockhash:D(),previousBlockhash:D(),parentSlot:_(),transactions:W(M({transaction:va,meta:V(Bo),version:yt(pr)})),rewards:yt(W(Wn)),blockTime:V(_()),blockHeight:V(_())}))),Wl=Nt(V(M({blockhash:D(),previousBlockhash:D(),parentSlot:_(),transactions:W(M({transaction:wa,meta:V(Bo),version:yt(pr)})),rewards:yt(W(Wn)),blockTime:V(_()),blockHeight:V(_())}))),Vl=Nt(V(M({blockhash:D(),previousBlockhash:D(),parentSlot:_(),rewards:yt(W(Wn)),blockTime:V(_()),blockHeight:V(_())}))),Gl=Nt(V(M({blockhash:D(),previousBlockhash:D(),parentSlot:_(),transactions:W(M({transaction:Ao,meta:V(ms)})),rewards:yt(W(Wn)),blockTime:V(_())}))),ii=Nt(V(M({blockhash:D(),previousBlockhash:D(),parentSlot:_(),signatures:W(D()),blockTime:V(_())}))),Hs=Nt(V(M({slot:_(),meta:V(ms),blockTime:yt(V(_())),transaction:Ao,version:yt(pr)}))),Wr=Nt(V(M({slot:_(),transaction:va,meta:V(Bo),blockTime:yt(V(_())),version:yt(pr)}))),Yl=pe(M({blockhash:D(),lastValidBlockHeight:_()})),Zl=pe(sn()),Jl=M({slot:_(),numTransactions:_(),numSlots:_(),samplePeriodSecs:_()}),Xl=Nt(W(Jl)),Ql=pe(V(M({feeCalculator:M({lamportsPerSignature:_()})}))),td=Nt(D()),ed=Nt(D()),nd=M({err:jn,logs:W(D()),signature:D()}),rd=M({result:bs(nd),subscription:_()}),sd={"solana-client":"js/1.0.0-maintenance"};class Ea{constructor(t,e){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const g={};return async y=>{const{commitment:v,config:S}=Jt(y),b=this._buildArgs([],v,void 0,S),A=ti(b);return g[A]=g[A]??(async()=>{try{const m=await this._rpcRequest("getBlockHeight",b),w=$(m,Nt(_()));if("error"in w)throw new lt(w.error,"failed to get block height information");return w.result}finally{delete g[A]}})(),await g[A]}})();let n,s,o,i,f,u;e&&typeof e=="string"?this._commitment=e:e&&(this._commitment=e.commitment,this._confirmTransactionInitialTimeout=e.confirmTransactionInitialTimeout,n=e.wsEndpoint,s=e.httpHeaders,o=e.fetch,i=e.fetchMiddleware,f=e.disableRetryOnRateLimit,u=e.httpAgent),this._rpcEndpoint=Hu(t),this._rpcWsEndpoint=n||Ku(t),this._rpcClient=sl(t,s,o,i,f,u),this._rpcRequest=ol(this._rpcClient),this._rpcBatchRequest=il(this._rpcClient),this._rpcWebSocket=new Mu(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(t,e){const{commitment:n,config:s}=Jt(e),o=this._buildArgs([t.toBase58()],n,void 0,s),i=await this._rpcRequest("getBalance",o),f=$(i,pe(_()));if("error"in f)throw new lt(f.error,`failed to get balance for ${t.toBase58()}`);return f.result}async getBalance(t,e){return await this.getBalanceAndContext(t,e).then(n=>n.value).catch(n=>{throw new Error("failed to get balance of account "+t.toBase58()+": "+n)})}async getBlockTime(t){const e=await this._rpcRequest("getBlockTime",[t]),n=$(e,Nt(V(_())));if("error"in n)throw new lt(n.error,`failed to get block time for slot ${t}`);return n.result}async getMinimumLedgerSlot(){const t=await this._rpcRequest("minimumLedgerSlot",[]),e=$(t,Nt(_()));if("error"in e)throw new lt(e.error,"failed to get minimum ledger slot");return e.result}async getFirstAvailableBlock(){const t=await this._rpcRequest("getFirstAvailableBlock",[]),e=$(t,hl);if("error"in e)throw new lt(e.error,"failed to get first available block");return e.result}async getSupply(t){let e={};typeof t=="string"?e={commitment:t}:t?e={...t,commitment:t&&t.commitment||this.commitment}:e={commitment:this.commitment};const n=await this._rpcRequest("getSupply",[e]),s=$(n,gl);if("error"in s)throw new lt(s.error,"failed to get supply");return s.result}async getTokenSupply(t,e){const n=this._buildArgs([t.toBase58()],e),s=await this._rpcRequest("getTokenSupply",n),o=$(s,pe(Xs));if("error"in o)throw new lt(o.error,"failed to get token supply");return o.result}async getTokenAccountBalance(t,e){const n=this._buildArgs([t.toBase58()],e),s=await this._rpcRequest("getTokenAccountBalance",n),o=$(s,pe(Xs));if("error"in o)throw new lt(o.error,"failed to get token account balance");return o.result}async getTokenAccountsByOwner(t,e,n){const{commitment:s,config:o}=Jt(n);let i=[t.toBase58()];"mint"in e?i.push({mint:e.mint.toBase58()}):i.push({programId:e.programId.toBase58()});const f=this._buildArgs(i,s,"base64",o),u=await this._rpcRequest("getTokenAccountsByOwner",f),g=$(u,yl);if("error"in g)throw new lt(g.error,`failed to get token accounts owned by account ${t.toBase58()}`);return g.result}async getParsedTokenAccountsByOwner(t,e,n){let s=[t.toBase58()];"mint"in e?s.push({mint:e.mint.toBase58()}):s.push({programId:e.programId.toBase58()});const o=this._buildArgs(s,n,"jsonParsed"),i=await this._rpcRequest("getTokenAccountsByOwner",o),f=$(i,wl);if("error"in f)throw new lt(f.error,`failed to get token accounts owned by account ${t.toBase58()}`);return f.result}async getLargestAccounts(t){const e={...t,commitment:t&&t.commitment||this.commitment},n=e.filter||e.commitment?[e]:[],s=await this._rpcRequest("getLargestAccounts",n),o=$(s,bl);if("error"in o)throw new lt(o.error,"failed to get largest accounts");return o.result}async getTokenLargestAccounts(t,e){const n=this._buildArgs([t.toBase58()],e),s=await this._rpcRequest("getTokenLargestAccounts",n),o=$(s,pl);if("error"in o)throw new lt(o.error,"failed to get token largest accounts");return o.result}async getAccountInfoAndContext(t,e){const{commitment:n,config:s}=Jt(e),o=this._buildArgs([t.toBase58()],n,"base64",s),i=await this._rpcRequest("getAccountInfo",o),f=$(i,pe(V(Tr)));if("error"in f)throw new lt(f.error,`failed to get info about account ${t.toBase58()}`);return f.result}async getParsedAccountInfo(t,e){const{commitment:n,config:s}=Jt(e),o=this._buildArgs([t.toBase58()],n,"jsonParsed",s),i=await this._rpcRequest("getAccountInfo",o),f=$(i,pe(V(to)));if("error"in f)throw new lt(f.error,`failed to get info about account ${t.toBase58()}`);return f.result}async getAccountInfo(t,e){try{return(await this.getAccountInfoAndContext(t,e)).value}catch(n){throw new Error("failed to get info about account "+t.toBase58()+": "+n)}}async getMultipleParsedAccounts(t,e){const{commitment:n,config:s}=Jt(e),o=t.map(g=>g.toBase58()),i=this._buildArgs([o],n,"jsonParsed",s),f=await this._rpcRequest("getMultipleAccounts",i),u=$(f,pe(W(V(to))));if("error"in u)throw new lt(u.error,`failed to get info for accounts ${o}`);return u.result}async getMultipleAccountsInfoAndContext(t,e){const{commitment:n,config:s}=Jt(e),o=t.map(g=>g.toBase58()),i=this._buildArgs([o],n,"base64",s),f=await this._rpcRequest("getMultipleAccounts",i),u=$(f,pe(W(V(Tr))));if("error"in u)throw new lt(u.error,`failed to get info for accounts ${o}`);return u.result}async getMultipleAccountsInfo(t,e){return(await this.getMultipleAccountsInfoAndContext(t,e)).value}async getStakeActivation(t,e,n){const{commitment:s,config:o}=Jt(e),i=this._buildArgs([t.toBase58()],s,void 0,{...o,epoch:n??(o==null?void 0:o.epoch)}),f=await this._rpcRequest("getStakeActivation",i),u=$(f,Nt(Sl));if("error"in u)throw new lt(u.error,`failed to get Stake Activation ${t.toBase58()}`);return u.result}async getProgramAccounts(t,e){const{commitment:n,config:s}=Jt(e),{encoding:o,...i}=s||{},f=this._buildArgs([t.toBase58()],n,o||"base64",{...i,...i.filters?{filters:ri(i.filters)}:null}),u=await this._rpcRequest("getProgramAccounts",f),g=W(ml),y=i.withContext===!0?$(u,pe(g)):$(u,Nt(g));if("error"in y)throw new lt(y.error,`failed to get accounts owned by program ${t.toBase58()}`);return y.result}async getParsedProgramAccounts(t,e){const{commitment:n,config:s}=Jt(e),o=this._buildArgs([t.toBase58()],n,"jsonParsed",s),i=await this._rpcRequest("getProgramAccounts",o),f=$(i,Nt(W(vl)));if("error"in f)throw new lt(f.error,`failed to get accounts owned by program ${t.toBase58()}`);return f.result}async confirmTransaction(t,e){var o;let n;if(typeof t=="string")n=t;else{const i=t;if((o=i.abortSignal)!=null&&o.aborted)return Promise.reject(i.abortSignal.reason);n=i.signature}let s;try{s=Be.decode(n)}catch{throw new Error("signature must be base58 encoded: "+n)}return te(s.length===64,"signature has invalid length"),typeof t=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:e||this.commitment,signature:n}):"lastValidBlockHeight"in t?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e||this.commitment,strategy:t}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:e||this.commitment,strategy:t})}getCancellationPromise(t){return new Promise((e,n)=>{t!=null&&(t.aborted?n(t.reason):t.addEventListener("abort",()=>{n(t.reason)}))})}getTransactionConfirmationPromise({commitment:t,signature:e}){let n,s,o=!1;const i=new Promise((u,g)=>{try{n=this.onSignature(e,(v,S)=>{n=void 0;const b={context:S,value:v};u({__type:En.PROCESSED,response:b})},t);const y=new Promise(v=>{n==null?v():s=this._onSubscriptionStateChange(n,S=>{S==="subscribed"&&v()})});(async()=>{if(await y,o)return;const v=await this.getSignatureStatus(e);if(o||v==null)return;const{context:S,value:b}=v;if(b!=null)if(b!=null&&b.err)g(b.err);else{switch(t){case"confirmed":case"single":case"singleGossip":{if(b.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(b.confirmationStatus==="processed"||b.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}o=!0,u({__type:En.PROCESSED,response:{context:S,value:b}})}})()}catch(y){g(y)}});return{abortConfirmation:()=>{s&&(s(),s=void 0),n!=null&&(this.removeSignatureListener(n),n=void 0)},confirmationPromise:i}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t,strategy:{abortSignal:e,lastValidBlockHeight:n,signature:s}}){let o=!1;const i=new Promise(v=>{const S=async()=>{try{return await this.getBlockHeight(t)}catch{return-1}};(async()=>{let b=await S();if(!o){for(;b<=n;)if(await Qn(1e3),o||(b=await S(),o))return;v({__type:En.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:f,confirmationPromise:u}=this.getTransactionConfirmationPromise({commitment:t,signature:s}),g=this.getCancellationPromise(e);let y;try{const v=await Promise.race([g,u,i]);if(v.__type===En.PROCESSED)y=v.response;else throw new ca(s)}finally{o=!0,f()}return y}async confirmTransactionUsingDurableNonceStrategy({commitment:t,strategy:{abortSignal:e,minContextSlot:n,nonceAccountPubkey:s,nonceValue:o,signature:i}}){let f=!1;const u=new Promise(b=>{let A=o,m=null;const w=async()=>{try{const{context:T,value:F}=await this.getNonceAndContext(s,{commitment:t,minContextSlot:n});return m=T.slot,F==null?void 0:F.nonce}catch{return A}};(async()=>{if(A=await w(),!f)for(;;){if(o!==A){b({__type:En.NONCE_INVALID,slotInWhichNonceDidAdvance:m});return}if(await Qn(2e3),f||(A=await w(),f))return}})()}),{abortConfirmation:g,confirmationPromise:y}=this.getTransactionConfirmationPromise({commitment:t,signature:i}),v=this.getCancellationPromise(e);let S;try{const b=await Promise.race([v,y,u]);if(b.__type===En.PROCESSED)S=b.response;else{let A;for(;;){const m=await this.getSignatureStatus(i);if(m==null)break;if(m.context.slot<(b.slotInWhichNonceDidAdvance??n)){await Qn(400);continue}A=m;break}if(A!=null&&A.value){const m=t||"finalized",{confirmationStatus:w}=A.value;switch(m){case"processed":case"recent":if(w!=="processed"&&w!=="confirmed"&&w!=="finalized")throw new _r(i);break;case"confirmed":case"single":case"singleGossip":if(w!=="confirmed"&&w!=="finalized")throw new _r(i);break;case"finalized":case"max":case"root":if(w!=="finalized")throw new _r(i);break;default:}S={context:A.context,value:{err:A.value.err}}}else throw new _r(i)}}finally{f=!0,g()}return S}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:t,signature:e}){let n;const s=new Promise(u=>{let g=this._confirmTransactionInitialTimeout||6e4;switch(t){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{g=this._confirmTransactionInitialTimeout||3e4;break}}n=setTimeout(()=>u({__type:En.TIMED_OUT,timeoutMs:g}),g)}),{abortConfirmation:o,confirmationPromise:i}=this.getTransactionConfirmationPromise({commitment:t,signature:e});let f;try{const u=await Promise.race([i,s]);if(u.__type===En.PROCESSED)f=u.response;else throw new fa(e,u.timeoutMs/1e3)}finally{clearTimeout(n),o()}return f}async getClusterNodes(){const t=await this._rpcRequest("getClusterNodes",[]),e=$(t,Nt(W(Pl)));if("error"in e)throw new lt(e.error,"failed to get cluster nodes");return e.result}async getVoteAccounts(t){const e=this._buildArgs([],t),n=await this._rpcRequest("getVoteAccounts",e),s=$(n,Nl);if("error"in s)throw new lt(s.error,"failed to get vote accounts");return s.result}async getSlot(t){const{commitment:e,config:n}=Jt(t),s=this._buildArgs([],e,void 0,n),o=await this._rpcRequest("getSlot",s),i=$(o,Nt(_()));if("error"in i)throw new lt(i.error,"failed to get slot");return i.result}async getSlotLeader(t){const{commitment:e,config:n}=Jt(t),s=this._buildArgs([],e,void 0,n),o=await this._rpcRequest("getSlotLeader",s),i=$(o,Nt(D()));if("error"in i)throw new lt(i.error,"failed to get slot leader");return i.result}async getSlotLeaders(t,e){const n=[t,e],s=await this._rpcRequest("getSlotLeaders",n),o=$(s,Nt(W(se)));if("error"in o)throw new lt(o.error,"failed to get slot leaders");return o.result}async getSignatureStatus(t,e){const{context:n,value:s}=await this.getSignatureStatuses([t],e);te(s.length===1);const o=s[0];return{context:n,value:o}}async getSignatureStatuses(t,e){const n=[t];e&&n.push(e);const s=await this._rpcRequest("getSignatureStatuses",n),o=$(s,Fl);if("error"in o)throw new lt(o.error,"failed to get signature status");return o.result}async getTransactionCount(t){const{commitment:e,config:n}=Jt(t),s=this._buildArgs([],e,void 0,n),o=await this._rpcRequest("getTransactionCount",s),i=$(o,Nt(_()));if("error"in i)throw new lt(i.error,"failed to get transaction count");return i.result}async getTotalSupply(t){return(await this.getSupply({commitment:t,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(t){const e=this._buildArgs([],t),n=await this._rpcRequest("getInflationGovernor",e),s=$(n,al);if("error"in s)throw new lt(s.error,"failed to get inflation");return s.result}async getInflationReward(t,e,n){const{commitment:s,config:o}=Jt(n),i=this._buildArgs([t.map(g=>g.toBase58())],s,void 0,{...o,epoch:e??(o==null?void 0:o.epoch)}),f=await this._rpcRequest("getInflationReward",i),u=$(f,Wu);if("error"in u)throw new lt(u.error,"failed to get inflation reward");return u.result}async getInflationRate(){const t=await this._rpcRequest("getInflationRate",[]),e=$(t,cl);if("error"in e)throw new lt(e.error,"failed to get inflation rate");return e.result}async getEpochInfo(t){const{commitment:e,config:n}=Jt(t),s=this._buildArgs([],e,void 0,n),o=await this._rpcRequest("getEpochInfo",s),i=$(o,ul);if("error"in i)throw new lt(i.error,"failed to get epoch info");return i.result}async getEpochSchedule(){const t=await this._rpcRequest("getEpochSchedule",[]),e=$(t,ll);if("error"in e)throw new lt(e.error,"failed to get epoch schedule");const n=e.result;return new Nu(n.slotsPerEpoch,n.leaderScheduleSlotOffset,n.warmup,n.firstNormalEpoch,n.firstNormalSlot)}async getLeaderSchedule(){const t=await this._rpcRequest("getLeaderSchedule",[]),e=$(t,dl);if("error"in e)throw new lt(e.error,"failed to get leader schedule");return e.result}async getMinimumBalanceForRentExemption(t,e){const n=this._buildArgs([t],e),s=await this._rpcRequest("getMinimumBalanceForRentExemption",n),o=$(s,zl);return"error"in o?(console.warn("Unable to fetch minimum balance for rent exemption"),0):o.result}async getRecentBlockhashAndContext(t){const{context:e,value:{blockhash:n}}=await this.getLatestBlockhashAndContext(t);return{context:e,value:{blockhash:n,feeCalculator:{get lamportsPerSignature(){throw new Error("The capability to fetch `lamportsPerSignature` using the `getRecentBlockhash` API is no longer offered by the network. Use the `getFeeForMessage` API to obtain the fee for a given message.")},toJSON(){return{}}}}}}async getRecentPerformanceSamples(t){const e=await this._rpcRequest("getRecentPerformanceSamples",t?[t]:[]),n=$(e,Xl);if("error"in n)throw new lt(n.error,"failed to get recent performance samples");return n.result}async getFeeCalculatorForBlockhash(t,e){const n=this._buildArgs([t],e),s=await this._rpcRequest("getFeeCalculatorForBlockhash",n),o=$(s,Ql);if("error"in o)throw new lt(o.error,"failed to get fee calculator");const{context:i,value:f}=o.result;return{context:i,value:f!==null?f.feeCalculator:null}}async getFeeForMessage(t,e){const n=cr(t.serialize()).toString("base64"),s=this._buildArgs([n],e),o=await this._rpcRequest("getFeeForMessage",s),i=$(o,pe(V(_())));if("error"in i)throw new lt(i.error,"failed to get fee for message");if(i.result===null)throw new Error("invalid blockhash");return i.result}async getRecentPrioritizationFees(t){var i;const e=(i=t==null?void 0:t.lockedWritableAccounts)==null?void 0:i.map(f=>f.toBase58()),n=e!=null&&e.length?[e]:[],s=await this._rpcRequest("getRecentPrioritizationFees",n),o=$(s,fl);if("error"in o)throw new lt(o.error,"failed to get recent prioritization fees");return o.result}async getRecentBlockhash(t){try{return(await this.getRecentBlockhashAndContext(t)).value}catch(e){throw new Error("failed to get recent blockhash: "+e)}}async getLatestBlockhash(t){try{return(await this.getLatestBlockhashAndContext(t)).value}catch(e){throw new Error("failed to get recent blockhash: "+e)}}async getLatestBlockhashAndContext(t){const{commitment:e,config:n}=Jt(t),s=this._buildArgs([],e,void 0,n),o=await this._rpcRequest("getLatestBlockhash",s),i=$(o,Yl);if("error"in i)throw new lt(i.error,"failed to get latest blockhash");return i.result}async isBlockhashValid(t,e){const{commitment:n,config:s}=Jt(e),o=this._buildArgs([t],n,void 0,s),i=await this._rpcRequest("isBlockhashValid",o),f=$(i,Zl);if("error"in f)throw new lt(f.error,"failed to determine if the blockhash `"+t+"`is valid");return f.result}async getVersion(){const t=await this._rpcRequest("getVersion",[]),e=$(t,Nt(tl));if("error"in e)throw new lt(e.error,"failed to get version");return e.result}async getGenesisHash(){const t=await this._rpcRequest("getGenesisHash",[]),e=$(t,Nt(D()));if("error"in e)throw new lt(e.error,"failed to get genesis hash");return e.result}async getBlock(t,e){const{commitment:n,config:s}=Jt(e),o=this._buildArgsAtLeastConfirmed([t],n,void 0,s),i=await this._rpcRequest("getBlock",o);try{switch(s==null?void 0:s.transactionDetails){case"accounts":{const f=$(i,$l);if("error"in f)throw f.error;return f.result}case"none":{const f=$(i,Hl);if("error"in f)throw f.error;return f.result}default:{const f=$(i,Dl);if("error"in f)throw f.error;const{result:u}=f;return u?{...u,transactions:u.transactions.map(({transaction:g,meta:y,version:v})=>({meta:y,transaction:{...g,message:Ds(v,g.message)},version:v}))}:null}}}catch(f){throw new lt(f,"failed to get confirmed block")}}async getParsedBlock(t,e){const{commitment:n,config:s}=Jt(e),o=this._buildArgsAtLeastConfirmed([t],n,"jsonParsed",s),i=await this._rpcRequest("getBlock",o);try{switch(s==null?void 0:s.transactionDetails){case"accounts":{const f=$(i,Wl);if("error"in f)throw f.error;return f.result}case"none":{const f=$(i,Vl);if("error"in f)throw f.error;return f.result}default:{const f=$(i,jl);if("error"in f)throw f.error;return f.result}}}catch(f){throw new lt(f,"failed to get block")}}async getBlockProduction(t){let e,n;if(typeof t=="string")n=t;else if(t){const{commitment:f,...u}=t;n=f,e=u}const s=this._buildArgs([],n,"base64",e),o=await this._rpcRequest("getBlockProduction",s),i=$(o,rl);if("error"in i)throw new lt(i.error,"failed to get block production information");return i.result}async getTransaction(t,e){const{commitment:n,config:s}=Jt(e),o=this._buildArgsAtLeastConfirmed([t],n,void 0,s),i=await this._rpcRequest("getTransaction",o),f=$(i,Hs);if("error"in f)throw new lt(f.error,"failed to get transaction");const u=f.result;return u&&{...u,transaction:{...u.transaction,message:Ds(u.version,u.transaction.message)}}}async getParsedTransaction(t,e){const{commitment:n,config:s}=Jt(e),o=this._buildArgsAtLeastConfirmed([t],n,"jsonParsed",s),i=await this._rpcRequest("getTransaction",o),f=$(i,Wr);if("error"in f)throw new lt(f.error,"failed to get transaction");return f.result}async getParsedTransactions(t,e){const{commitment:n,config:s}=Jt(e),o=t.map(u=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([u],n,"jsonParsed",s)}));return(await this._rpcBatchRequest(o)).map(u=>{const g=$(u,Wr);if("error"in g)throw new lt(g.error,"failed to get transactions");return g.result})}async getTransactions(t,e){const{commitment:n,config:s}=Jt(e),o=t.map(u=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([u],n,void 0,s)}));return(await this._rpcBatchRequest(o)).map(u=>{const g=$(u,Hs);if("error"in g)throw new lt(g.error,"failed to get transactions");const y=g.result;return y&&{...y,transaction:{...y.transaction,message:Ds(y.version,y.transaction.message)}}})}async getConfirmedBlock(t,e){const n=this._buildArgsAtLeastConfirmed([t],e),s=await this._rpcRequest("getBlock",n),o=$(s,Gl);if("error"in o)throw new lt(o.error,"failed to get confirmed block");const i=o.result;if(!i)throw new Error("Confirmed block "+t+" not found");const f={...i,transactions:i.transactions.map(({transaction:u,meta:g})=>{const y=new wn(u.message);return{meta:g,transaction:{...u,message:y}}})};return{...f,transactions:f.transactions.map(({transaction:u,meta:g})=>({meta:g,transaction:_n.populate(u.message,u.signatures)}))}}async getBlocks(t,e,n){const s=this._buildArgsAtLeastConfirmed(e!==void 0?[t,e]:[t],n),o=await this._rpcRequest("getBlocks",s),i=$(o,Nt(W(_())));if("error"in i)throw new lt(i.error,"failed to get blocks");return i.result}async getBlockSignatures(t,e){const n=this._buildArgsAtLeastConfirmed([t],e,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getBlock",n),o=$(s,ii);if("error"in o)throw new lt(o.error,"failed to get block");const i=o.result;if(!i)throw new Error("Block "+t+" not found");return i}async getConfirmedBlockSignatures(t,e){const n=this._buildArgsAtLeastConfirmed([t],e,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getBlock",n),o=$(s,ii);if("error"in o)throw new lt(o.error,"failed to get confirmed block");const i=o.result;if(!i)throw new Error("Confirmed block "+t+" not found");return i}async getConfirmedTransaction(t,e){const n=this._buildArgsAtLeastConfirmed([t],e),s=await this._rpcRequest("getTransaction",n),o=$(s,Hs);if("error"in o)throw new lt(o.error,"failed to get transaction");const i=o.result;if(!i)return i;const f=new wn(i.transaction.message),u=i.transaction.signatures;return{...i,transaction:_n.populate(f,u)}}async getParsedConfirmedTransaction(t,e){const n=this._buildArgsAtLeastConfirmed([t],e,"jsonParsed"),s=await this._rpcRequest("getTransaction",n),o=$(s,Wr);if("error"in o)throw new lt(o.error,"failed to get confirmed transaction");return o.result}async getParsedConfirmedTransactions(t,e){const n=t.map(i=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([i],e,"jsonParsed")}));return(await this._rpcBatchRequest(n)).map(i=>{const f=$(i,Wr);if("error"in f)throw new lt(f.error,"failed to get confirmed transactions");return f.result})}async getConfirmedSignaturesForAddress(t,e,n){let s={},o=await this.getFirstAvailableBlock();for(;!("until"in s)&&(e--,!(e<=0||e<o));)try{const u=await this.getConfirmedBlockSignatures(e,"finalized");u.signatures.length>0&&(s.until=u.signatures[u.signatures.length-1].toString())}catch(u){if(u instanceof Error&&u.message.includes("skipped"))continue;throw u}let i=await this.getSlot("finalized");for(;!("before"in s)&&(n++,!(n>i));)try{const u=await this.getConfirmedBlockSignatures(n);u.signatures.length>0&&(s.before=u.signatures[u.signatures.length-1].toString())}catch(u){if(u instanceof Error&&u.message.includes("skipped"))continue;throw u}return(await this.getConfirmedSignaturesForAddress2(t,s)).map(u=>u.signature)}async getConfirmedSignaturesForAddress2(t,e,n){const s=this._buildArgsAtLeastConfirmed([t.toBase58()],n,void 0,e),o=await this._rpcRequest("getConfirmedSignaturesForAddress2",s),i=$(o,El);if("error"in i)throw new lt(i.error,"failed to get confirmed signatures for address");return i.result}async getSignaturesForAddress(t,e,n){const s=this._buildArgsAtLeastConfirmed([t.toBase58()],n,void 0,e),o=await this._rpcRequest("getSignaturesForAddress",s),i=$(o,_l);if("error"in i)throw new lt(i.error,"failed to get signatures for address");return i.result}async getAddressLookupTable(t,e){const{context:n,value:s}=await this.getAccountInfoAndContext(t,e);let o=null;return s!==null&&(o=new ni({key:t,state:ni.deserialize(s.data)})),{context:n,value:o}}async getNonceAndContext(t,e){const{context:n,value:s}=await this.getAccountInfoAndContext(t,e);let o=null;return s!==null&&(o=Eo.fromAccountData(s.data)),{context:n,value:o}}async getNonce(t,e){return await this.getNonceAndContext(t,e).then(n=>n.value).catch(n=>{throw new Error("failed to get nonce for account "+t.toBase58()+": "+n)})}async requestAirdrop(t,e){const n=await this._rpcRequest("requestAirdrop",[t.toBase58(),e]),s=$(n,td);if("error"in s)throw new lt(s.error,`airdrop to ${t.toBase58()} failed`);return s.result}async _blockhashWithExpiryBlockHeight(t){if(!t){for(;this._pollingBlockhash;)await Qn(100);const n=Date.now()-this._blockhashInfo.lastFetch>=Du;if(this._blockhashInfo.latestBlockhash!==null&&!n)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const t=Date.now(),e=this._blockhashInfo.latestBlockhash,n=e?e.blockhash:null;for(let s=0;s<50;s++){const o=await this.getLatestBlockhash("finalized");if(n!==o.blockhash)return this._blockhashInfo={latestBlockhash:o,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},o;await Qn(ku/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-t}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(t){const{commitment:e,config:n}=Jt(t),s=this._buildArgs([],e,"base64",n),o=await this._rpcRequest("getStakeMinimumDelegation",s),i=$(o,pe(_()));if("error"in i)throw new lt(i.error,"failed to get stake minimum delegation");return i.result}async simulateTransaction(t,e,n){if("message"in t){const m=t.serialize(),w=Lt.Buffer.from(m).toString("base64");if(Array.isArray(e)||n!==void 0)throw new Error("Invalid arguments");const T=e||{};T.encoding="base64","commitment"in T||(T.commitment=this.commitment),e&&typeof e=="object"&&"innerInstructions"in e&&(T.innerInstructions=e.innerInstructions);const F=[w,T],R=await this._rpcRequest("simulateTransaction",F),H=$(R,si);if("error"in H)throw new Error("failed to simulate transaction: "+H.error.message);return H.result}let s;if(t instanceof _n){let A=t;s=new _n,s.feePayer=A.feePayer,s.instructions=t.instructions,s.nonceInfo=A.nonceInfo,s.signatures=A.signatures}else s=_n.populate(t),s._message=s._json=void 0;if(e!==void 0&&!Array.isArray(e))throw new Error("Invalid arguments");const o=e;if(s.nonceInfo&&o)s.sign(...o);else{let A=this._disableBlockhashCaching;for(;;){const m=await this._blockhashWithExpiryBlockHeight(A);if(s.lastValidBlockHeight=m.lastValidBlockHeight,s.recentBlockhash=m.blockhash,!o)break;if(s.sign(...o),!s.signature)throw new Error("!signature");const w=s.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(w)&&!this._blockhashInfo.transactionSignatures.includes(w)){this._blockhashInfo.simulatedSignatures.push(w);break}else A=!0}}const i=s._compile(),f=i.serialize(),g=s._serialize(f).toString("base64"),y={encoding:"base64",commitment:this.commitment};if(n){const A=(Array.isArray(n)?n:i.nonProgramIds()).map(m=>m.toBase58());y.accounts={encoding:"base64",addresses:A}}o&&(y.sigVerify=!0),e&&typeof e=="object"&&"innerInstructions"in e&&(y.innerInstructions=e.innerInstructions);const v=[g,y],S=await this._rpcRequest("simulateTransaction",v),b=$(S,si);if("error"in b){let A;if("data"in b.error&&(A=b.error.data.logs,A&&Array.isArray(A))){const m=`
    `,w=m+A.join(m);console.error(b.error.message,w)}throw new Xo({action:"simulate",signature:"",transactionMessage:b.error.message,logs:A})}return b.result}async sendTransaction(t,e,n){if("version"in t){if(e&&Array.isArray(e))throw new Error("Invalid arguments");const i=t.serialize();return await this.sendRawTransaction(i,e)}if(e===void 0||!Array.isArray(e))throw new Error("Invalid arguments");const s=e;if(t.nonceInfo)t.sign(...s);else{let i=this._disableBlockhashCaching;for(;;){const f=await this._blockhashWithExpiryBlockHeight(i);if(t.lastValidBlockHeight=f.lastValidBlockHeight,t.recentBlockhash=f.blockhash,t.sign(...s),!t.signature)throw new Error("!signature");const u=t.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(u))i=!0;else{this._blockhashInfo.transactionSignatures.push(u);break}}}const o=t.serialize();return await this.sendRawTransaction(o,n)}async sendRawTransaction(t,e){const n=cr(t).toString("base64");return await this.sendEncodedTransaction(n,e)}async sendEncodedTransaction(t,e){const n={encoding:"base64"},s=e&&e.skipPreflight,o=s===!0?"processed":e&&e.preflightCommitment||this.commitment;e&&e.maxRetries!=null&&(n.maxRetries=e.maxRetries),e&&e.minContextSlot!=null&&(n.minContextSlot=e.minContextSlot),s&&(n.skipPreflight=s),o&&(n.preflightCommitment=o);const i=[t,n],f=await this._rpcRequest("sendTransaction",i),u=$(f,ed);if("error"in u){let g;throw"data"in u.error&&(g=u.error.data.logs),new Xo({action:s?"send":"simulate",signature:"",transactionMessage:u.error.message,logs:g})}return u.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(t){this._rpcWebSocketConnected=!1,console.error("ws error:",t.message)}_wsOnClose(t){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),t===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([e,n])=>{this._setSubscription(e,{...n,state:"pending"})})}_setSubscription(t,e){var s;const n=(s=this._subscriptionsByHash[t])==null?void 0:s.state;if(this._subscriptionsByHash[t]=e,n!==e.state){const o=this._subscriptionStateChangeCallbacksByHash[t];o&&o.forEach(i=>{try{i(e.state)}catch{}})}}_onSubscriptionStateChange(t,e){var o;const n=this._subscriptionHashByClientSubscriptionId[t];if(n==null)return()=>{};const s=(o=this._subscriptionStateChangeCallbacksByHash)[n]||(o[n]=new Set);return s.add(e),()=>{s.delete(e),s.size===0&&delete this._subscriptionStateChangeCallbacksByHash[n]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(n){n instanceof Error&&console.log(`Error when closing socket connection: ${n.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const t=this._rpcWebSocketGeneration,e=()=>t===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async n=>{const s=this._subscriptionsByHash[n];if(s!==void 0)switch(s.state){case"pending":case"unsubscribed":if(s.callbacks.size===0){delete this._subscriptionsByHash[n],s.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[s.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:o,method:i}=s;try{this._setSubscription(n,{...s,state:"subscribing"});const f=await this._rpcWebSocket.call(i,o);this._setSubscription(n,{...s,serverSubscriptionId:f,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[f]=s.callbacks,await this._updateSubscriptions()}catch(f){if(console.error(`Received ${f instanceof Error?"":"JSON-RPC "}error calling \`${i}\``,{args:o,error:f}),!e())return;this._setSubscription(n,{...s,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":s.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:o,unsubscribeMethod:i}=s;if(this._subscriptionsAutoDisposedByRpc.has(o))this._subscriptionsAutoDisposedByRpc.delete(o);else{this._setSubscription(n,{...s,state:"unsubscribing"}),this._setSubscription(n,{...s,state:"unsubscribing"});try{await this._rpcWebSocket.call(i,[o])}catch(f){if(f instanceof Error&&console.error(`${i} error:`,f.message),!e())return;this._setSubscription(n,{...s,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(n,{...s,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(t,e){const n=this._subscriptionCallbacksByServerSubscriptionId[t];n!==void 0&&n.forEach(s=>{try{s(...e)}catch(o){console.error(o)}})}_wsOnAccountNotification(t){const{result:e,subscription:n}=$(t,Al);this._handleServerNotification(n,[e.value,e.context])}_makeSubscription(t,e){const n=this._nextClientSubscriptionId++,s=ti([t.method,e]),o=this._subscriptionsByHash[s];return o===void 0?this._subscriptionsByHash[s]={...t,args:e,callbacks:new Set([t.callback]),state:"pending"}:o.callbacks.add(t.callback),this._subscriptionHashByClientSubscriptionId[n]=s,this._subscriptionDisposeFunctionsByClientSubscriptionId[n]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[n],delete this._subscriptionHashByClientSubscriptionId[n];const i=this._subscriptionsByHash[s];te(i!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${n}`),i.callbacks.delete(t.callback),await this._updateSubscriptions()},this._updateSubscriptions(),n}onAccountChange(t,e,n){const{commitment:s,config:o}=Jt(n),i=this._buildArgs([t.toBase58()],s||this._commitment||"finalized","base64",o);return this._makeSubscription({callback:e,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},i)}async removeAccountChangeListener(t){await this._unsubscribeClientSubscription(t,"account change")}_wsOnProgramAccountNotification(t){const{result:e,subscription:n}=$(t,kl);this._handleServerNotification(n,[{accountId:e.value.pubkey,accountInfo:e.value.account},e.context])}onProgramAccountChange(t,e,n,s){const{commitment:o,config:i}=Jt(n),f=this._buildArgs([t.toBase58()],o||this._commitment||"finalized","base64",i||(s?{filters:ri(s)}:void 0));return this._makeSubscription({callback:e,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},f)}async removeProgramAccountChangeListener(t){await this._unsubscribeClientSubscription(t,"program account change")}onLogs(t,e,n){const s=this._buildArgs([typeof t=="object"?{mentions:[t.toString()]}:t],n||this._commitment||"finalized");return this._makeSubscription({callback:e,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},s)}async removeOnLogsListener(t){await this._unsubscribeClientSubscription(t,"logs")}_wsOnLogsNotification(t){const{result:e,subscription:n}=$(t,rd);this._handleServerNotification(n,[e.value,e.context])}_wsOnSlotNotification(t){const{result:e,subscription:n}=$(t,Rl);this._handleServerNotification(n,[e])}onSlotChange(t){return this._makeSubscription({callback:t,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(t){await this._unsubscribeClientSubscription(t,"slot change")}_wsOnSlotUpdatesNotification(t){const{result:e,subscription:n}=$(t,Cl);this._handleServerNotification(n,[e])}onSlotUpdate(t){return this._makeSubscription({callback:t,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(t){await this._unsubscribeClientSubscription(t,"slot update")}async _unsubscribeClientSubscription(t,e){const n=this._subscriptionDisposeFunctionsByClientSubscriptionId[t];n?await n():console.warn(`Ignored unsubscribe request because an active subscription with id \`${t}\` for '${e}' events could not be found.`)}_buildArgs(t,e,n,s){const o=e||this._commitment;if(o||n||s){let i={};n&&(i.encoding=n),o&&(i.commitment=o),s&&(i=Object.assign(i,s)),t.push(i)}return t}_buildArgsAtLeastConfirmed(t,e,n,s){const o=e||this._commitment;if(o&&!["confirmed","finalized"].includes(o))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(t,e,n,s)}_wsOnSignatureNotification(t){const{result:e,subscription:n}=$(t,Ll);e.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(n),this._handleServerNotification(n,e.value==="receivedSignature"?[{type:"received"},e.context]:[{type:"status",result:e.value},e.context])}onSignature(t,e,n){const s=this._buildArgs([t],n||this._commitment||"finalized"),o=this._makeSubscription({callback:(i,f)=>{if(i.type==="status"){e(i.result,f);try{this.removeSignatureListener(o)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},s);return o}onSignatureWithOptions(t,e,n){const{commitment:s,...o}={...n,commitment:n&&n.commitment||this._commitment||"finalized"},i=this._buildArgs([t],s,void 0,o),f=this._makeSubscription({callback:(u,g)=>{e(u,g);try{this.removeSignatureListener(f)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},i);return f}async removeSignatureListener(t){await this._unsubscribeClientSubscription(t,"signature result")}_wsOnRootNotification(t){const{result:e,subscription:n}=$(t,Ul);this._handleServerNotification(n,[e])}onRootChange(t){return this._makeSubscription({callback:t,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(t){await this._unsubscribeClientSubscription(t,"root change")}}class Ar{constructor(t){this._keypair=void 0,this._keypair=t??Go()}static generate(){return new Ar(Go())}static fromSecretKey(t,e){if(t.byteLength!==64)throw new Error("bad secret key size");const n=t.slice(32,64);if(!e||!e.skipValidation){const s=t.slice(0,32),o=Js(s);for(let i=0;i<32;i++)if(n[i]!==o[i])throw new Error("provided secretKey is invalid")}return new Ar({publicKey:n,secretKey:t})}static fromSeed(t){const e=Js(t),n=new Uint8Array(64);return n.set(t),n.set(e,32),new Ar({publicKey:e,secretKey:n})}get publicKey(){return new wt(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}Object.freeze({CreateLookupTable:{index:0,layout:ft([gt("instruction"),fr("recentSlot"),Vt("bumpSeed")])},FreezeLookupTable:{index:1,layout:ft([gt("instruction")])},ExtendLookupTable:{index:2,layout:ft([gt("instruction"),fr(),Pe(qt(),zn(gt(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:ft([gt("instruction")])},CloseLookupTable:{index:4,layout:ft([gt("instruction")])}});new wt("AddressLookupTab1e1111111111111111111111111");Object.freeze({RequestUnits:{index:0,layout:ft([Vt("instruction"),gt("units"),gt("additionalFee")])},RequestHeapFrame:{index:1,layout:ft([Vt("instruction"),gt("bytes")])},SetComputeUnitLimit:{index:2,layout:ft([Vt("instruction"),gt("units")])},SetComputeUnitPrice:{index:3,layout:ft([Vt("instruction"),fr("microLamports")])}});new wt("ComputeBudget111111111111111111111111111111");ft([Vt("numSignatures"),Vt("padding"),We("signatureOffset"),We("signatureInstructionIndex"),We("publicKeyOffset"),We("publicKeyInstructionIndex"),We("messageDataOffset"),We("messageDataSize"),We("messageInstructionIndex")]);new wt("Ed25519SigVerify111111111111111111111111111");hu.utils.isValidPrivateKey;ft([Vt("numSignatures"),We("signatureOffset"),Vt("signatureInstructionIndex"),We("ethAddressOffset"),Vt("ethAddressInstructionIndex"),We("messageDataOffset"),We("messageDataSize"),Vt("messageInstructionIndex"),Qt(20,"ethAddress"),Qt(64,"signature"),Vt("recoveryId")]);new wt("KeccakSecp256k11111111111111111111111111111");var _a;new wt("StakeConfig11111111111111111111111111111111");class Aa{constructor(t,e,n){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=t,this.epoch=e,this.custodian=n}}_a=Aa;Aa.default=new _a(0,0,wt.default);Object.freeze({Initialize:{index:0,layout:ft([gt("instruction"),mu(),xu()])},Authorize:{index:1,layout:ft([gt("instruction"),qt("newAuthorized"),gt("stakeAuthorizationType")])},Delegate:{index:2,layout:ft([gt("instruction")])},Split:{index:3,layout:ft([gt("instruction"),Ke("lamports")])},Withdraw:{index:4,layout:ft([gt("instruction"),Ke("lamports")])},Deactivate:{index:5,layout:ft([gt("instruction")])},Merge:{index:7,layout:ft([gt("instruction")])},AuthorizeWithSeed:{index:8,layout:ft([gt("instruction"),qt("newAuthorized"),gt("stakeAuthorizationType"),er("authoritySeed"),qt("authorityOwner")])}});new wt("Stake11111111111111111111111111111111111111");Object.freeze({InitializeAccount:{index:0,layout:ft([gt("instruction"),vu()])},Authorize:{index:1,layout:ft([gt("instruction"),qt("newAuthorized"),gt("voteAuthorizationType")])},Withdraw:{index:3,layout:ft([gt("instruction"),Ke("lamports")])},UpdateValidatorIdentity:{index:4,layout:ft([gt("instruction")])},AuthorizeWithSeed:{index:10,layout:ft([gt("instruction"),Su()])}});new wt("Vote111111111111111111111111111111111111111");new wt("Va1idator1nfo111111111111111111111111111111");M({name:D(),website:yt(D()),details:yt(D()),iconUrl:yt(D()),keybaseUsername:yt(D())});new wt("Vote111111111111111111111111111111111111111");ft([qt("nodePubkey"),qt("authorizedWithdrawer"),Vt("commission"),_e(),Pe(ft([_e("slot"),gt("confirmationCount")]),zn(gt(),-8),"votes"),Vt("rootSlotValid"),_e("rootSlot"),_e(),Pe(ft([_e("epoch"),qt("authorizedVoter")]),zn(gt(),-8),"authorizedVoters"),ft([Pe(ft([qt("authorizedPubkey"),_e("epochOfLastAuthorizedSwitch"),_e("targetEpoch")]),32,"buf"),_e("idx"),Vt("isEmpty")],"priorVoters"),_e(),Pe(ft([_e("epoch"),_e("credits"),_e("prevCredits")]),zn(gt(),-8),"epochCredits"),ft([_e("slot"),_e("timestamp")],"lastTimestamp")]);var Ba={exports:{}};(function(r){(function(t){var e=function(c){var d,l=new Float64Array(16);if(c)for(d=0;d<c.length;d++)l[d]=c[d];return l},n=function(){throw new Error("no PRNG")},s=new Uint8Array(16),o=new Uint8Array(32);o[0]=9;var i=e(),f=e([1]),u=e([56129,1]),g=e([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=e([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),v=e([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),S=e([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),b=e([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function A(c,d,l,a){c[d]=l>>24&255,c[d+1]=l>>16&255,c[d+2]=l>>8&255,c[d+3]=l&255,c[d+4]=a>>24&255,c[d+5]=a>>16&255,c[d+6]=a>>8&255,c[d+7]=a&255}function m(c,d,l,a,h){var x,E=0;for(x=0;x<h;x++)E|=c[d+x]^l[a+x];return(1&E-1>>>8)-1}function w(c,d,l,a){return m(c,d,l,a,16)}function T(c,d,l,a){return m(c,d,l,a,32)}function F(c,d,l,a){for(var h=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,x=l[0]&255|(l[1]&255)<<8|(l[2]&255)<<16|(l[3]&255)<<24,E=l[4]&255|(l[5]&255)<<8|(l[6]&255)<<16|(l[7]&255)<<24,U=l[8]&255|(l[9]&255)<<8|(l[10]&255)<<16|(l[11]&255)<<24,q=l[12]&255|(l[13]&255)<<8|(l[14]&255)<<16|(l[15]&255)<<24,ct=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,X=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,Ht=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,tt=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,xt=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,St=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,kt=l[16]&255|(l[17]&255)<<8|(l[18]&255)<<16|(l[19]&255)<<24,Bt=l[20]&255|(l[21]&255)<<8|(l[22]&255)<<16|(l[23]&255)<<24,Et=l[24]&255|(l[25]&255)<<8|(l[26]&255)<<16|(l[27]&255)<<24,At=l[28]&255|(l[29]&255)<<8|(l[30]&255)<<16|(l[31]&255)<<24,_t=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,rt=h,dt=x,Q=E,ot=U,at=q,Z=ct,k=X,I=Ht,O=tt,L=xt,P=St,z=kt,pt=Bt,It=Et,Ct=At,Rt=_t,p,Ft=0;Ft<20;Ft+=2)p=rt+pt|0,at^=p<<7|p>>>32-7,p=at+rt|0,O^=p<<9|p>>>32-9,p=O+at|0,pt^=p<<13|p>>>32-13,p=pt+O|0,rt^=p<<18|p>>>32-18,p=Z+dt|0,L^=p<<7|p>>>32-7,p=L+Z|0,It^=p<<9|p>>>32-9,p=It+L|0,dt^=p<<13|p>>>32-13,p=dt+It|0,Z^=p<<18|p>>>32-18,p=P+k|0,Ct^=p<<7|p>>>32-7,p=Ct+P|0,Q^=p<<9|p>>>32-9,p=Q+Ct|0,k^=p<<13|p>>>32-13,p=k+Q|0,P^=p<<18|p>>>32-18,p=Rt+z|0,ot^=p<<7|p>>>32-7,p=ot+Rt|0,I^=p<<9|p>>>32-9,p=I+ot|0,z^=p<<13|p>>>32-13,p=z+I|0,Rt^=p<<18|p>>>32-18,p=rt+ot|0,dt^=p<<7|p>>>32-7,p=dt+rt|0,Q^=p<<9|p>>>32-9,p=Q+dt|0,ot^=p<<13|p>>>32-13,p=ot+Q|0,rt^=p<<18|p>>>32-18,p=Z+at|0,k^=p<<7|p>>>32-7,p=k+Z|0,I^=p<<9|p>>>32-9,p=I+k|0,at^=p<<13|p>>>32-13,p=at+I|0,Z^=p<<18|p>>>32-18,p=P+L|0,z^=p<<7|p>>>32-7,p=z+P|0,O^=p<<9|p>>>32-9,p=O+z|0,L^=p<<13|p>>>32-13,p=L+O|0,P^=p<<18|p>>>32-18,p=Rt+Ct|0,pt^=p<<7|p>>>32-7,p=pt+Rt|0,It^=p<<9|p>>>32-9,p=It+pt|0,Ct^=p<<13|p>>>32-13,p=Ct+It|0,Rt^=p<<18|p>>>32-18;rt=rt+h|0,dt=dt+x|0,Q=Q+E|0,ot=ot+U|0,at=at+q|0,Z=Z+ct|0,k=k+X|0,I=I+Ht|0,O=O+tt|0,L=L+xt|0,P=P+St|0,z=z+kt|0,pt=pt+Bt|0,It=It+Et|0,Ct=Ct+At|0,Rt=Rt+_t|0,c[0]=rt>>>0&255,c[1]=rt>>>8&255,c[2]=rt>>>16&255,c[3]=rt>>>24&255,c[4]=dt>>>0&255,c[5]=dt>>>8&255,c[6]=dt>>>16&255,c[7]=dt>>>24&255,c[8]=Q>>>0&255,c[9]=Q>>>8&255,c[10]=Q>>>16&255,c[11]=Q>>>24&255,c[12]=ot>>>0&255,c[13]=ot>>>8&255,c[14]=ot>>>16&255,c[15]=ot>>>24&255,c[16]=at>>>0&255,c[17]=at>>>8&255,c[18]=at>>>16&255,c[19]=at>>>24&255,c[20]=Z>>>0&255,c[21]=Z>>>8&255,c[22]=Z>>>16&255,c[23]=Z>>>24&255,c[24]=k>>>0&255,c[25]=k>>>8&255,c[26]=k>>>16&255,c[27]=k>>>24&255,c[28]=I>>>0&255,c[29]=I>>>8&255,c[30]=I>>>16&255,c[31]=I>>>24&255,c[32]=O>>>0&255,c[33]=O>>>8&255,c[34]=O>>>16&255,c[35]=O>>>24&255,c[36]=L>>>0&255,c[37]=L>>>8&255,c[38]=L>>>16&255,c[39]=L>>>24&255,c[40]=P>>>0&255,c[41]=P>>>8&255,c[42]=P>>>16&255,c[43]=P>>>24&255,c[44]=z>>>0&255,c[45]=z>>>8&255,c[46]=z>>>16&255,c[47]=z>>>24&255,c[48]=pt>>>0&255,c[49]=pt>>>8&255,c[50]=pt>>>16&255,c[51]=pt>>>24&255,c[52]=It>>>0&255,c[53]=It>>>8&255,c[54]=It>>>16&255,c[55]=It>>>24&255,c[56]=Ct>>>0&255,c[57]=Ct>>>8&255,c[58]=Ct>>>16&255,c[59]=Ct>>>24&255,c[60]=Rt>>>0&255,c[61]=Rt>>>8&255,c[62]=Rt>>>16&255,c[63]=Rt>>>24&255}function R(c,d,l,a){for(var h=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,x=l[0]&255|(l[1]&255)<<8|(l[2]&255)<<16|(l[3]&255)<<24,E=l[4]&255|(l[5]&255)<<8|(l[6]&255)<<16|(l[7]&255)<<24,U=l[8]&255|(l[9]&255)<<8|(l[10]&255)<<16|(l[11]&255)<<24,q=l[12]&255|(l[13]&255)<<8|(l[14]&255)<<16|(l[15]&255)<<24,ct=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,X=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,Ht=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,tt=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,xt=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,St=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,kt=l[16]&255|(l[17]&255)<<8|(l[18]&255)<<16|(l[19]&255)<<24,Bt=l[20]&255|(l[21]&255)<<8|(l[22]&255)<<16|(l[23]&255)<<24,Et=l[24]&255|(l[25]&255)<<8|(l[26]&255)<<16|(l[27]&255)<<24,At=l[28]&255|(l[29]&255)<<8|(l[30]&255)<<16|(l[31]&255)<<24,_t=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,rt=h,dt=x,Q=E,ot=U,at=q,Z=ct,k=X,I=Ht,O=tt,L=xt,P=St,z=kt,pt=Bt,It=Et,Ct=At,Rt=_t,p,Ft=0;Ft<20;Ft+=2)p=rt+pt|0,at^=p<<7|p>>>32-7,p=at+rt|0,O^=p<<9|p>>>32-9,p=O+at|0,pt^=p<<13|p>>>32-13,p=pt+O|0,rt^=p<<18|p>>>32-18,p=Z+dt|0,L^=p<<7|p>>>32-7,p=L+Z|0,It^=p<<9|p>>>32-9,p=It+L|0,dt^=p<<13|p>>>32-13,p=dt+It|0,Z^=p<<18|p>>>32-18,p=P+k|0,Ct^=p<<7|p>>>32-7,p=Ct+P|0,Q^=p<<9|p>>>32-9,p=Q+Ct|0,k^=p<<13|p>>>32-13,p=k+Q|0,P^=p<<18|p>>>32-18,p=Rt+z|0,ot^=p<<7|p>>>32-7,p=ot+Rt|0,I^=p<<9|p>>>32-9,p=I+ot|0,z^=p<<13|p>>>32-13,p=z+I|0,Rt^=p<<18|p>>>32-18,p=rt+ot|0,dt^=p<<7|p>>>32-7,p=dt+rt|0,Q^=p<<9|p>>>32-9,p=Q+dt|0,ot^=p<<13|p>>>32-13,p=ot+Q|0,rt^=p<<18|p>>>32-18,p=Z+at|0,k^=p<<7|p>>>32-7,p=k+Z|0,I^=p<<9|p>>>32-9,p=I+k|0,at^=p<<13|p>>>32-13,p=at+I|0,Z^=p<<18|p>>>32-18,p=P+L|0,z^=p<<7|p>>>32-7,p=z+P|0,O^=p<<9|p>>>32-9,p=O+z|0,L^=p<<13|p>>>32-13,p=L+O|0,P^=p<<18|p>>>32-18,p=Rt+Ct|0,pt^=p<<7|p>>>32-7,p=pt+Rt|0,It^=p<<9|p>>>32-9,p=It+pt|0,Ct^=p<<13|p>>>32-13,p=Ct+It|0,Rt^=p<<18|p>>>32-18;c[0]=rt>>>0&255,c[1]=rt>>>8&255,c[2]=rt>>>16&255,c[3]=rt>>>24&255,c[4]=Z>>>0&255,c[5]=Z>>>8&255,c[6]=Z>>>16&255,c[7]=Z>>>24&255,c[8]=P>>>0&255,c[9]=P>>>8&255,c[10]=P>>>16&255,c[11]=P>>>24&255,c[12]=Rt>>>0&255,c[13]=Rt>>>8&255,c[14]=Rt>>>16&255,c[15]=Rt>>>24&255,c[16]=k>>>0&255,c[17]=k>>>8&255,c[18]=k>>>16&255,c[19]=k>>>24&255,c[20]=I>>>0&255,c[21]=I>>>8&255,c[22]=I>>>16&255,c[23]=I>>>24&255,c[24]=O>>>0&255,c[25]=O>>>8&255,c[26]=O>>>16&255,c[27]=O>>>24&255,c[28]=L>>>0&255,c[29]=L>>>8&255,c[30]=L>>>16&255,c[31]=L>>>24&255}function H(c,d,l,a){F(c,d,l,a)}function et(c,d,l,a){R(c,d,l,a)}var j=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function G(c,d,l,a,h,x,E){var U=new Uint8Array(16),q=new Uint8Array(64),ct,X;for(X=0;X<16;X++)U[X]=0;for(X=0;X<8;X++)U[X]=x[X];for(;h>=64;){for(H(q,U,E,j),X=0;X<64;X++)c[d+X]=l[a+X]^q[X];for(ct=1,X=8;X<16;X++)ct=ct+(U[X]&255)|0,U[X]=ct&255,ct>>>=8;h-=64,d+=64,a+=64}if(h>0)for(H(q,U,E,j),X=0;X<h;X++)c[d+X]=l[a+X]^q[X];return 0}function it(c,d,l,a,h){var x=new Uint8Array(16),E=new Uint8Array(64),U,q;for(q=0;q<16;q++)x[q]=0;for(q=0;q<8;q++)x[q]=a[q];for(;l>=64;){for(H(E,x,h,j),q=0;q<64;q++)c[d+q]=E[q];for(U=1,q=8;q<16;q++)U=U+(x[q]&255)|0,x[q]=U&255,U>>>=8;l-=64,d+=64}if(l>0)for(H(E,x,h,j),q=0;q<l;q++)c[d+q]=E[q];return 0}function ut(c,d,l,a,h){var x=new Uint8Array(32);et(x,a,h,j);for(var E=new Uint8Array(8),U=0;U<8;U++)E[U]=a[U+16];return it(c,d,l,E,x)}function Zt(c,d,l,a,h,x,E){var U=new Uint8Array(32);et(U,x,E,j);for(var q=new Uint8Array(8),ct=0;ct<8;ct++)q[ct]=x[ct+16];return G(c,d,l,a,h,q,U)}var zt=function(c){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var d,l,a,h,x,E,U,q;d=c[0]&255|(c[1]&255)<<8,this.r[0]=d&8191,l=c[2]&255|(c[3]&255)<<8,this.r[1]=(d>>>13|l<<3)&8191,a=c[4]&255|(c[5]&255)<<8,this.r[2]=(l>>>10|a<<6)&7939,h=c[6]&255|(c[7]&255)<<8,this.r[3]=(a>>>7|h<<9)&8191,x=c[8]&255|(c[9]&255)<<8,this.r[4]=(h>>>4|x<<12)&255,this.r[5]=x>>>1&8190,E=c[10]&255|(c[11]&255)<<8,this.r[6]=(x>>>14|E<<2)&8191,U=c[12]&255|(c[13]&255)<<8,this.r[7]=(E>>>11|U<<5)&8065,q=c[14]&255|(c[15]&255)<<8,this.r[8]=(U>>>8|q<<8)&8191,this.r[9]=q>>>5&127,this.pad[0]=c[16]&255|(c[17]&255)<<8,this.pad[1]=c[18]&255|(c[19]&255)<<8,this.pad[2]=c[20]&255|(c[21]&255)<<8,this.pad[3]=c[22]&255|(c[23]&255)<<8,this.pad[4]=c[24]&255|(c[25]&255)<<8,this.pad[5]=c[26]&255|(c[27]&255)<<8,this.pad[6]=c[28]&255|(c[29]&255)<<8,this.pad[7]=c[30]&255|(c[31]&255)<<8};zt.prototype.blocks=function(c,d,l){for(var a=this.fin?0:2048,h,x,E,U,q,ct,X,Ht,tt,xt,St,kt,Bt,Et,At,_t,rt,dt,Q,ot=this.h[0],at=this.h[1],Z=this.h[2],k=this.h[3],I=this.h[4],O=this.h[5],L=this.h[6],P=this.h[7],z=this.h[8],pt=this.h[9],It=this.r[0],Ct=this.r[1],Rt=this.r[2],p=this.r[3],Ft=this.r[4],$t=this.r[5],jt=this.r[6],Ut=this.r[7],Kt=this.r[8],Dt=this.r[9];l>=16;)h=c[d+0]&255|(c[d+1]&255)<<8,ot+=h&8191,x=c[d+2]&255|(c[d+3]&255)<<8,at+=(h>>>13|x<<3)&8191,E=c[d+4]&255|(c[d+5]&255)<<8,Z+=(x>>>10|E<<6)&8191,U=c[d+6]&255|(c[d+7]&255)<<8,k+=(E>>>7|U<<9)&8191,q=c[d+8]&255|(c[d+9]&255)<<8,I+=(U>>>4|q<<12)&8191,O+=q>>>1&8191,ct=c[d+10]&255|(c[d+11]&255)<<8,L+=(q>>>14|ct<<2)&8191,X=c[d+12]&255|(c[d+13]&255)<<8,P+=(ct>>>11|X<<5)&8191,Ht=c[d+14]&255|(c[d+15]&255)<<8,z+=(X>>>8|Ht<<8)&8191,pt+=Ht>>>5|a,tt=0,xt=tt,xt+=ot*It,xt+=at*(5*Dt),xt+=Z*(5*Kt),xt+=k*(5*Ut),xt+=I*(5*jt),tt=xt>>>13,xt&=8191,xt+=O*(5*$t),xt+=L*(5*Ft),xt+=P*(5*p),xt+=z*(5*Rt),xt+=pt*(5*Ct),tt+=xt>>>13,xt&=8191,St=tt,St+=ot*Ct,St+=at*It,St+=Z*(5*Dt),St+=k*(5*Kt),St+=I*(5*Ut),tt=St>>>13,St&=8191,St+=O*(5*jt),St+=L*(5*$t),St+=P*(5*Ft),St+=z*(5*p),St+=pt*(5*Rt),tt+=St>>>13,St&=8191,kt=tt,kt+=ot*Rt,kt+=at*Ct,kt+=Z*It,kt+=k*(5*Dt),kt+=I*(5*Kt),tt=kt>>>13,kt&=8191,kt+=O*(5*Ut),kt+=L*(5*jt),kt+=P*(5*$t),kt+=z*(5*Ft),kt+=pt*(5*p),tt+=kt>>>13,kt&=8191,Bt=tt,Bt+=ot*p,Bt+=at*Rt,Bt+=Z*Ct,Bt+=k*It,Bt+=I*(5*Dt),tt=Bt>>>13,Bt&=8191,Bt+=O*(5*Kt),Bt+=L*(5*Ut),Bt+=P*(5*jt),Bt+=z*(5*$t),Bt+=pt*(5*Ft),tt+=Bt>>>13,Bt&=8191,Et=tt,Et+=ot*Ft,Et+=at*p,Et+=Z*Rt,Et+=k*Ct,Et+=I*It,tt=Et>>>13,Et&=8191,Et+=O*(5*Dt),Et+=L*(5*Kt),Et+=P*(5*Ut),Et+=z*(5*jt),Et+=pt*(5*$t),tt+=Et>>>13,Et&=8191,At=tt,At+=ot*$t,At+=at*Ft,At+=Z*p,At+=k*Rt,At+=I*Ct,tt=At>>>13,At&=8191,At+=O*It,At+=L*(5*Dt),At+=P*(5*Kt),At+=z*(5*Ut),At+=pt*(5*jt),tt+=At>>>13,At&=8191,_t=tt,_t+=ot*jt,_t+=at*$t,_t+=Z*Ft,_t+=k*p,_t+=I*Rt,tt=_t>>>13,_t&=8191,_t+=O*Ct,_t+=L*It,_t+=P*(5*Dt),_t+=z*(5*Kt),_t+=pt*(5*Ut),tt+=_t>>>13,_t&=8191,rt=tt,rt+=ot*Ut,rt+=at*jt,rt+=Z*$t,rt+=k*Ft,rt+=I*p,tt=rt>>>13,rt&=8191,rt+=O*Rt,rt+=L*Ct,rt+=P*It,rt+=z*(5*Dt),rt+=pt*(5*Kt),tt+=rt>>>13,rt&=8191,dt=tt,dt+=ot*Kt,dt+=at*Ut,dt+=Z*jt,dt+=k*$t,dt+=I*Ft,tt=dt>>>13,dt&=8191,dt+=O*p,dt+=L*Rt,dt+=P*Ct,dt+=z*It,dt+=pt*(5*Dt),tt+=dt>>>13,dt&=8191,Q=tt,Q+=ot*Dt,Q+=at*Kt,Q+=Z*Ut,Q+=k*jt,Q+=I*$t,tt=Q>>>13,Q&=8191,Q+=O*Ft,Q+=L*p,Q+=P*Rt,Q+=z*Ct,Q+=pt*It,tt+=Q>>>13,Q&=8191,tt=(tt<<2)+tt|0,tt=tt+xt|0,xt=tt&8191,tt=tt>>>13,St+=tt,ot=xt,at=St,Z=kt,k=Bt,I=Et,O=At,L=_t,P=rt,z=dt,pt=Q,d+=16,l-=16;this.h[0]=ot,this.h[1]=at,this.h[2]=Z,this.h[3]=k,this.h[4]=I,this.h[5]=O,this.h[6]=L,this.h[7]=P,this.h[8]=z,this.h[9]=pt},zt.prototype.finish=function(c,d){var l=new Uint16Array(10),a,h,x,E;if(this.leftover){for(E=this.leftover,this.buffer[E++]=1;E<16;E++)this.buffer[E]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(a=this.h[1]>>>13,this.h[1]&=8191,E=2;E<10;E++)this.h[E]+=a,a=this.h[E]>>>13,this.h[E]&=8191;for(this.h[0]+=a*5,a=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=a,a=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=a,l[0]=this.h[0]+5,a=l[0]>>>13,l[0]&=8191,E=1;E<10;E++)l[E]=this.h[E]+a,a=l[E]>>>13,l[E]&=8191;for(l[9]-=8192,h=(a^1)-1,E=0;E<10;E++)l[E]&=h;for(h=~h,E=0;E<10;E++)this.h[E]=this.h[E]&h|l[E];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,x=this.h[0]+this.pad[0],this.h[0]=x&65535,E=1;E<8;E++)x=(this.h[E]+this.pad[E]|0)+(x>>>16)|0,this.h[E]=x&65535;c[d+0]=this.h[0]>>>0&255,c[d+1]=this.h[0]>>>8&255,c[d+2]=this.h[1]>>>0&255,c[d+3]=this.h[1]>>>8&255,c[d+4]=this.h[2]>>>0&255,c[d+5]=this.h[2]>>>8&255,c[d+6]=this.h[3]>>>0&255,c[d+7]=this.h[3]>>>8&255,c[d+8]=this.h[4]>>>0&255,c[d+9]=this.h[4]>>>8&255,c[d+10]=this.h[5]>>>0&255,c[d+11]=this.h[5]>>>8&255,c[d+12]=this.h[6]>>>0&255,c[d+13]=this.h[6]>>>8&255,c[d+14]=this.h[7]>>>0&255,c[d+15]=this.h[7]>>>8&255},zt.prototype.update=function(c,d,l){var a,h;if(this.leftover){for(h=16-this.leftover,h>l&&(h=l),a=0;a<h;a++)this.buffer[this.leftover+a]=c[d+a];if(l-=h,d+=h,this.leftover+=h,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(l>=16&&(h=l-l%16,this.blocks(c,d,h),d+=h,l-=h),l){for(a=0;a<l;a++)this.buffer[this.leftover+a]=c[d+a];this.leftover+=l}};function Ot(c,d,l,a,h,x){var E=new zt(x);return E.update(l,a,h),E.finish(c,d),0}function oe(c,d,l,a,h,x){var E=new Uint8Array(16);return Ot(E,0,l,a,h,x),w(c,d,E,0)}function Y(c,d,l,a,h){var x;if(l<32)return-1;for(Zt(c,0,d,0,l,a,h),Ot(c,16,c,32,l-32,c),x=0;x<16;x++)c[x]=0;return 0}function st(c,d,l,a,h){var x,E=new Uint8Array(32);if(l<32||(ut(E,0,32,a,h),oe(d,16,d,32,l-32,E)!==0))return-1;for(Zt(c,0,d,0,l,a,h),x=0;x<32;x++)c[x]=0;return 0}function N(c,d){var l;for(l=0;l<16;l++)c[l]=d[l]|0}function C(c){var d,l,a=1;for(d=0;d<16;d++)l=c[d]+a+65535,a=Math.floor(l/65536),c[d]=l-a*65536;c[0]+=a-1+37*(a-1)}function K(c,d,l){for(var a,h=~(l-1),x=0;x<16;x++)a=h&(c[x]^d[x]),c[x]^=a,d[x]^=a}function J(c,d){var l,a,h,x=e(),E=e();for(l=0;l<16;l++)E[l]=d[l];for(C(E),C(E),C(E),a=0;a<2;a++){for(x[0]=E[0]-65517,l=1;l<15;l++)x[l]=E[l]-65535-(x[l-1]>>16&1),x[l-1]&=65535;x[15]=E[15]-32767-(x[14]>>16&1),h=x[15]>>16&1,x[14]&=65535,K(E,x,1-h)}for(l=0;l<16;l++)c[2*l]=E[l]&255,c[2*l+1]=E[l]>>8}function bt(c,d){var l=new Uint8Array(32),a=new Uint8Array(32);return J(l,c),J(a,d),T(l,0,a,0)}function mt(c){var d=new Uint8Array(32);return J(d,c),d[0]&1}function Tt(c,d){var l;for(l=0;l<16;l++)c[l]=d[2*l]+(d[2*l+1]<<8);c[15]&=32767}function vt(c,d,l){for(var a=0;a<16;a++)c[a]=d[a]+l[a]}function ht(c,d,l){for(var a=0;a<16;a++)c[a]=d[a]-l[a]}function nt(c,d,l){var a,h,x=0,E=0,U=0,q=0,ct=0,X=0,Ht=0,tt=0,xt=0,St=0,kt=0,Bt=0,Et=0,At=0,_t=0,rt=0,dt=0,Q=0,ot=0,at=0,Z=0,k=0,I=0,O=0,L=0,P=0,z=0,pt=0,It=0,Ct=0,Rt=0,p=l[0],Ft=l[1],$t=l[2],jt=l[3],Ut=l[4],Kt=l[5],Dt=l[6],ge=l[7],Gt=l[8],ae=l[9],ce=l[10],fe=l[11],be=l[12],ke=l[13],Ie=l[14],Re=l[15];a=d[0],x+=a*p,E+=a*Ft,U+=a*$t,q+=a*jt,ct+=a*Ut,X+=a*Kt,Ht+=a*Dt,tt+=a*ge,xt+=a*Gt,St+=a*ae,kt+=a*ce,Bt+=a*fe,Et+=a*be,At+=a*ke,_t+=a*Ie,rt+=a*Re,a=d[1],E+=a*p,U+=a*Ft,q+=a*$t,ct+=a*jt,X+=a*Ut,Ht+=a*Kt,tt+=a*Dt,xt+=a*ge,St+=a*Gt,kt+=a*ae,Bt+=a*ce,Et+=a*fe,At+=a*be,_t+=a*ke,rt+=a*Ie,dt+=a*Re,a=d[2],U+=a*p,q+=a*Ft,ct+=a*$t,X+=a*jt,Ht+=a*Ut,tt+=a*Kt,xt+=a*Dt,St+=a*ge,kt+=a*Gt,Bt+=a*ae,Et+=a*ce,At+=a*fe,_t+=a*be,rt+=a*ke,dt+=a*Ie,Q+=a*Re,a=d[3],q+=a*p,ct+=a*Ft,X+=a*$t,Ht+=a*jt,tt+=a*Ut,xt+=a*Kt,St+=a*Dt,kt+=a*ge,Bt+=a*Gt,Et+=a*ae,At+=a*ce,_t+=a*fe,rt+=a*be,dt+=a*ke,Q+=a*Ie,ot+=a*Re,a=d[4],ct+=a*p,X+=a*Ft,Ht+=a*$t,tt+=a*jt,xt+=a*Ut,St+=a*Kt,kt+=a*Dt,Bt+=a*ge,Et+=a*Gt,At+=a*ae,_t+=a*ce,rt+=a*fe,dt+=a*be,Q+=a*ke,ot+=a*Ie,at+=a*Re,a=d[5],X+=a*p,Ht+=a*Ft,tt+=a*$t,xt+=a*jt,St+=a*Ut,kt+=a*Kt,Bt+=a*Dt,Et+=a*ge,At+=a*Gt,_t+=a*ae,rt+=a*ce,dt+=a*fe,Q+=a*be,ot+=a*ke,at+=a*Ie,Z+=a*Re,a=d[6],Ht+=a*p,tt+=a*Ft,xt+=a*$t,St+=a*jt,kt+=a*Ut,Bt+=a*Kt,Et+=a*Dt,At+=a*ge,_t+=a*Gt,rt+=a*ae,dt+=a*ce,Q+=a*fe,ot+=a*be,at+=a*ke,Z+=a*Ie,k+=a*Re,a=d[7],tt+=a*p,xt+=a*Ft,St+=a*$t,kt+=a*jt,Bt+=a*Ut,Et+=a*Kt,At+=a*Dt,_t+=a*ge,rt+=a*Gt,dt+=a*ae,Q+=a*ce,ot+=a*fe,at+=a*be,Z+=a*ke,k+=a*Ie,I+=a*Re,a=d[8],xt+=a*p,St+=a*Ft,kt+=a*$t,Bt+=a*jt,Et+=a*Ut,At+=a*Kt,_t+=a*Dt,rt+=a*ge,dt+=a*Gt,Q+=a*ae,ot+=a*ce,at+=a*fe,Z+=a*be,k+=a*ke,I+=a*Ie,O+=a*Re,a=d[9],St+=a*p,kt+=a*Ft,Bt+=a*$t,Et+=a*jt,At+=a*Ut,_t+=a*Kt,rt+=a*Dt,dt+=a*ge,Q+=a*Gt,ot+=a*ae,at+=a*ce,Z+=a*fe,k+=a*be,I+=a*ke,O+=a*Ie,L+=a*Re,a=d[10],kt+=a*p,Bt+=a*Ft,Et+=a*$t,At+=a*jt,_t+=a*Ut,rt+=a*Kt,dt+=a*Dt,Q+=a*ge,ot+=a*Gt,at+=a*ae,Z+=a*ce,k+=a*fe,I+=a*be,O+=a*ke,L+=a*Ie,P+=a*Re,a=d[11],Bt+=a*p,Et+=a*Ft,At+=a*$t,_t+=a*jt,rt+=a*Ut,dt+=a*Kt,Q+=a*Dt,ot+=a*ge,at+=a*Gt,Z+=a*ae,k+=a*ce,I+=a*fe,O+=a*be,L+=a*ke,P+=a*Ie,z+=a*Re,a=d[12],Et+=a*p,At+=a*Ft,_t+=a*$t,rt+=a*jt,dt+=a*Ut,Q+=a*Kt,ot+=a*Dt,at+=a*ge,Z+=a*Gt,k+=a*ae,I+=a*ce,O+=a*fe,L+=a*be,P+=a*ke,z+=a*Ie,pt+=a*Re,a=d[13],At+=a*p,_t+=a*Ft,rt+=a*$t,dt+=a*jt,Q+=a*Ut,ot+=a*Kt,at+=a*Dt,Z+=a*ge,k+=a*Gt,I+=a*ae,O+=a*ce,L+=a*fe,P+=a*be,z+=a*ke,pt+=a*Ie,It+=a*Re,a=d[14],_t+=a*p,rt+=a*Ft,dt+=a*$t,Q+=a*jt,ot+=a*Ut,at+=a*Kt,Z+=a*Dt,k+=a*ge,I+=a*Gt,O+=a*ae,L+=a*ce,P+=a*fe,z+=a*be,pt+=a*ke,It+=a*Ie,Ct+=a*Re,a=d[15],rt+=a*p,dt+=a*Ft,Q+=a*$t,ot+=a*jt,at+=a*Ut,Z+=a*Kt,k+=a*Dt,I+=a*ge,O+=a*Gt,L+=a*ae,P+=a*ce,z+=a*fe,pt+=a*be,It+=a*ke,Ct+=a*Ie,Rt+=a*Re,x+=38*dt,E+=38*Q,U+=38*ot,q+=38*at,ct+=38*Z,X+=38*k,Ht+=38*I,tt+=38*O,xt+=38*L,St+=38*P,kt+=38*z,Bt+=38*pt,Et+=38*It,At+=38*Ct,_t+=38*Rt,h=1,a=x+h+65535,h=Math.floor(a/65536),x=a-h*65536,a=E+h+65535,h=Math.floor(a/65536),E=a-h*65536,a=U+h+65535,h=Math.floor(a/65536),U=a-h*65536,a=q+h+65535,h=Math.floor(a/65536),q=a-h*65536,a=ct+h+65535,h=Math.floor(a/65536),ct=a-h*65536,a=X+h+65535,h=Math.floor(a/65536),X=a-h*65536,a=Ht+h+65535,h=Math.floor(a/65536),Ht=a-h*65536,a=tt+h+65535,h=Math.floor(a/65536),tt=a-h*65536,a=xt+h+65535,h=Math.floor(a/65536),xt=a-h*65536,a=St+h+65535,h=Math.floor(a/65536),St=a-h*65536,a=kt+h+65535,h=Math.floor(a/65536),kt=a-h*65536,a=Bt+h+65535,h=Math.floor(a/65536),Bt=a-h*65536,a=Et+h+65535,h=Math.floor(a/65536),Et=a-h*65536,a=At+h+65535,h=Math.floor(a/65536),At=a-h*65536,a=_t+h+65535,h=Math.floor(a/65536),_t=a-h*65536,a=rt+h+65535,h=Math.floor(a/65536),rt=a-h*65536,x+=h-1+37*(h-1),h=1,a=x+h+65535,h=Math.floor(a/65536),x=a-h*65536,a=E+h+65535,h=Math.floor(a/65536),E=a-h*65536,a=U+h+65535,h=Math.floor(a/65536),U=a-h*65536,a=q+h+65535,h=Math.floor(a/65536),q=a-h*65536,a=ct+h+65535,h=Math.floor(a/65536),ct=a-h*65536,a=X+h+65535,h=Math.floor(a/65536),X=a-h*65536,a=Ht+h+65535,h=Math.floor(a/65536),Ht=a-h*65536,a=tt+h+65535,h=Math.floor(a/65536),tt=a-h*65536,a=xt+h+65535,h=Math.floor(a/65536),xt=a-h*65536,a=St+h+65535,h=Math.floor(a/65536),St=a-h*65536,a=kt+h+65535,h=Math.floor(a/65536),kt=a-h*65536,a=Bt+h+65535,h=Math.floor(a/65536),Bt=a-h*65536,a=Et+h+65535,h=Math.floor(a/65536),Et=a-h*65536,a=At+h+65535,h=Math.floor(a/65536),At=a-h*65536,a=_t+h+65535,h=Math.floor(a/65536),_t=a-h*65536,a=rt+h+65535,h=Math.floor(a/65536),rt=a-h*65536,x+=h-1+37*(h-1),c[0]=x,c[1]=E,c[2]=U,c[3]=q,c[4]=ct,c[5]=X,c[6]=Ht,c[7]=tt,c[8]=xt,c[9]=St,c[10]=kt,c[11]=Bt,c[12]=Et,c[13]=At,c[14]=_t,c[15]=rt}function Mt(c,d){nt(c,d,d)}function le(c,d){var l=e(),a;for(a=0;a<16;a++)l[a]=d[a];for(a=253;a>=0;a--)Mt(l,l),a!==2&&a!==4&&nt(l,l,d);for(a=0;a<16;a++)c[a]=l[a]}function de(c,d){var l=e(),a;for(a=0;a<16;a++)l[a]=d[a];for(a=250;a>=0;a--)Mt(l,l),a!==1&&nt(l,l,d);for(a=0;a<16;a++)c[a]=l[a]}function ie(c,d,l){var a=new Uint8Array(32),h=new Float64Array(80),x,E,U=e(),q=e(),ct=e(),X=e(),Ht=e(),tt=e();for(E=0;E<31;E++)a[E]=d[E];for(a[31]=d[31]&127|64,a[0]&=248,Tt(h,l),E=0;E<16;E++)q[E]=h[E],X[E]=U[E]=ct[E]=0;for(U[0]=X[0]=1,E=254;E>=0;--E)x=a[E>>>3]>>>(E&7)&1,K(U,q,x),K(ct,X,x),vt(Ht,U,ct),ht(U,U,ct),vt(ct,q,X),ht(q,q,X),Mt(X,Ht),Mt(tt,U),nt(U,ct,U),nt(ct,q,Ht),vt(Ht,U,ct),ht(U,U,ct),Mt(q,U),ht(ct,X,tt),nt(U,ct,u),vt(U,U,X),nt(ct,ct,U),nt(U,X,tt),nt(X,q,h),Mt(q,Ht),K(U,q,x),K(ct,X,x);for(E=0;E<16;E++)h[E+16]=U[E],h[E+32]=ct[E],h[E+48]=q[E],h[E+64]=X[E];var xt=h.subarray(32),St=h.subarray(16);return le(xt,xt),nt(St,St,xt),J(c,St),0}function he(c,d){return ie(c,d,o)}function Se(c,d){return n(d,32),he(c,d)}function ye(c,d,l){var a=new Uint8Array(32);return ie(a,l,d),et(c,s,a,j)}var ze=Y,Qe=st;function Ye(c,d,l,a,h,x){var E=new Uint8Array(32);return ye(E,h,x),ze(c,d,l,a,E)}function xs(c,d,l,a,h,x){var E=new Uint8Array(32);return ye(E,h,x),Qe(c,d,l,a,E)}var Mr=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Fr(c,d,l,a){for(var h=new Int32Array(16),x=new Int32Array(16),E,U,q,ct,X,Ht,tt,xt,St,kt,Bt,Et,At,_t,rt,dt,Q,ot,at,Z,k,I,O,L,P,z,pt=c[0],It=c[1],Ct=c[2],Rt=c[3],p=c[4],Ft=c[5],$t=c[6],jt=c[7],Ut=d[0],Kt=d[1],Dt=d[2],ge=d[3],Gt=d[4],ae=d[5],ce=d[6],fe=d[7],be=0;a>=128;){for(at=0;at<16;at++)Z=8*at+be,h[at]=l[Z+0]<<24|l[Z+1]<<16|l[Z+2]<<8|l[Z+3],x[at]=l[Z+4]<<24|l[Z+5]<<16|l[Z+6]<<8|l[Z+7];for(at=0;at<80;at++)if(E=pt,U=It,q=Ct,ct=Rt,X=p,Ht=Ft,tt=$t,xt=jt,St=Ut,kt=Kt,Bt=Dt,Et=ge,At=Gt,_t=ae,rt=ce,dt=fe,k=jt,I=fe,O=I&65535,L=I>>>16,P=k&65535,z=k>>>16,k=(p>>>14|Gt<<32-14)^(p>>>18|Gt<<32-18)^(Gt>>>41-32|p<<32-(41-32)),I=(Gt>>>14|p<<32-14)^(Gt>>>18|p<<32-18)^(p>>>41-32|Gt<<32-(41-32)),O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,k=p&Ft^~p&$t,I=Gt&ae^~Gt&ce,O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,k=Mr[at*2],I=Mr[at*2+1],O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,k=h[at%16],I=x[at%16],O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,L+=O>>>16,P+=L>>>16,z+=P>>>16,Q=P&65535|z<<16,ot=O&65535|L<<16,k=Q,I=ot,O=I&65535,L=I>>>16,P=k&65535,z=k>>>16,k=(pt>>>28|Ut<<32-28)^(Ut>>>34-32|pt<<32-(34-32))^(Ut>>>39-32|pt<<32-(39-32)),I=(Ut>>>28|pt<<32-28)^(pt>>>34-32|Ut<<32-(34-32))^(pt>>>39-32|Ut<<32-(39-32)),O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,k=pt&It^pt&Ct^It&Ct,I=Ut&Kt^Ut&Dt^Kt&Dt,O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,L+=O>>>16,P+=L>>>16,z+=P>>>16,xt=P&65535|z<<16,dt=O&65535|L<<16,k=ct,I=Et,O=I&65535,L=I>>>16,P=k&65535,z=k>>>16,k=Q,I=ot,O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,L+=O>>>16,P+=L>>>16,z+=P>>>16,ct=P&65535|z<<16,Et=O&65535|L<<16,It=E,Ct=U,Rt=q,p=ct,Ft=X,$t=Ht,jt=tt,pt=xt,Kt=St,Dt=kt,ge=Bt,Gt=Et,ae=At,ce=_t,fe=rt,Ut=dt,at%16===15)for(Z=0;Z<16;Z++)k=h[Z],I=x[Z],O=I&65535,L=I>>>16,P=k&65535,z=k>>>16,k=h[(Z+9)%16],I=x[(Z+9)%16],O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,Q=h[(Z+1)%16],ot=x[(Z+1)%16],k=(Q>>>1|ot<<32-1)^(Q>>>8|ot<<32-8)^Q>>>7,I=(ot>>>1|Q<<32-1)^(ot>>>8|Q<<32-8)^(ot>>>7|Q<<32-7),O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,Q=h[(Z+14)%16],ot=x[(Z+14)%16],k=(Q>>>19|ot<<32-19)^(ot>>>61-32|Q<<32-(61-32))^Q>>>6,I=(ot>>>19|Q<<32-19)^(Q>>>61-32|ot<<32-(61-32))^(ot>>>6|Q<<32-6),O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,L+=O>>>16,P+=L>>>16,z+=P>>>16,h[Z]=P&65535|z<<16,x[Z]=O&65535|L<<16;k=pt,I=Ut,O=I&65535,L=I>>>16,P=k&65535,z=k>>>16,k=c[0],I=d[0],O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,L+=O>>>16,P+=L>>>16,z+=P>>>16,c[0]=pt=P&65535|z<<16,d[0]=Ut=O&65535|L<<16,k=It,I=Kt,O=I&65535,L=I>>>16,P=k&65535,z=k>>>16,k=c[1],I=d[1],O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,L+=O>>>16,P+=L>>>16,z+=P>>>16,c[1]=It=P&65535|z<<16,d[1]=Kt=O&65535|L<<16,k=Ct,I=Dt,O=I&65535,L=I>>>16,P=k&65535,z=k>>>16,k=c[2],I=d[2],O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,L+=O>>>16,P+=L>>>16,z+=P>>>16,c[2]=Ct=P&65535|z<<16,d[2]=Dt=O&65535|L<<16,k=Rt,I=ge,O=I&65535,L=I>>>16,P=k&65535,z=k>>>16,k=c[3],I=d[3],O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,L+=O>>>16,P+=L>>>16,z+=P>>>16,c[3]=Rt=P&65535|z<<16,d[3]=ge=O&65535|L<<16,k=p,I=Gt,O=I&65535,L=I>>>16,P=k&65535,z=k>>>16,k=c[4],I=d[4],O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,L+=O>>>16,P+=L>>>16,z+=P>>>16,c[4]=p=P&65535|z<<16,d[4]=Gt=O&65535|L<<16,k=Ft,I=ae,O=I&65535,L=I>>>16,P=k&65535,z=k>>>16,k=c[5],I=d[5],O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,L+=O>>>16,P+=L>>>16,z+=P>>>16,c[5]=Ft=P&65535|z<<16,d[5]=ae=O&65535|L<<16,k=$t,I=ce,O=I&65535,L=I>>>16,P=k&65535,z=k>>>16,k=c[6],I=d[6],O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,L+=O>>>16,P+=L>>>16,z+=P>>>16,c[6]=$t=P&65535|z<<16,d[6]=ce=O&65535|L<<16,k=jt,I=fe,O=I&65535,L=I>>>16,P=k&65535,z=k>>>16,k=c[7],I=d[7],O+=I&65535,L+=I>>>16,P+=k&65535,z+=k>>>16,L+=O>>>16,P+=L>>>16,z+=P>>>16,c[7]=jt=P&65535|z<<16,d[7]=fe=O&65535|L<<16,be+=128,a-=128}return a}function fn(c,d,l){var a=new Int32Array(8),h=new Int32Array(8),x=new Uint8Array(256),E,U=l;for(a[0]=1779033703,a[1]=3144134277,a[2]=1013904242,a[3]=2773480762,a[4]=1359893119,a[5]=2600822924,a[6]=528734635,a[7]=1541459225,h[0]=4089235720,h[1]=2227873595,h[2]=4271175723,h[3]=1595750129,h[4]=2917565137,h[5]=725511199,h[6]=4215389547,h[7]=327033209,Fr(a,h,d,l),l%=128,E=0;E<l;E++)x[E]=d[U-l+E];for(x[l]=128,l=256-128*(l<112?1:0),x[l-9]=0,A(x,l-8,U/536870912|0,U<<3),Fr(a,h,x,l),E=0;E<8;E++)A(c,8*E,a[E],h[E]);return 0}function Tn(c,d){var l=e(),a=e(),h=e(),x=e(),E=e(),U=e(),q=e(),ct=e(),X=e();ht(l,c[1],c[0]),ht(X,d[1],d[0]),nt(l,l,X),vt(a,c[0],c[1]),vt(X,d[0],d[1]),nt(a,a,X),nt(h,c[3],d[3]),nt(h,h,y),nt(x,c[2],d[2]),vt(x,x,x),ht(E,a,l),ht(U,x,h),vt(q,x,h),vt(ct,a,l),nt(c[0],E,U),nt(c[1],ct,q),nt(c[2],q,U),nt(c[3],E,ct)}function yr(c,d,l){var a;for(a=0;a<4;a++)K(c[a],d[a],l)}function bn(c,d){var l=e(),a=e(),h=e();le(h,d[2]),nt(l,d[0],h),nt(a,d[1],h),J(c,a),c[31]^=mt(l)<<7}function Vn(c,d,l){var a,h;for(N(c[0],i),N(c[1],f),N(c[2],f),N(c[3],i),h=255;h>=0;--h)a=l[h/8|0]>>(h&7)&1,yr(c,d,a),Tn(d,c),Tn(c,c),yr(c,d,a)}function Cn(c,d){var l=[e(),e(),e(),e()];N(l[0],v),N(l[1],S),N(l[2],f),nt(l[3],v,S),Vn(c,l,d)}function Gn(c,d,l){var a=new Uint8Array(64),h=[e(),e(),e(),e()],x;for(l||n(d,32),fn(a,d,32),a[0]&=248,a[31]&=127,a[31]|=64,Cn(h,a),bn(c,h),x=0;x<32;x++)d[x+32]=c[x];return 0}var Ln=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Yn(c,d){var l,a,h,x;for(a=63;a>=32;--a){for(l=0,h=a-32,x=a-12;h<x;++h)d[h]+=l-16*d[a]*Ln[h-(a-32)],l=Math.floor((d[h]+128)/256),d[h]-=l*256;d[h]+=l,d[a]=0}for(l=0,h=0;h<32;h++)d[h]+=l-(d[31]>>4)*Ln[h],l=d[h]>>8,d[h]&=255;for(h=0;h<32;h++)d[h]-=l*Ln[h];for(a=0;a<32;a++)d[a+1]+=d[a]>>8,c[a]=d[a]&255}function wr(c){var d=new Float64Array(64),l;for(l=0;l<64;l++)d[l]=c[l];for(l=0;l<64;l++)c[l]=0;Yn(c,d)}function zr(c,d,l,a){var h=new Uint8Array(64),x=new Uint8Array(64),E=new Uint8Array(64),U,q,ct=new Float64Array(64),X=[e(),e(),e(),e()];fn(h,a,32),h[0]&=248,h[31]&=127,h[31]|=64;var Ht=l+64;for(U=0;U<l;U++)c[64+U]=d[U];for(U=0;U<32;U++)c[32+U]=h[32+U];for(fn(E,c.subarray(32),l+32),wr(E),Cn(X,E),bn(c,X),U=32;U<64;U++)c[U]=a[U];for(fn(x,c,l+64),wr(x),U=0;U<64;U++)ct[U]=0;for(U=0;U<32;U++)ct[U]=E[U];for(U=0;U<32;U++)for(q=0;q<32;q++)ct[U+q]+=x[U]*h[q];return Yn(c.subarray(32),ct),Ht}function vs(c,d){var l=e(),a=e(),h=e(),x=e(),E=e(),U=e(),q=e();return N(c[2],f),Tt(c[1],d),Mt(h,c[1]),nt(x,h,g),ht(h,h,c[2]),vt(x,c[2],x),Mt(E,x),Mt(U,E),nt(q,U,E),nt(l,q,h),nt(l,l,x),de(l,l),nt(l,l,h),nt(l,l,x),nt(l,l,x),nt(c[0],l,x),Mt(a,c[0]),nt(a,a,x),bt(a,h)&&nt(c[0],c[0],b),Mt(a,c[0]),nt(a,a,x),bt(a,h)?-1:(mt(c[0])===d[31]>>7&&ht(c[0],i,c[0]),nt(c[3],c[0],c[1]),0)}function br(c,d,l,a){var h,x=new Uint8Array(32),E=new Uint8Array(64),U=[e(),e(),e(),e()],q=[e(),e(),e(),e()];if(l<64||vs(q,a))return-1;for(h=0;h<l;h++)c[h]=d[h];for(h=0;h<32;h++)c[h+32]=a[h];if(fn(E,c,l),wr(E),Vn(U,q,E),Cn(q,d.subarray(32)),Tn(U,q),bn(x,U),l-=64,T(d,0,x,0)){for(h=0;h<l;h++)c[h]=0;return-1}for(h=0;h<l;h++)c[h]=d[h+64];return l}var Ss=32,qr=24,mr=32,Zn=16,xr=32,Kr=32,vr=32,Sr=32,Es=32,To=qr,La=mr,Ua=Zn,un=64,Un=32,Jn=64,_s=32,As=64;t.lowlevel={crypto_core_hsalsa20:et,crypto_stream_xor:Zt,crypto_stream:ut,crypto_stream_salsa20_xor:G,crypto_stream_salsa20:it,crypto_onetimeauth:Ot,crypto_onetimeauth_verify:oe,crypto_verify_16:w,crypto_verify_32:T,crypto_secretbox:Y,crypto_secretbox_open:st,crypto_scalarmult:ie,crypto_scalarmult_base:he,crypto_box_beforenm:ye,crypto_box_afternm:ze,crypto_box:Ye,crypto_box_open:xs,crypto_box_keypair:Se,crypto_hash:fn,crypto_sign:zr,crypto_sign_keypair:Gn,crypto_sign_open:br,crypto_secretbox_KEYBYTES:Ss,crypto_secretbox_NONCEBYTES:qr,crypto_secretbox_ZEROBYTES:mr,crypto_secretbox_BOXZEROBYTES:Zn,crypto_scalarmult_BYTES:xr,crypto_scalarmult_SCALARBYTES:Kr,crypto_box_PUBLICKEYBYTES:vr,crypto_box_SECRETKEYBYTES:Sr,crypto_box_BEFORENMBYTES:Es,crypto_box_NONCEBYTES:To,crypto_box_ZEROBYTES:La,crypto_box_BOXZEROBYTES:Ua,crypto_sign_BYTES:un,crypto_sign_PUBLICKEYBYTES:Un,crypto_sign_SECRETKEYBYTES:Jn,crypto_sign_SEEDBYTES:_s,crypto_hash_BYTES:As,gf:e,D:g,L:Ln,pack:bn,pack25519:J,unpack25519:Tt,M:nt,A:vt,S:Mt,Z:ht,pow2523:de,add:Tn,set25519:N,modL:Yn,scalarmult:Vn,scalarbase:Cn};function Co(c,d){if(c.length!==Ss)throw new Error("bad key size");if(d.length!==qr)throw new Error("bad nonce size")}function Pa(c,d){if(c.length!==vr)throw new Error("bad public key size");if(d.length!==Sr)throw new Error("bad secret key size")}function qe(){for(var c=0;c<arguments.length;c++)if(!(arguments[c]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Lo(c){for(var d=0;d<c.length;d++)c[d]=0}t.randomBytes=function(c){var d=new Uint8Array(c);return n(d,c),d},t.secretbox=function(c,d,l){qe(c,d,l),Co(l,d);for(var a=new Uint8Array(mr+c.length),h=new Uint8Array(a.length),x=0;x<c.length;x++)a[x+mr]=c[x];return Y(h,a,a.length,d,l),h.subarray(Zn)},t.secretbox.open=function(c,d,l){qe(c,d,l),Co(l,d);for(var a=new Uint8Array(Zn+c.length),h=new Uint8Array(a.length),x=0;x<c.length;x++)a[x+Zn]=c[x];return a.length<32||st(h,a,a.length,d,l)!==0?null:h.subarray(mr)},t.secretbox.keyLength=Ss,t.secretbox.nonceLength=qr,t.secretbox.overheadLength=Zn,t.scalarMult=function(c,d){if(qe(c,d),c.length!==Kr)throw new Error("bad n size");if(d.length!==xr)throw new Error("bad p size");var l=new Uint8Array(xr);return ie(l,c,d),l},t.scalarMult.base=function(c){if(qe(c),c.length!==Kr)throw new Error("bad n size");var d=new Uint8Array(xr);return he(d,c),d},t.scalarMult.scalarLength=Kr,t.scalarMult.groupElementLength=xr,t.box=function(c,d,l,a){var h=t.box.before(l,a);return t.secretbox(c,d,h)},t.box.before=function(c,d){qe(c,d),Pa(c,d);var l=new Uint8Array(Es);return ye(l,c,d),l},t.box.after=t.secretbox,t.box.open=function(c,d,l,a){var h=t.box.before(l,a);return t.secretbox.open(c,d,h)},t.box.open.after=t.secretbox.open,t.box.keyPair=function(){var c=new Uint8Array(vr),d=new Uint8Array(Sr);return Se(c,d),{publicKey:c,secretKey:d}},t.box.keyPair.fromSecretKey=function(c){if(qe(c),c.length!==Sr)throw new Error("bad secret key size");var d=new Uint8Array(vr);return he(d,c),{publicKey:d,secretKey:new Uint8Array(c)}},t.box.publicKeyLength=vr,t.box.secretKeyLength=Sr,t.box.sharedKeyLength=Es,t.box.nonceLength=To,t.box.overheadLength=t.secretbox.overheadLength,t.sign=function(c,d){if(qe(c,d),d.length!==Jn)throw new Error("bad secret key size");var l=new Uint8Array(un+c.length);return zr(l,c,c.length,d),l},t.sign.open=function(c,d){if(qe(c,d),d.length!==Un)throw new Error("bad public key size");var l=new Uint8Array(c.length),a=br(l,c,c.length,d);if(a<0)return null;for(var h=new Uint8Array(a),x=0;x<h.length;x++)h[x]=l[x];return h},t.sign.detached=function(c,d){for(var l=t.sign(c,d),a=new Uint8Array(un),h=0;h<a.length;h++)a[h]=l[h];return a},t.sign.detached.verify=function(c,d,l){if(qe(c,d,l),d.length!==un)throw new Error("bad signature size");if(l.length!==Un)throw new Error("bad public key size");var a=new Uint8Array(un+c.length),h=new Uint8Array(un+c.length),x;for(x=0;x<un;x++)a[x]=d[x];for(x=0;x<c.length;x++)a[x+un]=c[x];return br(h,a,a.length,l)>=0},t.sign.keyPair=function(){var c=new Uint8Array(Un),d=new Uint8Array(Jn);return Gn(c,d),{publicKey:c,secretKey:d}},t.sign.keyPair.fromSecretKey=function(c){if(qe(c),c.length!==Jn)throw new Error("bad secret key size");for(var d=new Uint8Array(Un),l=0;l<d.length;l++)d[l]=c[32+l];return{publicKey:d,secretKey:new Uint8Array(c)}},t.sign.keyPair.fromSeed=function(c){if(qe(c),c.length!==_s)throw new Error("bad seed size");for(var d=new Uint8Array(Un),l=new Uint8Array(Jn),a=0;a<32;a++)l[a]=c[a];return Gn(d,l,!0),{publicKey:d,secretKey:l}},t.sign.publicKeyLength=Un,t.sign.secretKeyLength=Jn,t.sign.seedLength=_s,t.sign.signatureLength=un,t.hash=function(c){qe(c);var d=new Uint8Array(As);return fn(d,c,c.length),d},t.hash.hashLength=As,t.verify=function(c,d){return qe(c,d),c.length===0||d.length===0||c.length!==d.length?!1:m(c,0,d,0,c.length)===0},t.setPRNG=function(c){n=c},function(){var c=typeof self<"u"?self.crypto||self.msCrypto:null;if(c&&c.getRandomValues){var d=65536;t.setPRNG(function(l,a){var h,x=new Uint8Array(a);for(h=0;h<a;h+=d)c.getRandomValues(x.subarray(h,h+Math.min(a-h,d)));for(h=0;h<a;h++)l[h]=x[h];Lo(x)})}else typeof Wa<"u"&&(c=Fa,c&&c.randomBytes&&t.setPRNG(function(l,a){var h,x=c.randomBytes(a);for(h=0;h<a;h++)l[h]=x[h];Lo(x)}))}()})(r.exports?r.exports:self.nacl=self.nacl||{})})(Ba);var od=Ba.exports;const ka=is(od),Pn=ka.lowlevel;function id(r){let t;typeof r=="string"?t=Buffer.from(r,"hex"):t=r;const e=new Uint8Array(64),n=[Pn.gf(),Pn.gf(),Pn.gf(),Pn.gf()],s=new Uint8Array([...new Uint8Array(t),...new Uint8Array(32)]),o=new Uint8Array(32);Pn.crypto_hash(e,s,32),e[0]&=248,e[31]&=127,e[31]|=64,Pn.scalarbase(n,e),Pn.pack(o,n);for(let i=0;i<32;i+=1)s[i+32]=o[i];return{sk:Buffer.from(s),pk:Buffer.from(o)}}function ad(r){return(t,e,n,s)=>t.method==="solana_chainId"?(e.result=r,s()):n()}function cd(r){return(t,e,n,s)=>t.method==="solana_provider_config"?(e.result=r,s()):n()}function Ia(r){const{chainId:t}=r;return Cr([ad(t),cd(r)])}function fd(r){const{rpcTarget:t}=r,e=qa({rpcTarget:t});return{networkMiddleware:Cr([Ia(r),e]),fetchMiddleware:e}}function ud(r){let{getAccounts:t}=r;return os(async(e,n,s)=>{const{method:o}=e;if(o!=="getAccounts")return s();if(!t)throw new Error("WalletMiddleware - opts.getAccounts not provided");const i=await t(e);n.result=i})}function ld(r){let{requestAccounts:t}=r;return os(async(e,n,s)=>{const{method:o}=e;if(o!=="requestAccounts")return s();if(!t)throw new Error("WalletMiddleware - opts.requestAccounts not provided");const i=await t(e);n.result=i})}function nn(r,t){return os(async(e,n,s)=>{const{method:o}=e;if(o!==r)return s();if(!t)throw new Error(`WalletMiddleware - ${r} not provided`);const i=await t(e);n.result=i})}function ko(r){const{getAccounts:t,requestAccounts:e,signTransaction:n,signAndSendTransaction:s,signAllTransactions:o,signMessage:i,getPrivateKey:f,getSecretKey:u}=r;return Cr([ld({requestAccounts:e}),ud({getAccounts:t}),nn("signTransaction",n),nn("signAndSendTransaction",s),nn("signAllTransactions",o),nn("signMessage",i),nn("solanaPrivateKey",f),nn("private_key",f),nn("solanaSecretKey",u)])}function dd(r){let{addNewChainConfig:t,switchSolanaChain:e}=r;return Cr([nn("addSolanaChain",t),nn("switchSolanaChain",e)])}function hd(r){let{updatePrivatekey:t}=r;return Cr([nn("updateAccount",t)])}class Io extends so{constructor(t){let{config:e,state:n}=t;super({config:{chainConfig:An(An({},e.chainConfig),{},{chainNamespace:Gr.SOLANA})},state:n})}async switchChain(t){throw za.unsupportedOperation("Chain switching is not supported by this adapter")}async setupProvider(t){const e=new no,n=this.getProviderHandlers(t),s=ko(n);e.push(s);const o=Ia(this.config.chainConfig);e.push(o);const i=this.getInjectedProviderProxy(t);i&&e.push(i);const f=ro(e);this.updateProviderEngineProxy(f),await this.lookupNetwork()}async lookupNetwork(){const{chainConfig:t}=this.config;return this.update({chainId:t.chainId}),t.chainId||""}getInjectedProviderProxy(t){}}const Ra=r=>({requestAccounts:async()=>r.publicKey?[en.encode(r.publicKey.toBytes())]:[],getAccounts:async()=>r.publicKey?[en.encode(r.publicKey.toBytes())]:[],getPrivateKey:async()=>{throw Xt.methodNotSupported()},getSecretKey:async()=>{throw Xt.methodNotSupported()},signTransaction:async e=>await r.signTransaction(e.params.message),signMessage:async e=>(await r.signMessage(e.params.message,e.params.display)).signature,signAllTransactions:async e=>{var n,s;if(!((n=e.params)!==null&&n!==void 0&&n.message)||!((s=e.params)!==null&&s!==void 0&&s.message.length))throw Xt.invalidParams("message");return await r.signAllTransactions(e.params.message)},signAndSendTransaction:async e=>({signature:(await r.signAndSendTransaction(e.params.message)).signature})});function Ta(r){return os(async(t,e,n)=>{const s=await r.request(t);e.result=s})}class gd extends Io{getProviderHandlers(t){return Ra(t)}getInjectedProviderProxy(t){return Ta(t)}}const $s=r=>r.version!==void 0||r instanceof sr,pd=(r,t)=>({requestAccounts:async()=>{const{data:n}=await r.connect();return[n.publicKey]},getAccounts:async()=>{const{data:n}=await r.connect();return[n.publicKey]},getPrivateKey:async()=>{throw Xt.methodNotSupported()},getSecretKey:async()=>{throw Xt.methodNotSupported()},signTransaction:async n=>{const s=n.params.message;if(!s)throw Xt.invalidRequest({message:"Invalid transaction message"});const o=$s(s)?s.message.serialize():s.serializeMessage(),{data:i}=await r.signTransaction(en.encode(o));if(!i.publicKey||!i.signature)throw new Error("Invalid signature from slope wallet");const f=new wt(i.publicKey),u=en.decode(i.signature);return s.addSignature(f,Buffer.from(u)),s},signMessage:async n=>{const s=await r.signMessage(n.params.message);return en.decode(s.data.signature)},signAndSendTransaction:async n=>{const s=t();if(!s)throw Bn.custom({message:"Provider is not initialized",code:4902});const o=n.params.message;if(!o)throw Xt.invalidRequest({message:"Invalid transaction message"});const i=$s(o)?o.message.serialize():o.serializeMessage(),{data:f}=await r.signTransaction(en.encode(i));if(!f.publicKey||!f.signature)throw new Error("Invalid signature from slope wallet");const u=new wt(f.publicKey),g=en.decode(f.signature);o.addSignature(u,Buffer.from(g));const y=await s.request({method:"solana_provider_config"});return{signature:await new Ea(y.rpcTarget).sendRawTransaction(o.serialize())}},signAllTransactions:async n=>{var s,o,i;if(!((s=n.params)!==null&&s!==void 0&&s.message)||!((o=n.params)!==null&&o!==void 0&&o.message.length))throw Xt.invalidParams("message");const f=n.params.message,{length:u}=f,g=[];for(let b=0;b<u;b++){const A=f[b],m=$s(A)?A.message.serialize():A.serializeMessage();g.push(en.encode(m))}const{msg:y,data:v}=await r.signAllTransactions(g);if(!v.publicKey||((i=v.signatures)===null||i===void 0?void 0:i.length)!==u)throw new Error(y);const S=new wt(v.publicKey);for(let b=0;b<u;b++){const A=en.decode(v.signatures[b]);f[b].addSignature(S,Buffer.from(A))}return f}});class yd extends Io{getProviderHandlers(t){return pd(t,this.getProviderEngineProxy.bind(this))}}const wd=(r,t)=>{const e=Ra(r);return e.signAndSendTransaction=async n=>{const s=t();if(!s)throw Bn.custom({message:"Provider is not initialized",code:4902});const o=await r.signTransaction(n.params.message),i=await s.request({method:"solana_provider_config"});return{signature:await new Ea(i.rpcTarget).sendRawTransaction(o.serialize())}},e.signMessage=async n=>await r.signMessage(n.params.message,n.params.display),e};class bd extends Io{getProviderHandlers(t){return wd(t,this.getProviderEngineProxy.bind(this))}}const md=r=>({requestAccounts:async()=>await r.request({method:"solana_requestAccounts",params:{}}),getAccounts:async()=>await r.request({method:"solana_requestAccounts",params:{}}),getPrivateKey:async()=>{throw Xt.methodNotSupported()},getSecretKey:async()=>{throw Xt.methodNotSupported()},signMessage:async e=>{var n;if(!((n=e.params)!==null&&n!==void 0&&n.message))throw Xt.invalidParams("message");return await r.signMessage(e.params.message)},signTransaction:async e=>{var n;if(!((n=e.params)!==null&&n!==void 0&&n.message))throw Xt.invalidParams("message");const s=e.params.message;return await r.signTransaction(s)},signAndSendTransaction:async e=>{var n;if(!((n=e.params)!==null&&n!==void 0&&n.message))throw Xt.invalidParams("message");const s=e.params.message;return{signature:await r.sendTransaction(s)}},signAllTransactions:async e=>{var n,s;if(!((n=e.params)!==null&&n!==void 0&&n.message)||!((s=e.params)!==null&&s!==void 0&&s.message.length))throw Xt.invalidParams("message");const o=e.params.message;return await r.signAllTransactions(o)}});class xd extends so{constructor(t){let{config:e,state:n}=t;super({config:{chainConfig:An(An({},e.chainConfig),{},{chainNamespace:Gr.SOLANA})},state:n})}async switchChain(t){await this.provider.request({method:"switchSolanaChain",params:[{chainId:t.chainId}]})}async addChain(t){super.addChain(t),await this.provider.request({method:"addNewChainConfig",params:[{chainId:t.chainId,chainName:t.displayName,rpcUrls:[t.rpcTarget],blockExplorerUrls:[t.blockExplorer],nativeCurrency:{name:t.tickerName,symbol:t.ticker,decimals:t.decimals||18}}]})}async setupProvider(t){this.handleInjectedProviderUpdate(t),await this.setupEngine(t)}async lookupNetwork(){if(!this.provider)throw Bn.custom({message:"Torus solana provider is not initialized",code:4902});const{chainId:t}=this.config.chainConfig,e=await this.provider.request({method:"solana_chainId"}),n=Uo(e.toString())?e:`0x${parseInt(e,10).toString(16)}`;if(t!==n)throw eo.rpcConnectionError(`Invalid network, net_version is: ${n}, expected: ${t}`);return this.update({chainId:n}),this.emit("connect",{chainId:this.state.chainId}),this.emit("chainChanged",this.state.chainId),this.state.chainId}async setupEngine(t){const e=md(t),n=ko(e),s=Ta(t),o=new no;o.push(n),o.push(s);const i=ro(o);this.updateProviderEngineProxy(i),await this.lookupNetwork()}async handleInjectedProviderUpdate(t){t.on("accountsChanged",async e=>{this.emit("accountsChanged",e)}),t.on("chainChanged",async e=>{const n=Uo(e)?e:`0x${parseInt(e,10).toString(16)}`;this.configure({chainConfig:An(An({},this.config.chainConfig),{},{chainId:n})}),await this.setupProvider(t)})}}async function vd(r){let{privKey:t,getProviderEngineProxy:e}=r;const n=()=>Ar.fromSecretKey(Buffer.from(t,"hex"));if(typeof t!="string")throw eo.invalidParams("privKey must be a string");const s=n();return{requestAccounts:async()=>[s.publicKey.toBase58()],getAccounts:async()=>[s.publicKey.toBase58()],getPrivateKey:async()=>t,getSecretKey:async()=>en.encode(s.secretKey),signTransaction:async i=>{var f;if(!((f=i.params)!==null&&f!==void 0&&f.message))throw Xt.invalidParams("message");const u=i.params.message;return u.version!==void 0||u instanceof sr?u.sign([s]):u.partialSign(s),u},signMessage:async i=>{var f;if(!((f=i.params)!==null&&f!==void 0&&f.message))throw Xt.invalidParams("message");return ka.sign.detached(i.params.message,s.secretKey)},signAndSendTransaction:async i=>{var f;if(!((f=i.params)!==null&&f!==void 0&&f.message))throw Xt.invalidParams("message");const u=e();if(!u)throw Bn.custom({message:"Provider is not initialized",code:4902});const g=i.params.message;return g.version!==void 0||g instanceof sr?g.sign([s]):g.partialSign(s),{signature:await u.request({method:"sendTransaction",params:[Buffer.from(g.serialize()).toString("base64"),{encoding:"base64",preflightCommitment:"confirmed"}]})}},signAllTransactions:async i=>{var f,u,g;if(!((f=i.params)!==null&&f!==void 0&&f.message)||!((u=i.params)!==null&&u!==void 0&&u.message.length))throw Xt.invalidParams("message");const y=(g=i.params)===null||g===void 0?void 0:g.message;for(const v of y||[]){const S=v;S.version!==void 0||S instanceof sr?S.sign([s]):S.partialSign(s)}return y}}}var Ca;class Ro extends so{constructor(t){let{config:e,state:n}=t;super({config:{chainConfig:An(An({},e.chainConfig),{},{chainNamespace:Gr.SOLANA})},state:n})}async enable(){if(!this.state.privateKey)throw Bn.custom({message:"Private key is not found in state, plz pass it in constructor state param",code:4902});return await this.setupProvider(this.state.privateKey),this._providerEngineProxy.request({method:"eth_accounts"})}getEd25519Key(t){return id(t).sk.toString("hex").padStart(128,"0")}async setupProvider(t){const e=await vd({privKey:t,getProviderEngineProxy:this.getProviderEngineProxy.bind(this)}),n=ko(e),s=new no,{networkMiddleware:o}=fd(this.config.chainConfig);s.push(this.getChainSwitchMiddleware()),s.push(this.getAccountMiddleware()),s.push(n),s.push(o);const i=ro(s);this.updateProviderEngineProxy(i),await this.lookupNetwork()}async updateAccount(t){if(!this._providerEngineProxy)throw Bn.custom({message:"Provider is not initialized",code:4902});await this._providerEngineProxy.request({method:"solanaPrivateKey"})!==t.privateKey&&(await this.setupProvider(t.privateKey),this.emit("accountsChanged",{accounts:await this._providerEngineProxy.request({method:"requestAccounts"})}))}async switchChain(t){if(!this._providerEngineProxy)throw Bn.custom({message:"Provider is not initialized",code:4902});const e=this.getChainConfig(t.chainId);this.update({chainId:"loading"}),this.configure({chainConfig:e});const n=await this._providerEngineProxy.request({method:"solanaPrivateKey"});await this.setupProvider(n)}async lookupNetwork(){if(!this._providerEngineProxy)throw Bn.custom({message:"Provider is not initialized",code:4902});const t=await this._providerEngineProxy.request({method:"getHealth",params:[]}),{chainConfig:e}=this.config;if(t!=="ok")throw eo.rpcConnectionError(`Failed to lookup network for following rpc target: ${e.rpcTarget}`);return this.update({chainId:e.chainId}),this.state.chainId!==e.chainId&&(this.emit("chainChanged",this.state.chainId),this.emit("connect",{chainId:this.state.chainId})),this.state.chainId}getChainSwitchMiddleware(){return dd({addNewChainConfig:async n=>{if(!n.params)throw Xt.invalidParams("Missing request params");const{chainId:s,chainName:o,rpcUrls:i,blockExplorerUrls:f,nativeCurrency:u}=n.params;if(!s)throw Xt.invalidParams("Missing chainId in chainParams");if(!i||i.length===0)throw Xt.invalidParams("Missing rpcUrls in chainParams");if(!u)throw Xt.invalidParams("Missing nativeCurrency in chainParams");this.addChain({chainNamespace:Gr.SOLANA,chainId:s,ticker:(u==null?void 0:u.symbol)||"SOL",tickerName:(u==null?void 0:u.name)||"Solana",displayName:o,rpcTarget:i[0],blockExplorer:(f==null?void 0:f[0])||"",decimals:(u==null?void 0:u.decimals)||9})},switchSolanaChain:async n=>{if(!n.params)throw Xt.invalidParams("Missing request params");if(!n.params.chainId)throw Xt.invalidParams("Missing chainId");await this.switchChain(n.params)}})}getAccountMiddleware(){return hd({updatePrivatekey:async e=>{if(!e.params)throw Xt.invalidParams("Missing request params");if(!e.params.privateKey)throw Xt.invalidParams("Missing privateKey");const{privateKey:n}=e.params;await this.updateAccount({privateKey:n})}})}}Ca=Ro;hi(Ro,"getProviderInstance",async r=>{const t=new Ca({config:{chainConfig:r.chainConfig}});return await t.setupProvider(r.privKey),t});class Sd{constructor(t){hi(this,"provider",void 0),this.provider=t}async requestAccounts(){return await this.provider.request({method:"requestAccounts"})}async signAndSendTransaction(t){const{signature:e}=await this.provider.request({method:"signAndSendTransaction",params:{message:t}});return{signature:e}}async signTransaction(t){return await this.provider.request({method:"signTransaction",params:{message:t}})}async signAllTransactions(t){return await this.provider.request({method:"signAllTransactions",params:{message:t}})}async signMessage(t){return await this.provider.request({method:"signMessage",params:{message:t}})}async request(t){return await this.provider.request(t)}}const Ud=Object.freeze(Object.defineProperty({__proto__:null,PhantomInjectedProvider:gd,SlopeInjectedProxyProvider:yd,SolanaPrivateKeyProvider:Ro,SolanaWallet:Sd,SolflareInjectedProvider:bd,TorusInjectedProvider:xd},Symbol.toStringTag,{value:"Module"}));export{wt as P,xd as T,gd as a,Ud as s};
