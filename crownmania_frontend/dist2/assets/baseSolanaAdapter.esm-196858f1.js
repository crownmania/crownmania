import{Q as U,g as N,C as k,A as M,f as u,R as x,U as D,V as I,X as z,Y as R,Z as O,h as q}from"./base.esm-47809bc2.js";import{g as _}from"./vendor-e80652ae.js";function F(l){if(l.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),A=0;A<n.length;A++)n[A]=255;for(var o=0;o<l.length;o++){var v=l.charAt(o),p=v.charCodeAt(0);if(n[p]!==255)throw new TypeError(v+" is ambiguous");n[p]=o}var c=l.length,E=l.charAt(0),y=Math.log(c)/Math.log(256),m=Math.log(256)/Math.log(c);function T(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length===0)return"";for(var t=0,w=0,a=0,s=e.length;a!==s&&e[a]===0;)a++,t++;for(var h=(s-a)*m+1>>>0,r=new Uint8Array(h);a!==s;){for(var d=e[a],g=0,i=h-1;(d!==0||g<w)&&i!==-1;i--,g++)d+=256*r[i]>>>0,r[i]=d%c>>>0,d=d/c>>>0;if(d!==0)throw new Error("Non-zero carry");w=g,a++}for(var f=h-w;f!==h&&r[f]===0;)f++;for(var C=E.repeat(t);f<h;++f)C+=l.charAt(r[f]);return C}function S(e){if(typeof e!="string")throw new TypeError("Expected String");if(e.length===0)return new Uint8Array;for(var t=0,w=0,a=0;e[t]===E;)w++,t++;for(var s=(e.length-t)*y+1>>>0,h=new Uint8Array(s);e[t];){var r=n[e.charCodeAt(t)];if(r===255)return;for(var d=0,g=s-1;(r!==0||d<a)&&g!==-1;g--,d++)r+=c*h[g]>>>0,h[g]=r%256>>>0,r=r/256>>>0;if(r!==0)throw new Error("Non-zero carry");a=d,t++}for(var i=s-a;i!==s&&h[i]===0;)i++;for(var f=new Uint8Array(w+(s-i)),C=w;i!==s;)f[C++]=h[i++];return f}function b(e){var t=S(e);if(t)return t;throw new Error("Non-base"+c+" character")}return{encode:T,decodeUnsafe:S,decode:b}}var V=F;const B=V,P="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";var Q=B(P);const W=_(Q);class Z extends U{async init(n){this.chainConfig||(this.chainConfig=N(k.SOLANA,1))}async authenticateUser(){if(!this.provider||this.status!==M.CONNECTED)throw u.notConnectedError();const{chainNamespace:n,chainId:A}=this.chainConfig,o=await this.provider.request({method:"getAccounts"});if(o&&o.length>0){const v=x(o[0],this.name);if(v&&!D(v))return{idToken:v};const p={domain:window.location.origin,uri:window.location.href,address:o[0],chainId:parseInt(A,16),version:"1",nonce:Math.random().toString(36).slice(2),issuedAt:new Date().toISOString()},c=await I(p,n),E=new TextEncoder().encode(c),y=await this.provider.request({method:"signMessage",params:{message:E,display:"utf8"}}),m=await z(n,W.encode(y),c,this.name,this.sessionTime,this.clientId,this.web3AuthNetwork);return R(o[0],this.name,m),{idToken:m}}throw u.notConnectedError("Not connected with wallet, Please login/connect first")}async disconnectSession(){super.checkDisconnectionRequirements();const n=await this.provider.request({method:"getAccounts"});n&&n.length>0&&O(n[0],this.name)}async disconnect(){this.rehydrated=!1,this.emit(q.DISCONNECTED)}}export{Z as B};
